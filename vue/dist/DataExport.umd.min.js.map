{"version":3,"sources":["webpack://DataExport/webpack/universalModuleDefinition","webpack://DataExport/webpack/bootstrap","webpack://DataExport/./plugins/CoreHome/vue/src/noAdblockFlag.ts","webpack://DataExport/./plugins/DataExport/vue/src/CsvSection/CsvSection.vue?231c","webpack://DataExport/external {\"commonjs\":\"vue\",\"commonjs2\":\"vue\",\"root\":\"Vue\"}","webpack://DataExport/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://DataExport/./plugins/DataExport/vue/src/CsvSection/CsvSection.vue","webpack://DataExport/./plugins/CoreHome/vue/src/translate.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Periods/Periods.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Periods/utilities.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Periods/Day.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Periods/Week.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Periods/Month.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Periods/Year.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Matomo/Matomo.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Periods/Range.ts","webpack://DataExport/./plugins/CoreHome/vue/src/MatomoUrl/MatomoUrl.ts","webpack://DataExport/./plugins/CoreHome/vue/src/AjaxHelper/AjaxHelper.ts","webpack://DataExport/./plugins/CoreHome/vue/src/AjaxHelper/AjaxHelper.adapter.ts","webpack://DataExport/./plugins/CoreHome/vue/src/PopoverHandler/PopoverHandler.ts","webpack://DataExport/./plugins/CoreHome/vue/src/CookieHelper/CookieHelper.ts","webpack://DataExport/./plugins/CoreHome/vue/src/zenMode.ts","webpack://DataExport/./plugins/CoreHome/vue/src/externalLink.ts","webpack://DataExport/./plugins/CoreHome/vue/src/createVueApp.ts","webpack://DataExport/./plugins/CoreHome/vue/src/importPluginUmd.ts","webpack://DataExport/./plugins/CoreHome/vue/src/useExternalPluginComponent.ts","webpack://DataExport/./plugins/CoreHome/vue/src/directiveUtilities.ts","webpack://DataExport/./plugins/CoreHome/vue/src/debounce.ts","webpack://DataExport/./plugins/CoreHome/vue/src/VueEntryContainer/VueEntryContainer.vue","webpack://DataExport/./plugins/CoreHome/vue/src/VueEntryContainer/VueEntryContainer.vue?0841","webpack://DataExport/./plugins/CoreHome/vue/src/VueEntryContainer/VueEntryContainer.vue?84f3","webpack://DataExport/./plugins/CoreHome/vue/src/ActivityIndicator/ActivityIndicator.vue","webpack://DataExport/./plugins/CoreHome/vue/src/ActivityIndicator/ActivityIndicator.vue?0bf6","webpack://DataExport/./plugins/CoreHome/vue/src/ActivityIndicator/ActivityIndicator.vue?6f80","webpack://DataExport/./plugins/CoreHome/vue/src/Alert/Alert.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Alert/Alert.vue?14a2","webpack://DataExport/./plugins/CoreHome/vue/src/Alert/Alert.vue?cc69","webpack://DataExport/./plugins/CoreHome/vue/src/FocusAnywhereButHere/FocusAnywhereButHere.ts","webpack://DataExport/./plugins/CoreHome/vue/src/FocusIf/FocusIf.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Tooltips/Tooltips.ts","webpack://DataExport/./plugins/CoreHome/vue/src/MatomoDialog/MatomoDialog.vue","webpack://DataExport/./plugins/CoreHome/vue/src/MatomoDialog/MatomoDialog.vue?c435","webpack://DataExport/./plugins/CoreHome/vue/src/MatomoDialog/MatomoDialog.vue?7b62","webpack://DataExport/./plugins/CoreHome/vue/src/ExpandOnClick/ExpandOnClick.ts","webpack://DataExport/./plugins/CoreHome/vue/src/ExpandOnHover/ExpandOnHover.ts","webpack://DataExport/./plugins/CoreHome/vue/src/ShowSensitiveData/ShowSensitiveData.ts","webpack://DataExport/./plugins/CoreHome/vue/src/DropdownButton/DropdownButton.ts","webpack://DataExport/./plugins/CoreHome/vue/src/SelectOnFocus/SelectOnFocus.ts","webpack://DataExport/./plugins/CoreHome/vue/src/CopyToClipboard/CopyToClipboard.ts","webpack://DataExport/./plugins/CoreHome/vue/src/SideNav/SideNav.ts","webpack://DataExport/./plugins/CoreHome/vue/src/EnrichedHeadline/EnrichedHeadline.vue","webpack://DataExport/./plugins/CoreHome/vue/src/EnrichedHeadline/EnrichedHeadline.vue?7f4f","webpack://DataExport/./plugins/CoreHome/vue/src/EnrichedHeadline/EnrichedHeadline.vue?9cf5","webpack://DataExport/./plugins/CoreHome/vue/src/ContentBlock/ContentBlock.vue","webpack://DataExport/./plugins/CoreHome/vue/src/ContentBlock/ContentBlock.vue?4b9f","webpack://DataExport/./plugins/CoreHome/vue/src/ContentBlock/ContentBlock.vue?5539","webpack://DataExport/./plugins/CoreHome/vue/src/Comparisons/Comparisons.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Segmentation/Segments.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Comparisons/Comparisons.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Comparisons/Comparisons.store.instance.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Comparisons/Comparisons.vue?027a","webpack://DataExport/./plugins/CoreHome/vue/src/Comparisons/Comparisons.vue?5565","webpack://DataExport/./plugins/CoreHome/vue/src/MenuItemsDropdown/MenuItemsDropdown.vue","webpack://DataExport/./plugins/CoreHome/vue/src/MenuItemsDropdown/MenuItemsDropdown.vue?4726","webpack://DataExport/./plugins/CoreHome/vue/src/MenuItemsDropdown/MenuItemsDropdown.vue?4ce0","webpack://DataExport/./plugins/CoreHome/vue/src/DatePicker/DatePicker.vue","webpack://DataExport/./plugins/CoreHome/vue/src/DatePicker/DatePicker.vue?189b","webpack://DataExport/./plugins/CoreHome/vue/src/DatePicker/DatePicker.vue?0d65","webpack://DataExport/./plugins/CoreHome/vue/src/DateRangePicker/DateRangePicker.vue","webpack://DataExport/./plugins/CoreHome/vue/src/DateRangePicker/DateRangePicker.vue?2e06","webpack://DataExport/./plugins/CoreHome/vue/src/DateRangePicker/DateRangePicker.vue?368d","webpack://DataExport/./plugins/CoreHome/vue/src/PeriodDatePicker/PeriodDatePicker.vue","webpack://DataExport/./plugins/CoreHome/vue/src/PeriodDatePicker/PeriodDatePicker.vue?c684","webpack://DataExport/./plugins/CoreHome/vue/src/PeriodDatePicker/PeriodDatePicker.vue?3717","webpack://DataExport/./plugins/CoreHome/vue/src/Notification/Notification.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Notification/Notification.vue?4c45","webpack://DataExport/./plugins/CoreHome/vue/src/Notification/Notification.vue?6bbb","webpack://DataExport/./plugins/CoreHome/vue/src/Notification/NotificationGroup.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Notification/Notifications.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Notification/NotificationGroup.vue?deab","webpack://DataExport/./plugins/CoreHome/vue/src/Notification/NotificationGroup.vue?fed5","webpack://DataExport/./plugins/CoreHome/vue/src/ShowHelpLink/ShowHelpLink.vue","webpack://DataExport/./plugins/CoreHome/vue/src/ShowHelpLink/ShowHelpLink.vue?3cfe","webpack://DataExport/./plugins/CoreHome/vue/src/ShowHelpLink/ShowHelpLink.vue?e2f6","webpack://DataExport/./plugins/CoreHome/vue/src/SiteSelector/SitesStore.ts","webpack://DataExport/./plugins/CoreHome/vue/src/SiteSelector/SiteSelector.vue","webpack://DataExport/./plugins/CoreHome/vue/src/SiteSelector/AllSitesLink.vue","webpack://DataExport/./plugins/CoreHome/vue/src/SiteSelector/AllSitesLink.vue?80c2","webpack://DataExport/./plugins/CoreHome/vue/src/SiteSelector/AllSitesLink.vue?2602","webpack://DataExport/./plugins/CoreHome/vue/src/SiteSelector/SiteSelector.vue?7ec2","webpack://DataExport/./plugins/CoreHome/vue/src/SiteSelector/SiteSelector.vue?e196","webpack://DataExport/./plugins/CoreHome/vue/src/QuickAccess/QuickAccess.vue","webpack://DataExport/./plugins/CoreHome/vue/src/QuickAccess/QuickAccess.vue?501c","webpack://DataExport/./plugins/CoreHome/vue/src/QuickAccess/QuickAccess.vue?7c88","webpack://DataExport/./plugins/CoreHome/vue/src/FieldArray/FieldArray.vue","webpack://DataExport/./plugins/CoreHome/vue/src/FieldArray/FieldArray.vue?7d99","webpack://DataExport/./plugins/CoreHome/vue/src/FieldArray/FieldArray.vue?56fa","webpack://DataExport/./plugins/CoreHome/vue/src/MultiPairField/MultiPairField.vue","webpack://DataExport/./plugins/CoreHome/vue/src/MultiPairField/MultiPairField.vue?aeef","webpack://DataExport/./plugins/CoreHome/vue/src/MultiPairField/MultiPairField.vue?75cc","webpack://DataExport/./plugins/CoreHome/vue/src/PeriodSelector/PeriodSelector.vue","webpack://DataExport/./plugins/CoreHome/vue/src/PeriodSelector/PeriodSelector.vue?3b1d","webpack://DataExport/./plugins/CoreHome/vue/src/PeriodSelector/PeriodSelector.vue?dbce","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingMenu/ReportingMenu.vue","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingPages/ReportingPages.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Orderable.ts","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingMenu/Category.ts","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingMenu/Subcategory.ts","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingMenu/ReportingMenu.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Widget/Widgets.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingMenu/ReportingMenu.vue?6c95","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingMenu/ReportingMenu.vue?e011","webpack://DataExport/./plugins/CoreHome/vue/src/ReportMetadata/ReportMetadata.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetLoader/WidgetLoader.vue","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetLoader/WidgetLoader.vue?a9ec","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetLoader/WidgetLoader.vue?8129","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetContainer/WidgetContainer.vue","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetContainer/WidgetContainer.vue?dc13","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetContainer/WidgetContainer.vue?b736","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetByDimensionContainer/WidgetByDimensionContainer.vue","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetByDimensionContainer/WidgetByDimensionContainer.vue?b01b","webpack://DataExport/./plugins/CoreHome/vue/src/WidgetByDimensionContainer/WidgetByDimensionContainer.vue?2a5f","webpack://DataExport/./plugins/CoreHome/vue/src/Widget/Widget.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Widget/Widget.vue?8b42","webpack://DataExport/./plugins/CoreHome/vue/src/Widget/Widget.vue?b66c","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingPage/ReportingPage.vue","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingPage/ReportingPage.store.ts","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingPage/ReportingPage.vue?96fe","webpack://DataExport/./plugins/CoreHome/vue/src/ReportingPage/ReportingPage.vue?e6c0","webpack://DataExport/./plugins/CoreHome/vue/src/ReportExport/ReportExportPopover.vue","webpack://DataExport/./plugins/CoreHome/vue/src/ReportExport/ReportExportPopover.vue?e7ff","webpack://DataExport/./plugins/CoreHome/vue/src/ReportExport/ReportExportPopover.vue?531b","webpack://DataExport/./plugins/CoreHome/vue/src/ReportExport/ReportExport.ts","webpack://DataExport/./plugins/CoreHome/vue/src/Sparkline/Sparkline.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Sparkline/Sparkline.vue?8384","webpack://DataExport/./plugins/CoreHome/vue/src/Sparkline/Sparkline.vue?e0d5","webpack://DataExport/./plugins/CoreHome/vue/src/Progressbar/Progressbar.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Progressbar/Progressbar.vue?0766","webpack://DataExport/./plugins/CoreHome/vue/src/Progressbar/Progressbar.vue?4e7c","webpack://DataExport/./plugins/CoreHome/vue/src/AjaxForm/AjaxForm.vue","webpack://DataExport/./plugins/CoreHome/vue/src/AjaxForm/AjaxForm.vue?76ae","webpack://DataExport/./plugins/CoreHome/vue/src/AjaxForm/AjaxForm.vue?8bc2","webpack://DataExport/./plugins/CoreHome/vue/src/Passthrough/Passthrough.vue","webpack://DataExport/./plugins/CoreHome/vue/src/Passthrough/Passthrough.vue?a844","webpack://DataExport/./plugins/CoreHome/vue/src/Passthrough/Passthrough.vue?2bbb","webpack://DataExport/./plugins/CoreHome/vue/src/DataTable/DataTableActions.vue","webpack://DataExport/./plugins/CoreHome/vue/src/DataTable/DataTableActions.vue?7903","webpack://DataExport/./plugins/CoreHome/vue/src/DataTable/DataTableActions.vue?049a","webpack://DataExport/./plugins/CoreHome/vue/src/VersionInfoHeaderMessage/VersionInfoHeaderMessage.vue","webpack://DataExport/./plugins/CoreHome/vue/src/VersionInfoHeaderMessage/VersionInfoHeaderMessage.vue?82f6","webpack://DataExport/./plugins/CoreHome/vue/src/VersionInfoHeaderMessage/VersionInfoHeaderMessage.vue?7886","webpack://DataExport/./plugins/CoreHome/vue/src/MobileLeftMenu/MobileLeftMenu.vue","webpack://DataExport/./plugins/CoreHome/vue/src/MobileLeftMenu/MobileLeftMenu.vue?c087","webpack://DataExport/./plugins/CoreHome/vue/src/MobileLeftMenu/MobileLeftMenu.vue?6096","webpack://DataExport/./plugins/CoreHome/vue/src/scrollToAnchorInUrl.ts","webpack://DataExport/./plugins/DataExport/vue/src/CsvSection/CsvSection.vue?6294","webpack://DataExport/./plugins/DataExport/vue/src/CsvSection/CsvSection.vue?ed72"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE__8bbf__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","hasBlockedContent","currentScript","document","src","match","class","for","type","role","translate","site","id","$event","websiteChanged","show-all-sites-item","switch-site-on-select","show-selected-site","default-to-first-site","date","dateChanged","style","downloadCSV","showDialog","translationStringId","values","pkArgs","length","Array","isArray","_pk_translate","translateOrDefault","translationStringIdOrText","piwik_translations","Periods","periodClass","periods","Error","periodOrder","push","concat","strPeriod","strDate","parse","format","$","datepicker","formatDate","getToday","Date","now","setTime","getTime","getTimezoneOffset","setHours","getHours","piwik","timezoneOffset","setMinutes","setSeconds","setMilliseconds","parseDate","decodeURIComponent","trim","yesterday","setDate","getDate","lastWeek","lastMonth","setMonth","getMonth","lastYear","setFullYear","getFullYear","todayIsInRange","dateRange","dateInPeriod","getDateRange","DayPeriod","addCustomPeriod","weekDates","startWeek","endWeek","daysToMonday","getDay","WeekPeriod","month","startMonth","endMonth","MonthPeriod","toString","startYear","endYear","YearPeriod","originalTitle","startDate","endDate","childPeriodType","start","end","Math","ceil","strAmount","strEndDate","nAmount","max","parseInt","Number","isNaN","startPeriod","endPeriod","firstWebsiteDate","RangePeriod","rangeEndDate","countBack","ed","test","getLastNRange","substring","parts","split","broadcast","piwikHelper","helper","updateDateInTitle","period","title","indexOf","siteName","dateString","getPrettyString","slice","hasUserCapability","capability","userCapabilities","on","eventName","listener","listenerWrapper","evt","detail","wrapper","addEventListener","off","removeEventListener","postEvent","args","event","CustomEvent","dispatchEvent","Matomo","isValidPeriod","periodStr","dateStr","e","url","search","replace","hash","urlQuery","hashQuery","urlParsed","hashParsed","URL","location","href","newURL","updatePeriodParamsFromUrl","urlWithoutLeadingHash","wholeHash","HashChangeEvent","oldURL","params","modifiedParams","getFinalHashParams","serializedParams","stringify","updateHashToUrl","hashParams","modifiedHashParams","keys","serializedHashParams","propagateNewPage","undefined","urlParams","paramsObj","urlParamsObj","parsed","segment","isReportingPage","updateHash","updateUrl","paramName","regex","RegExp","valueFromHash","getValueFromHash","getValueFromUrl","query","getValuesFromUrl","searchWithoutEmpty","fromEntries","entries","filter","param","getSearchParam","currentDateString","startDateString","endDateString","instance","defaultErrorCallback","deferred","status","Piwik_Popover","isOpen","body","html","escape","responseText","show","console","log","globalAjaxQueue","active","clean","readyState","splice","abort","forEach","x","ApiResponseError","errorCallback","initialParams","arrayParams","toLowerCase","getParams","postParams","withToken","addParams","urls","urlsProcessed","map","u","method","timeout","callback","useRegularCallbackInCaseOfError","setCallback","redirect","completeCallback","element","loadingElement","errorElement","parameter","defaultParams","hide","fadeIn","requestHandle","buildAjaxCall","abortController","signal","result","Promise","resolve","reject","then","data","resolveWithHelper","fail","xhr","statusText","parameters","mixinDefaultGetParams","getUrl","ajaxCall","async","dataType","complete","headers","error","apply","success","response","request","results","errors","message","reduce","acc","errorMessage","placeAt","isLoggedIn","querySelector","UI","notification","Notification","placeat","context","scrollToNotification","ajaxRequestFinished","mixinDefaultPostParams","ajax","isRequestToApiMethod","shouldPropagateTokenAuth","token_auth","force_api_session","isWidgetizeRequestWithoutSession","getDefaultPostParams","mergedParams","originalParams","idSite","useGETDefaultParameter","options","AjaxHelper","withTokenInUrl","setErrorElement","redirectOnSuccess","setFormat","setBulkRequests","encodeURIComponent","createErrorNotification","useCallbackInCaseOfError","setErrorCallback","returnResponseObject","send","responseJSON","join","catch","fetch","AbortController","post","finally","ajaxHelper","setup","popover","onPopoverParamChanged","onPopoverParamChangedInitial","setTimeout","openOrClose","close","popoverParam","open","resetPopoverStack","thePopoverParam","popoverParamParts","handlerName","shift","popoverHandlers","isLoginPage","setCookie","val","seconds","cookie","toUTCString","getCookie","pop","handleZenMode","zenMode","iconSwitcher","updateZenMode","addClass","removeClass","prop","registerShortcut","altKey","click","Mousetrap","trigger","externalRawLink","_pk_externalRawLink","externalLink","campaignOverride","sourceOverride","mediumOverride","returnUrl","createVueApp","app","config","globalProperties","$sanitize","vueSanitize","pluginLoadingPromises","PLUGIN_LOAD_TIMEOUT","POLL_INTERVAL","POLL_LIMIT","importPluginUmd","plugin","promiseReject","promiseResolve","pluginUmdPath","script","createElement","charset","onScriptComplete","onerror","onload","clearTimeout","pollProgress","checkPluginInWindow","errorType","realSrc","target","head","appendChild","useExternalPluginComponent","component","getRef","expander","binding","HTMLElement","$refs","DEFAULT_DEBOUNCE_DELAY","debounce","fn","delayInMs","ref","componentWrapper","props","String","mounted","compileVueEntryComponents","beforeUnmount","destroyVueComponent","computed","template","render","alt","loadingMessage","loading","Boolean","required","default","severity","onClickOutsideElement","hadUsedScrollbar","isMouseDown","hasScrolled","contains","blur","onScroll","onMouseDown","onEscapeHandler","which","doc","documentElement","el","unmounted","doFocusIf","focused","oldValue","focus","afterFocus","updated","defaultContentTransform","attr","setupTooltips","tooltip","track","content","delay","duration","tooltipClass","modelValue","emits","activated","$emit","watch","newValue","slotElement","firstElementChild","modalConfirm","yes","no","validation","onCloseEnd","modal","onExpand","classList","toggle","positionElement","setMarginLeftToBeInViewport","remove","onClosed","onMouseEnter","add","onMouseLeave","dropdown","inDuration","outDuration","constrainWidth","belowOrigin","onFocusHandler","focusedElement","select","range","createRange","selectNode","selection","getSelection","rangeCount","removeAllRanges","addRange","onBlurHandler","tagName","elementSupportsSelect","onClickHandler","activator","initialized","sideNavActivator","targetSelector","getAttribute","sidenav","closeOnClick","collapsible","tabindex","showIcons","editUrl","htmlEntities","actualFeatureName","helpUrl","actualInlineHelp","rel","showInlineHelp","reportGenerated","showRateFeature","rateFeature","featureName","inlineHelp","helpNode","parentElement","nextElementSibling","helpDocs","textContent","currentPeriod","containsToday","items","methods","v","imageUrl","contentTitle","actualFeature","actualHelpText","decode","feature-name","help-url","inline-help","actualImageAltText","adminContent","feature","helpText","anchor","imageAltText","components","EnrichedHeadline","anchorElement","prepend","innerHTML","contentTopPosition","offsetTop","parents","closest","topThis","marginTop","htmlDecode","isComparing","segmentComparisons","comparison","$index","index","getUrlToSegment","periodComparisons","periodComparison","getComparisonTooltip","getComparisonPeriodType","removeSegmentComparison","transformTooltipContent","availableSegments","setSegmentState","segmentState","uiControlObject","impl","SERIES_COLOR_COUNT","SERIES_SHADE_COUNT","wrapArray","comparisonsDisabledFor","privateState","parseSegmentComparisons","parsePeriodComparisons","checkEnabledForCurrentPage","loadComparisonsDisabledFor","colors","getAllSeriesColors","getComparisons","deep","getSegmentComparisons","getPeriodComparisons","isComparisonEnabled","segmentComparison","metricIndex","seriesIndex","getComparisonSeriesIndex","shadeIndex","colorName","isEnabled","segmentCount","segmentIndex","periodIndex","floor","seriesInfo","periodComp","segmentComp","color","newComparisons","extraParams","updateQueryParamsFromComparisons","compareSegments","comparePeriodDatePairs","firstSegment","firstPeriod","comparePeriods","compareDates","pair","compareParams","baseParams","updateLocation","ColorManager","seriesColorNames","j","getColors","matomoModule","isPagesComparisonApiDisabled","installation","state","unshift","newSegmentComparisons","idx","storedSegment","definition","segmentTitle","newPeriodComparisons","min","category","subcategory","action","directives","Tooltips","comparisonTooltips","isNoDataPage","getSeriesColor","comparisonHasSegment","toUpperCase","onComparisonsChanged","apiModule","apiAction","compare","format_metrics","report","generateComparisonTooltip","visitsSummary","reportData","comparisons","firstRowIndex","firstRow","comparisonRowIndex","comparisonRow","firstPeriodRow","visitsPercent","nb_visits","toFixed","compareSegmentPretty","comparePeriodPretty","nb_visits_change","showItems","actualMenuTitle","showSearch","searchTerm","onSearchTermKeydown","placeholder","searchItems","selectItem","lostFocus","menuTitle","menuTitleChangeOnClick","FocusAnywhereButHere","FocusIf","targetClasses","charCodeAt","$slots","find","unprocessedSearchTerm","each","node","$node","text","DEFAULT_STEP_MONTHS","selectedDateStart","selectedDateEnd","highlightedDateStart","highlightedDateEnd","viewDate","stepMonths","disableMonthDropdown","setDateCellColor","$dateCell","dateValue","$dateCellLink","children","elementToAddClassTo","getCellDate","year","hasClass","getOtherMonthDate","day","$row","parent","$rowCells","is","$firstDateInMonth","first","$lastDateInMonth","last","getMonthYearDisplayed","$firstCellWithMonth","setDatePickerCellColors","$calendarTable","monthYear","$cells","$firstDateCell","currentDate","viewDateChanged","onJqueryUiRenderedPicker","stepMonthsChanged","currentMonth","currentYear","enableDisableMonthDropdown","monthPicker","disabled","handleOtherMonthClick","$tbody","onCalendarViewChange","newProps","oldProps","redraw","selector","newProp","oldProp","customOptions","datePickerOptions","getBaseDatePickerOptions","onChangeMonthYear","originalEvent","emit","$cell","preventDefault","$target","renderPostProcessed","startDateText","onRangeInputChanged","handleEnterPress","view-date","selected-date-start","fromPickerSelectedDates","selected-date-end","highlighted-date-start","fromPickerHighlightedDates","highlighted-date-end","setStartRangeDate","getNewHighlightedDates","endDateText","toPickerSelectedDates","toPickerHighlightedDates","setEndRangeDate","DATE_FORMAT","DatePicker","startDateInvalid","endDateInvalid","setStartRangeDateFromStr","setEndRangeDateFromStr","rangeChanged","source","keyCode","startDateParsed","endDateParsed","selectedDates","highlightedDates","step-months","disable-month-dropdown","onHoverNormalCell","onHoverLeaveNormalCells","onDateSelected","minDateYear","minDateMonth","minDateDay","piwikMaxDate","maxDateYear","maxDateMonth","maxDateDay","getBoundedDateRange","dates","cellDate","isOutOfMinMaxDateRange","shouldNotHighlightFromWhitespace","onChanges","toastClosed","deleted","appear","animate","cssClasses","data-notification-instance-id","notificationInstanceId","canClose","data-dismiss","closeNotification","notificationId","noclear","toastLength","cssClass","addToastEvent","css","markNotificationAsRead","notifications","notification-id","toast-length","notification-instance-id","css-class","removeNotification","checkMessage","$notificationNodes","notificationsToShow","notificationNode","$notificationNode","attributes","addMethod","prependNotification","appendNotification","notificationPosition","modalSelector","group","initializeNotificationContainer","nextNotificationId","lazyScrollTo","$placeat","toastElement","position","top","offset","left","zIndex","unmount","mount","$container","NotificationGroup","CoreHome","parseNotificationDivs","showHelp","REPORTING_HELP_NOTIFICATION_ID","currentName","initialSites","isInitialized","excludedSites","stateFiltered","onlySitesWithAdminAccess","sitesToExclude","every","searchSite","sites","term","currentRequestAbort","limitRequest","limit","methodToCall","pattern","processWebsitesList","loadInitialSites","sort","lhs","rhs","showSitesList","hasMultipleSites","displayedModelValue","onClickSelector","onPressEnter","isLoading","selectorLinkTitle","firstSiteName","shouldFocusOnSearch","autocompleteMinSites","allSitesLocation","showAllSitesItem","urlAllSites","all-sites-text","allSitesText","onAllSitesClick","switchSite","idsite","getMatchedSiteName","getUrlForSiteId","showSelectedSite","activeSiteId","onBlur","onClick","switchSiteOnSelect","defaultToFirstSite","AllSitesLink","onSearchTermChanged","autocomplete_min_sites","created","initTopControls","shouldDefaultToFirstSite","shortcutTitle","returnValue","selectorLink","initialSitesFiltered","newQuery","$props","controlKey","navigator","userAgent","metaKey","ctrlKey","loadSite","previousPart","lastPart","newHash","searchActive","onKeypress","quickAccessTitle","numMenuItems","menuItems","searchMenu","submenuEntry","menuIndex","searchIndex","selectMenuItem","hasSitesSelector","selectSite","ListingFormatter","isElementInViewport","rect","getBoundingClientRect","$window","bottom","height","right","width","scrollFirstElementIntoView","scrollIntoView","classes","activateSearch","hasSegmentSelector","menuIndexCounter","topMenuItems","leftMenuItems","segmentItems","searchAreas","formatAnd","areSearchResultsDisplayed","isTabKey","isEscKey","highlightPreviousItem","highlightNextItem","clickQuickAccessMenuItem","deactivateSearch","makeSureSelectedItemIsInViewport","numTotal","querySelectorAll","selectedMenuElement","getCurrentlySelectedElement","input","item","menuItemsIndex","moveToCategory","theSubmenuItem","submenuItem","indexOfCategory","resetSearchIndex","menuItemMatches","getTopMenuItems","getLeftMenuItems","getSegmentItems","setAttribute","categoryElement","innerText","lastIndexOf","subElement","field","uiControl","full-width","model-value","availableValues","onEntryChange","model-modifiers","modelModifiers","uicontrol","template-file","templateFile","removeEntry","Field","rows","checkEmptyModelValue","newArrayValue","fieldCount","field1","field2","field3","field4","isEmptyValue","makeEmptyValue","newWholeValue","currentlyViewingText","start-date","startRangeDate","end-date","endRangeDate","onRangeChange","onApplyClicked","selectedPeriod","periodValue","setPiwikPeriodAndDate","periodsFiltered","changeViewedPeriod","checked","getPeriodDisplayText","comparePeriodType","comparePeriodDropdownOptions","compareStartDate","compareEndDate","isApplyEnabled","isLoadingNewPage","NBSP","COMPARE_PERIOD_TYPES","COMPARE_PERIOD_OPTIONS","isValidDate","DateRangePicker","PeriodDatePicker","ActivityIndicator","ExpandOnClick","isRangeValid","isComparingPeriods","newVal","updateSelectedValuesFromHash","updateComparisonValuesFromStore","handleZIndexPositionRelativeCompareDropdownIssue","periodLabel","isRecognizedPeriod","selectedComparisonParams","previousPeriodDateToSelectedPeriod","currentDateRange","warn","currentStartRange","currentEndRange","newEndDate","rangeSize","valueOf","newRange","newStartDate","selectedDateString","dateFrom","dateTo","oDateFrom","oDateTo","$element","setRangeStartEndFromPeriod","propagateNewUrlParams","closePeriodSelector","paramsWithoutCompare","includes","periodObj","getDisplayText","isCompareRangeValid","aria-label","menu","activeCategory","data-category-id","loadCategory","icon","subcategories","isGroup","show-search","menu-title","subcat","makeUrl","loadSubcategory","help","helpShownCategory","pages","categoryId","subcategoryId","fetchAllPagesPromise","getAllPages","filter_limit","sortOrderables","order","getCategoryChildren","container","getSubcategoryChildren","isNumeric","parseFloat","isFinite","activeSubcategoryId","activeSubsubcategoryId","activeCategoryId","manuallySetId","foundCategory","findSubcategory","activeSubcategory","subsubcategory","buildMenuFromPages","reloadAllPages","foundSubcategory","foundSubSubcategory","displayedCategory","displayedSubcategory","categoriesHandled","page","isCategoryDisplayed","categoryGroups","pagesWithCategory","isSubcategoryDisplayed","widgets","entityId","sub","getWidgetChildren","widget","isFetchedFirstTime","categorizedWidgets","fetchAvailableWidgets","widgetsHelper","getAvailableWidgets","casted","availableWidgets","MenuItemsDropdown","SideNav","showSubcategoryHelpOnLoad","initialLoad","categories","widgetPlugin","widgetComponent","activeSubsubcategory","fetchMenuItems","categoryToLoad","subcategoryToLoad","enterSubcategory","propagateUrlChange","found","reloadMenuItems","reloadAvailableWidgets","queryParams","isActive","toggleCategory","categoryCanLoad","shiftKey","parsedUrl","currentCategory","currentSubcategory","prefixText","prefix","reports","reportModule","reportAction","reportsPromise","loading-message","finalLoadingMessage","widgetName","loadingFailedRateLimit","hasErrorFaqLink","loadingFailed","widgetParams","changeCounter","lastWidgetAbortController","loadWidgetUrl","isGeneralSettingsAdminEnabled","enable_general_settings_admin","isPluginsAdminEnabled","enable_plugins_admin","hasSuperUserAccess","cleanupLastWidgetContent","abortHttpRequestIfNeeded","widgetContent","getWidgetUrl","fullParameters","paramsToForward","showtitle","random","thisChangeId","$content","$title","xhrStatus","actualContainer","prevent-recursion","Widget","isWidgetized","isGraphEvolution","viewDataTable","firstWidget","widgetsByCategory","selectedWidget","uniqueId","selectWidget","widget-params","WidgetLoader","widgetsSorted","byCategory","actualWidget","showWidget","isFirstInPage","isContainer","widget-name","layout","tooltipContent","findContainer","containerId","some","w","widgetized","containerid","preventRecursion","WidgetContainer","WidgetByDimensionContainer","$this","middlewareParameters","allWidgets","isReport","documentation","findReport","containerWidget","hasNoPage","widgetInGroup","shouldBeRenderedWithFullWidth","isWide","markWidgetsInFirstRowOfPage","newWidgets","groupedWidgets","reportsToIgnore","isIgnoredReport","getRelatedReports","relatedReports","counter","sortedWidgets","resetPage","all","fetchReportMetadata","findPage","showOnlyRawDataNotification","buildReportingUrl","hideOnlyRawDataNoticifation","hasRawData","hasNoVisits","dateLastChecked","renderInitialPage","JSON","columns","renderPage","clearTransientNotifications","showOnlyRawDataMessageIfRequired","promise","fetchPage","findPageInCategory","visitorLogEnabled","subcategoryExceptions","categoryExceptions","minuteInMilliseconds","json","doNotFetchActions","lastVisits","reportFormat","availableReportFormats","reportType","optionFlat","hasSubtables","optionExpanded","optionFormatMetrics","availableReportTypes","reportLimitAll","limitAllOptions","maxFilterLimit","reportLimit","filterLimitTooltip","readonly","exportLinkWithoutToken","showUrl","exportLink","additionalContent","SelectOnFocus","dataTable","requestParams","apiMethod","initialReportType","initialReportLimit","initialReportLimitAll","initialOptionFlat","initialOptionExpanded","initialOptionFormatMetrics","initialReportFormat","oldVal","rowLimit","computedMetricMax","getExportLink","label","idGoal","idDimension","dateUsedInGraph","formatsUseDayNotRange","datatable_export_range_as_day","exportUrlParams","filter_pattern","filter_pattern_recursive","isPlainObject","flat","include_aggregate_rows","expanded","pivotBy","pivotByColumnLimit","pivot_by_column","pivotByColumn","translateColumnNames","language","labelParts","popoverParamBackup","showLoading","formats","reportFormats","numberOfSubtables","processed","XML","ReportExportPopover","mountPoint","reportTitle","setTitle","setContent","onClose","dialog","sparklineUrl","seriesIndices","isWidget","$el","sparklineColors","getSparklineColors","lineColor","forceView","defaultDate","givenParams","piwikMinDate","startDateStr","endDateStr","actualProgress","progress","formData","submitApiMethod","sendJsonPayload","noErrorNotification","noSuccessNotification","submitForm","isSubmitting","successfulPostResponse","errorPostResponse","draggable","showFooter","showFooterIcons","hasConfigItems","isAnyConfigureIconHighlighted","isTableView","data-target","randomIdForDropdown","hasFooterIconsToShow","activeFooterIcon","footerIcons","footerIconGroup","buttons","footerIcon","data-footer-icon-id","showExport","showExportAsImageIcon","showExportImage","showAnnotations","reportId","dataTableActions","showFlattenTable","flattenItemText","showDimensionsConfigItem","showDimensionsText","showFlatConfigItem","includeAggregateRowsText","showTotalsConfigItem","keepTotalsRowText","showExcludeLowPopulation","excludeLowPopText","showPivotBySubtable","pivotByText","showPeriods","translations","clientSideParameters","selectablePeriods","selectablePeriod","data-period","getSingleStateIconText","addDefault","replacement","getToggledIconText","toggled","textToggled","textUntoggled","isBooleanLikeSet","apiMethodToRequestDataTable","hasMultipleDimensions","isDataTableEmpty","showTotalsRow","pivotDimensionName","Passthrough","DropdownButton","ReportExport","allFooterIcons","icons","activeFooterIcons","abandonedCarts","button","activeFooterIconIds","numIcons","CSV","TSV","HTML","keep_totals_row","show_dimensions","enable_filter_excludelowpop","latestVersionAvailable","isPiwikDemo","isMultiServerEnvironment","isSuperUser","isAdminArea","lastUpdateCheckFailed","isInternetEnabled","updateCheck","updateNowText","hasSomeViewAccess","isAnonymous","updateAvailableText","piwikVersion","contactEmail","ExpandOnHover","link","updateSubject","matomoLink","changelogLinkStart","menuWithSubmenuItems","level2","level1","_icon","_tooltip","translateIfNecessary","getMenuUrl","_url","activateLeftMenu","itemsWithoutUnderscore","scrollToAnchorNode","scrollTo","preventDefaultIfEventExists","scrollToAnchorIfPossible","err","isLinkWithinSamePage","newUrl","origin","pathname","handleScrollToAnchorIfPresentOnPageLoad","handleScrollToAnchorAfterPageLoad","oldUrl","hashPos","defaultSite","MatomoDialog","SiteSelector","count","tokenAuth","login","sitesPromise","getSites","redirectParams","sendRequest","__scopeId"],"mappings":"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","file":"DataExport.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vue\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DataExport\"] = factory(require(\"vue\"));\n\telse\n\t\troot[\"DataExport\"] = factory(root[\"Vue\"]);\n})((typeof self !== 'undefined' ? self : this), function(__WEBPACK_EXTERNAL_MODULE__8bbf__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"plugins/DataExport/vue/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"fae3\");\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\n// see https://github.com/matomo-org/matomo/issues/5094 used to detect an ad blocker\nwindow.hasBlockedContent = false;\n","export * from \"-!../../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CsvSection.vue?vue&type=style&index=0&id=1f77e6ee&lang=less&scoped=true\"","module.exports = __WEBPACK_EXTERNAL_MODULE__8bbf__;","// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  var currentScript = window.document.currentScript\n  if (process.env.NEED_CURRENTSCRIPT_POLYFILL) {\n    var getCurrentScript = require('@soda/get-current-script')\n    currentScript = getCurrentScript()\n\n    // for backward compatibility, because previously we directly included the polyfill\n    if (!('currentScript' in document)) {\n      Object.defineProperty(document, 'currentScript', { get: getCurrentScript })\n    }\n  }\n\n  var src = currentScript && currentScript.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/)\n  if (src) {\n    __webpack_public_path__ = src[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","<!--\n   2024 Jorge Powers. All rights reserved.\n\n  @link https://jorgeuos.com\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"card\">\n    <div class=\"card-content\">\n      <h2 class=\"card-title\">{{ translate('DataExport_CsvCardTitle') }}</h2>\n\n      <div>\n        <p>\n          <label for=\"csvSite\">Select a site: <span v-bind=\"this.site\">\n            {{ site }}</span></label><br>\n        </p>\n        <p>\n          <SiteSelector id=\"csvSite\" v-model=\"site\" :show-all-sites-item=\"false\"\n            :switch-site-on-select=\"false\"\n            :show-selected-site=\"true\"\n            :default-to-first-site=\"true\"\n            @update:model-value=\"site = $event; websiteChanged()\"\n            ></SiteSelector>\n        </p>\n        <p>\n          <label for=\"date\">\n            <b>\n              Date:\n            </b>\n          </label>\n        </p>\n        <p>\n          <input type=\"date\" id=\"date\" name=\"date\" v-model=\"date\" @change=\"dateChanged\"\n           style=\"max-width:200px;\">\n        </p>\n        <p>\n          <button @click=\"downloadCSV\" class=\"btn\">Download CSV</button>\n        </p>\n      </div>\n\n      <MatomoDialog v-model=\"showDialog\">\n        <div class=\"ui-confirm exampleDialog\">\n          <h2>CSV Export - Select all visits and actions by siteId</h2>\n          <h2>Alert</h2>\n          <p>\n            The count is greater than 1 right now!\n          </p>\n\n          <input type=\"button\" value=\"OK\" role=\"yes\" />\n        </div>\n      </MatomoDialog>\n    </div>\n  </div>\n</template>\n\n<style lang=\"less\" scoped>\n.example-component {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  button {\n    background-color: indigo;\n    color: white;\n    margin: 8px;\n  }\n}\n</style>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport {\n  translate,\n  AjaxHelper,\n  MatomoDialog,\n  SiteSelector,\n  SiteRef,\n  Site,\n  Matomo,\n} from '../../../../CoreHome/vue/src/index.ts';\n// } from 'CoreHome';\n\ninterface CsvSectionState {\n  isLoading: boolean;\n  count: number;\n  showDialog: boolean;\n  idSite: string | number;\n  siteName: string;\n  site: SiteRef;\n  sites: Record<string, Site>;\n  tokenAuth: string;\n  login: string;\n  date: string;\n}\n\nexport default defineComponent({\n  props: {\n    defaultSite: {\n      type: Object,\n      required: true,\n    },\n  },\n  components: {\n    MatomoDialog,\n    SiteSelector,\n  },\n  data(): CsvSectionState {\n    return {\n      isLoading: false,\n      count: 12,\n      showDialog: false,\n      idSite: '',\n      siteName: '',\n      site: this.defaultSite as SiteRef,\n      sites: {},\n      tokenAuth: '', // Placeholder for the token_auth\n      login: '',\n      date: '',\n    };\n  },\n  async mounted() {\n    console.log('Mounted...');\n    console.log('Sites:', this.sites);\n  },\n  setup() {\n    console.log('Setup...');\n    const sitesPromise = AjaxHelper.fetch<(string | number)[]>({\n      method: 'SitesManager.getSitesIdWithAdminAccess',\n      filter_limit: '-1',\n    });\n\n    return {\n      translate,\n      getSites() {\n        return sitesPromise;\n      },\n    };\n  },\n  methods: {\n    downloadCSV() {\n      console.log('Download CSV for site ID:', this.site);\n      console.log('Date:', this.date);\n\n      if (!this.site) {\n        console.error('Site ID is undefined or not selected.');\n        return;\n      }\n      const redirectParams = {\n        module: 'DataExport',\n        action: 'selectAllVisitsAndActions',\n        idSite: this.site.id,\n        date: this.date,\n      };\n      // Redirect because download is not possible with ajax\n      Matomo.helper.redirect(redirectParams);\n    },\n    websiteChanged() {\n      console.log('websiteChanged this.site:', this.site);\n      console.log('websiteChanged this.site:', this.site);\n    },\n    dateChanged() {\n      console.log('dateChanged this.date:', this.date);\n    },\n    sendRequest() {\n      console.log('sendRequest: selectAllVisitsAndActionsSiteId');\n    },\n  },\n});\n</script>\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nexport function translate(\n  translationStringId: string,\n  ...values: (string|string[]|number|number[]|boolean|boolean[])[]\n): string {\n  if (!translationStringId) {\n    return '';\n  }\n\n  let pkArgs = values as (string|number|boolean)[];\n  // handle variadic args AND single array of values (to match _pk_translate signature)\n  if (values.length === 1 && values[0] && Array.isArray(values[0])) {\n    [pkArgs] = values as (string|number|boolean)[][];\n  }\n  return window._pk_translate(translationStringId, pkArgs); // eslint-disable-line\n}\n\nexport function translateOrDefault(\n  translationStringIdOrText?: string,\n  ...values: (string|string[]|number|number[]|boolean|boolean[])[]\n): string {\n  if (!translationStringIdOrText || !window.piwik_translations[translationStringIdOrText]) {\n    return translationStringIdOrText!;\n  }\n\n  return translate(translationStringIdOrText!, ...values);\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\ninterface Period {\n  getPrettyString(): string;\n  getDateRange(): Date[];\n  containsToday(): boolean;\n}\n\ninterface PeriodClass {\n  parse(strDate: string|Date): Period;\n  getDisplayText(): string;\n}\n\n/**\n * Matomo period management service for the frontend.\n *\n * Usage:\n *\n *     var DayPeriod = matomoPeriods.get('day');\n *     var day = new DayPeriod(new Date());\n *\n * or\n *\n *     var day = matomoPeriods.parse('day', '2013-04-05');\n *\n * Adding custom periods:\n *\n * To add your own period to the frontend, create a period class for it\n * w/ the following methods:\n *\n * - **getPrettyString()**: returns a human readable display string for the period.\n * - **getDateRange()**: returns an array w/ two elements, the first being the start\n *                       Date of the period, the second being the end Date. The dates\n *                       must be Date objects, not strings, and are inclusive.\n * - **containsToday()**: returns true if the date period contains today. False if not.\n * - (_static_) **parse(strDate)**: creates a new instance of this period from the\n *                                  value of the 'date' query parameter.\n * - (_static_) **getDisplayText**: returns translated text for the period, eg, 'month',\n *                                  'week', etc.\n *\n * Then call Periods.addCustomPeriod w/ your period class:\n *\n *     Periods.addCustomPeriod('mycustomperiod', MyCustomPeriod);\n *\n * NOTE: currently only single date periods like day, week, month year can\n *       be extended. Other types of periods that require a special UI to\n *       view/edit aren't, since there is currently no way to use a\n *       custom UI for a custom period.\n */\nclass Periods {\n  periods: {[name: string]: PeriodClass} = {};\n\n  periodOrder: string[] = [];\n\n  addCustomPeriod(name: string, periodClass: PeriodClass) {\n    if (this.periods[name]) {\n      throw new Error(`The \"${name}\" period already exists! It cannot be overridden.`);\n    }\n\n    this.periods[name] = periodClass;\n    this.periodOrder.push(name);\n  }\n\n  getAllLabels(): string[] {\n    return Array<string>().concat(this.periodOrder);\n  }\n\n  get(strPeriod: string): PeriodClass {\n    const periodClass = this.periods[strPeriod];\n    if (!periodClass) {\n      throw new Error(`Invalid period label: ${strPeriod}`);\n    }\n    return periodClass;\n  }\n\n  parse(strPeriod: string, strDate: string): Period {\n    return this.get(strPeriod).parse(strDate);\n  }\n\n  isRecognizedPeriod(strPeriod: string): boolean {\n    return !!this.periods[strPeriod];\n  }\n}\n\nexport default new Periods();\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nexport function format(date: Date): string {\n  return $.datepicker.formatDate('yy-mm-dd', date);\n}\n\nexport function getToday(): Date {\n  const date = new Date(Date.now());\n\n  // undo browser timezone\n  date.setTime(date.getTime() + date.getTimezoneOffset() * 60 * 1000);\n\n  // apply Matomo site timezone (if it exists)\n  date.setHours(date.getHours() + ((window.piwik.timezoneOffset || 0) / 3600));\n\n  // get rid of hours/minutes/seconds/etc.\n  date.setHours(0);\n  date.setMinutes(0);\n  date.setSeconds(0);\n  date.setMilliseconds(0);\n  return date;\n}\n\nexport function parseDate(date: string|Date): Date {\n  if (date instanceof Date) {\n    return date;\n  }\n\n  const strDate = decodeURIComponent(date).trim();\n  if (strDate === '') {\n    throw new Error('Invalid date, empty string.');\n  }\n\n  if (strDate === 'today'\n    || strDate === 'now'\n  ) {\n    return getToday();\n  }\n\n  if (strDate === 'yesterday'\n    // note: ignoring the 'same time' part since the frontend doesn't care about the time\n    || strDate === 'yesterdaySameTime'\n  ) {\n    const yesterday = getToday();\n    yesterday.setDate(yesterday.getDate() - 1);\n    return yesterday;\n  }\n\n  if (strDate.match(/last[ -]?week/i)) {\n    const lastWeek = getToday();\n    lastWeek.setDate(lastWeek.getDate() - 7);\n    return lastWeek;\n  }\n\n  if (strDate.match(/last[ -]?month/i)) {\n    const lastMonth = getToday();\n    lastMonth.setDate(1);\n    lastMonth.setMonth(lastMonth.getMonth() - 1);\n    return lastMonth;\n  }\n\n  if (strDate.match(/last[ -]?year/i)) {\n    const lastYear = getToday();\n    lastYear.setFullYear(lastYear.getFullYear() - 1);\n    return lastYear;\n  }\n\n  return $.datepicker.parseDate('yy-mm-dd', strDate);\n}\n\nexport function todayIsInRange(dateRange: Date[]): boolean {\n  if (dateRange.length !== 2) {\n    return false;\n  }\n\n  if (getToday() >= dateRange[0] && getToday() <= dateRange[1]) {\n    return true;\n  }\n\n  return false;\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { translate } from '../translate';\nimport Periods from './Periods';\nimport { parseDate, format, todayIsInRange } from './utilities';\n\nexport default class DayPeriod {\n  constructor(private dateInPeriod: Date) {}\n\n  static parse(strDate: string): DayPeriod {\n    return new DayPeriod(parseDate(strDate));\n  }\n\n  static getDisplayText(): string {\n    return translate('Intl_PeriodDay');\n  }\n\n  getPrettyString(): string {\n    return format(this.dateInPeriod);\n  }\n\n  getDateRange(): Date[] {\n    return [new Date(this.dateInPeriod.getTime()), new Date(this.dateInPeriod.getTime())];\n  }\n\n  containsToday(): boolean {\n    return todayIsInRange(this.getDateRange());\n  }\n}\n\nPeriods.addCustomPeriod('day', DayPeriod);\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { translate } from '../translate';\nimport Periods from './Periods';\nimport { parseDate, format, todayIsInRange } from './utilities';\n\nexport default class WeekPeriod {\n  constructor(private dateInPeriod: Date) {}\n\n  static parse(strDate: string): WeekPeriod {\n    return new WeekPeriod(parseDate(strDate));\n  }\n\n  static getDisplayText(): string {\n    return translate('Intl_PeriodWeek');\n  }\n\n  getPrettyString(): string {\n    const weekDates = this.getDateRange();\n    const startWeek = format(weekDates[0]);\n    const endWeek = format(weekDates[1]);\n\n    return translate('General_DateRangeFromTo', [startWeek, endWeek]);\n  }\n\n  getDateRange(): Date[] {\n    const daysToMonday = (this.dateInPeriod.getDay() + 6) % 7;\n\n    const startWeek = new Date(this.dateInPeriod.getTime());\n    startWeek.setDate(this.dateInPeriod.getDate() - daysToMonday);\n\n    const endWeek = new Date(startWeek.getTime());\n    endWeek.setDate(startWeek.getDate() + 6);\n\n    return [startWeek, endWeek];\n  }\n\n  containsToday(): boolean {\n    return todayIsInRange(this.getDateRange());\n  }\n}\n\nPeriods.addCustomPeriod('week', WeekPeriod);\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { translate } from '../translate';\nimport Periods from './Periods';\nimport { parseDate, todayIsInRange } from './utilities';\n\nexport default class MonthPeriod {\n  constructor(private dateInPeriod: Date) {}\n\n  static parse(strDate: string): MonthPeriod {\n    return new MonthPeriod(parseDate(strDate));\n  }\n\n  static getDisplayText(): string {\n    return translate('Intl_PeriodMonth');\n  }\n\n  getPrettyString(): string {\n    const month = translate(`Intl_Month_Long_StandAlone_${this.dateInPeriod.getMonth() + 1}`);\n    return `${month} ${this.dateInPeriod.getFullYear()}`;\n  }\n\n  getDateRange(): Date[] {\n    const startMonth = new Date(this.dateInPeriod.getTime());\n    startMonth.setDate(1);\n\n    const endMonth = new Date(this.dateInPeriod.getTime());\n    endMonth.setDate(1);\n    endMonth.setMonth(endMonth.getMonth() + 1);\n    endMonth.setDate(0);\n\n    return [startMonth, endMonth];\n  }\n\n  containsToday(): boolean {\n    return todayIsInRange(this.getDateRange());\n  }\n}\n\nPeriods.addCustomPeriod('month', MonthPeriod);\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { translate } from '../translate';\nimport Periods from './Periods';\nimport { parseDate, todayIsInRange } from './utilities';\n\nexport default class YearPeriod {\n  constructor(private dateInPeriod: Date) {}\n\n  static parse(strDate: string): YearPeriod {\n    return new YearPeriod(parseDate(strDate));\n  }\n\n  static getDisplayText(): string {\n    return translate('Intl_PeriodYear');\n  }\n\n  getPrettyString(): string {\n    return this.dateInPeriod.getFullYear().toString();\n  }\n\n  getDateRange(): Date[] {\n    const startYear = new Date(this.dateInPeriod.getTime());\n    startYear.setMonth(0);\n    startYear.setDate(1);\n\n    const endYear = new Date(this.dateInPeriod.getTime());\n    endYear.setMonth(12);\n    endYear.setDate(0);\n\n    return [startYear, endYear];\n  }\n\n  containsToday(): boolean {\n    return todayIsInRange(this.getDateRange());\n  }\n}\n\nPeriods.addCustomPeriod('year', YearPeriod);\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport Periods from '../Periods/Periods';\n\nlet originalTitle: string;\n\nconst { piwik, broadcast, piwikHelper } = window;\n\npiwik.helper = piwikHelper;\npiwik.broadcast = broadcast;\n\npiwik.updateDateInTitle = function updateDateInTitle(date: string, period: string) {\n  if (!$('.top_controls #periodString').length) {\n    return;\n  }\n\n  // Cache server-rendered page title\n  originalTitle = originalTitle || document.title;\n\n  if (originalTitle.indexOf(piwik.siteName) === 0) {\n    const dateString = ` - ${Periods.parse(period, date).getPrettyString()} `;\n    document.title = `${piwik.siteName}${dateString}${originalTitle.slice(piwik.siteName.length)}`;\n  }\n};\n\npiwik.hasUserCapability = function hasUserCapability(capability: string) {\n  return Array.isArray(piwik.userCapabilities)\n    && piwik.userCapabilities.indexOf(capability) !== -1;\n};\n\npiwik.on = function addMatomoEventListener(eventName: string, listener: WrappedEventListener) {\n  function listenerWrapper(evt: Event) {\n    listener(...(evt as CustomEvent<any[]>).detail); // eslint-disable-line\n  }\n\n  listener.wrapper = listenerWrapper;\n\n  window.addEventListener(eventName, listenerWrapper);\n};\n\npiwik.off = function removeMatomoEventListener(eventName: string, listener: WrappedEventListener) {\n  if (listener.wrapper) {\n    window.removeEventListener(eventName, listener.wrapper);\n  }\n};\n\npiwik.postEvent = function postMatomoEvent(\n  eventName: string,\n  ...args: any[] // eslint-disable-line\n): void {\n  const event = new CustomEvent(eventName, { detail: args });\n  window.dispatchEvent(event);\n};\n\nconst Matomo = piwik;\nexport default Matomo;\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { translate } from '../translate';\nimport Periods from './Periods';\nimport {\n  parseDate,\n  format,\n  getToday,\n  todayIsInRange,\n} from './utilities';\n\nexport default class RangePeriod {\n  constructor(\n    public readonly startDate: Date,\n    public readonly endDate: Date,\n    public readonly childPeriodType: string,\n  ) {}\n\n  /**\n   * Returns a range representing the last N childPeriodType periods, including the current one.\n   */\n  static getLastNRange(\n    childPeriodType: string,\n    strAmount: string|number,\n    strEndDate?: Date|string,\n  ): RangePeriod {\n    const nAmount = Math.max(parseInt(strAmount.toString(), 10) - 1, 0);\n    if (Number.isNaN(nAmount)) {\n      throw new Error('Invalid range strAmount');\n    }\n\n    let endDate = strEndDate ? parseDate(strEndDate) : getToday();\n\n    let startDate = new Date(endDate.getTime());\n    if (childPeriodType === 'day') {\n      startDate.setDate(startDate.getDate() - nAmount);\n    } else if (childPeriodType === 'week') {\n      startDate.setDate(startDate.getDate() - (nAmount * 7));\n    } else if (childPeriodType === 'month') {\n      startDate.setDate(1);\n      startDate.setMonth(startDate.getMonth() - nAmount);\n    } else if (childPeriodType === 'year') {\n      startDate.setFullYear(startDate.getFullYear() - nAmount);\n    } else {\n      throw new Error(`Unknown period type '${childPeriodType}'.`);\n    }\n\n    if (childPeriodType !== 'day') {\n      const startPeriod = Periods.periods[childPeriodType].parse(startDate);\n      const endPeriod = Periods.periods[childPeriodType].parse(endDate);\n\n      [startDate] = startPeriod.getDateRange();\n      [, endDate] = endPeriod.getDateRange();\n    }\n\n    const firstWebsiteDate = new Date(1991, 7, 6);\n    if (startDate.getTime() - firstWebsiteDate.getTime() < 0) {\n      switch (childPeriodType) {\n        case 'year':\n          startDate = new Date(1992, 0, 1);\n          break;\n        case 'month':\n          startDate = new Date(1991, 8, 1);\n          break;\n        case 'week':\n          startDate = new Date(1991, 8, 12);\n          break;\n        case 'day':\n        default:\n          startDate = firstWebsiteDate;\n          break;\n      }\n    }\n\n    return new RangePeriod(startDate, endDate, childPeriodType);\n  }\n\n  /**\n   * Returns a range representing a specific child date range counted back from the end date\n   *\n   * @param childPeriodType Type of the period, eg. day, week, year\n   * @param rangeEndDate\n   * @param countBack Return only the child date range for this specific period number\n   * @returns {RangePeriod}\n   */\n  static getLastNRangeChild(\n    childPeriodType: string,\n    rangeEndDate: Date|string,\n    countBack: number,\n  ): RangePeriod {\n    const ed = rangeEndDate ? parseDate(rangeEndDate) : getToday();\n    let startDate = new Date(ed.getTime());\n    let endDate = new Date(ed.getTime());\n\n    if (childPeriodType === 'day') {\n      startDate.setDate(startDate.getDate() - countBack);\n      endDate.setDate(endDate.getDate() - countBack);\n    } else if (childPeriodType === 'week') {\n      startDate.setDate(startDate.getDate() - (countBack * 7));\n      endDate.setDate(endDate.getDate() - (countBack * 7));\n    } else if (childPeriodType === 'month') {\n      startDate.setDate(1);\n      startDate.setMonth(startDate.getMonth() - countBack);\n      endDate.setDate(1);\n      endDate.setMonth(endDate.getMonth() - countBack);\n    } else if (childPeriodType === 'year') {\n      startDate.setFullYear(startDate.getFullYear() - countBack);\n      endDate.setFullYear(endDate.getFullYear() - countBack);\n    } else {\n      throw new Error(`Unknown period type '${childPeriodType}'.`);\n    }\n\n    if (childPeriodType !== 'day') {\n      const startPeriod = Periods.periods[childPeriodType].parse(startDate);\n      const endPeriod = Periods.periods[childPeriodType].parse(endDate);\n\n      [startDate] = startPeriod.getDateRange();\n      [, endDate] = endPeriod.getDateRange();\n    }\n\n    const firstWebsiteDate = new Date(1991, 7, 6);\n    if (startDate.getTime() - firstWebsiteDate.getTime() < 0) {\n      switch (childPeriodType) {\n        case 'year':\n          startDate = new Date(1992, 0, 1);\n          break;\n        case 'month':\n          startDate = new Date(1991, 8, 1);\n          break;\n        case 'week':\n          startDate = new Date(1991, 8, 12);\n          break;\n        case 'day':\n        default:\n          startDate = firstWebsiteDate;\n          break;\n      }\n    }\n\n    return new RangePeriod(startDate, endDate, childPeriodType);\n  }\n\n  static parse(strDate: string, childPeriodType = 'day'): RangePeriod {\n    if (/^previous/.test(strDate)) {\n      const endDate = RangePeriod.getLastNRange(childPeriodType, '2').startDate;\n      return RangePeriod.getLastNRange(childPeriodType, strDate.substring(8), endDate);\n    }\n\n    if (/^last/.test(strDate)) {\n      return RangePeriod.getLastNRange(childPeriodType, strDate.substring(4));\n    }\n\n    const parts = decodeURIComponent(strDate).split(',');\n    return new RangePeriod(parseDate(parts[0]), parseDate(parts[1]), childPeriodType);\n  }\n\n  static getDisplayText(): string {\n    return translate('General_DateRangeInPeriodList');\n  }\n\n  getPrettyString(): string {\n    const start = format(this.startDate);\n    const end = format(this.endDate);\n    return translate('General_DateRangeFromTo', [start, end]);\n  }\n\n  getDateRange(): Date[] {\n    return [this.startDate, this.endDate];\n  }\n\n  containsToday(): boolean {\n    return todayIsInRange(this.getDateRange());\n  }\n\n  getDayCount(): number {\n    return (Math.ceil((this.endDate.getTime() - this.startDate.getTime()) / (1000 * 3600 * 24))\n            + 1);\n  }\n}\n\nPeriods.addCustomPeriod('range', RangePeriod);\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { computed, ref, readonly } from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport { Periods, format } from '../Periods'; // important to load all periods here\n\nconst { piwik, broadcast } = window;\n\nfunction isValidPeriod(periodStr: string, dateStr: string) {\n  try {\n    Periods.parse(periodStr, dateStr);\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\n// using unknown since readonly does not work well with recursive types like QueryParameters\ntype ParsedQueryParameters = Record<string, unknown>;\n\n/**\n * URL store and helper functions.\n */\nclass MatomoUrl {\n  readonly url = ref<URL|null>(null);\n\n  readonly urlQuery = computed(\n    () => (this.url.value ? this.url.value.search.replace(/^\\?/, '') : ''),\n  );\n\n  readonly hashQuery = computed(\n    () => (this.url.value ? this.url.value.hash.replace(/^[#/?]+/, '') : ''),\n  );\n\n  readonly urlParsed = computed(() => readonly(\n    this.parse(this.urlQuery.value) as ParsedQueryParameters,\n  ));\n\n  readonly hashParsed = computed(() => readonly(\n    this.parse(this.hashQuery.value) as ParsedQueryParameters,\n  ));\n\n  readonly parsed = computed(() => readonly({\n    ...this.urlParsed.value,\n    ...this.hashParsed.value,\n  } as ParsedQueryParameters));\n\n  constructor() {\n    this.url.value = new URL(window.location.href);\n\n    window.addEventListener('hashchange', (event) => {\n      this.url.value = new URL(event.newURL);\n      this.updatePeriodParamsFromUrl();\n    });\n\n    this.updatePeriodParamsFromUrl();\n  }\n\n  updateHashToUrl(urlWithoutLeadingHash: string) {\n    const wholeHash = `#${urlWithoutLeadingHash}`;\n\n    if (window.location.hash === wholeHash) { // trigger event manually since the url is the same\n      window.dispatchEvent(new HashChangeEvent('hashchange', {\n        newURL: window.location.href,\n        oldURL: window.location.href,\n      }));\n    } else {\n      window.location.hash = wholeHash;\n    }\n  }\n\n  updateHash(params: QueryParameters|string) {\n    const modifiedParams = this.getFinalHashParams(params);\n    const serializedParams = this.stringify(modifiedParams);\n\n    this.updateHashToUrl(`?${serializedParams}`);\n  }\n\n  updateUrl(params: QueryParameters|string, hashParams: QueryParameters|string = {}) {\n    const serializedParams: string = typeof params !== 'string' ? this.stringify(params) : params;\n\n    const modifiedHashParams = Object.keys(hashParams).length\n      ? this.getFinalHashParams(hashParams, params)\n      : {};\n\n    const serializedHashParams: string = this.stringify(modifiedHashParams);\n\n    let url = `?${serializedParams}`;\n    if (serializedHashParams.length) {\n      url = `${url}#?${serializedHashParams}`;\n    }\n\n    window.broadcast.propagateNewPage('', undefined, undefined, undefined, url);\n  }\n\n  private getFinalHashParams(\n    params: QueryParameters|string,\n    urlParams: QueryParameters|string = {},\n  ) {\n    const paramsObj = typeof params !== 'string'\n      ? params as QueryParameters\n      : this.parse(params as string);\n\n    const urlParamsObj = typeof params !== 'string'\n      ? urlParams as QueryParameters\n      : this.parse(urlParams as string);\n\n    return {\n      // these params must always be present in the hash\n      period: urlParamsObj.period || this.parsed.value.period,\n      date: urlParamsObj.date || this.parsed.value.date,\n      segment: urlParamsObj.segment || this.parsed.value.segment,\n\n      ...paramsObj,\n    };\n  }\n\n  // if we're in an embedded context, loads an entire new URL, otherwise updates the hash\n  updateLocation(params: QueryParameters|string) {\n    if (Matomo.helper.isReportingPage()) {\n      this.updateHash(params);\n      return;\n    }\n\n    this.updateUrl(params);\n  }\n\n  getSearchParam(paramName: string): string {\n    const hash = window.location.href.split('#');\n\n    const regex = new RegExp(`${paramName}(\\\\[]|=)`);\n    if (hash && hash[1] && regex.test(decodeURIComponent(hash[1]))) {\n      const valueFromHash = window.broadcast.getValueFromHash(paramName, window.location.href);\n\n      // for date, period and idsite fall back to parameter from url, if non in hash was provided\n      if (valueFromHash\n        || (paramName !== 'date' && paramName !== 'period' && paramName !== 'idSite')\n      ) {\n        return valueFromHash;\n      }\n    }\n\n    return window.broadcast.getValueFromUrl(paramName, window.location.search);\n  }\n\n  parse(query: string): QueryParameters {\n    return broadcast.getValuesFromUrl(`?${query}`, true);\n  }\n\n  stringify(search: QueryParameters): string {\n    const searchWithoutEmpty = Object.fromEntries(\n      Object.entries(search).filter(([, value]) => value !== '' && value !== null && value !== undefined),\n    );\n\n    // using jQuery since URLSearchParams does not handle array params the way Matomo uses them\n    return $.param(searchWithoutEmpty).replace(/%5B%5D/g, '[]')\n      // some browsers treat URLs w/ date=a,b differently from date=a%2Cb, causing multiple\n      // entries to show up in the browser history.\n      .replace(/%2C/g, ',')\n      // jquery seems to encode space characters as '+', but certain parts of matomo won't\n      // decode it correctly, so we make sure to use %20 instead\n      .replace(/\\+/g, '%20');\n  }\n\n  updatePeriodParamsFromUrl(): void {\n    let date = this.getSearchParam('date');\n    const period = this.getSearchParam('period');\n    if (!isValidPeriod(period, date)) {\n      // invalid data in URL\n      return;\n    }\n\n    if (piwik.period === period && piwik.currentDateString === date) {\n      // this period / date is already loaded\n      return;\n    }\n\n    piwik.period = period;\n\n    const dateRange = Periods.parse(period, date).getDateRange();\n    piwik.startDateString = format(dateRange[0]);\n    piwik.endDateString = format(dateRange[1]);\n\n    piwik.updateDateInTitle(date, period);\n\n    // do not set anything to previousN/lastN, as it's more useful to plugins\n    // to have the dates than previousN/lastN.\n    if (piwik.period === 'range') {\n      date = `${piwik.startDateString},${piwik.endDateString}`;\n    }\n\n    piwik.currentDateString = date;\n  }\n}\n\nconst instance = new MatomoUrl();\nexport default instance;\n\npiwik.updatePeriodParamsFromUrl = instance.updatePeriodParamsFromUrl.bind(instance);\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\n/* eslint-disable max-classes-per-file */\n\nimport jqXHR = JQuery.jqXHR;\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport Matomo from '../Matomo/Matomo';\n\nexport interface AjaxOptions {\n  withTokenInUrl?: boolean;\n  postParams?: QueryParameters;\n  headers?: Record<string, string>;\n  format?: string;\n  createErrorNotification?: boolean;\n  abortController?: AbortController;\n  returnResponseObject?: boolean;\n  errorElement?: HTMLElement|JQuery|string;\n  redirectOnSuccess?: QueryParameters|boolean;\n}\n\ninterface ErrorResponse {\n  result: string;\n  message: string;\n}\n\nconst { $ } = window;\n\nwindow.globalAjaxQueue = [] as unknown as GlobalAjaxQueue;\nwindow.globalAjaxQueue.active = 0;\n\nwindow.globalAjaxQueue.clean = function globalAjaxQueueClean() {\n  for (let i = this.length; i >= 0; i -= 1) {\n    if (!this[i] || this[i]!.readyState === 4) {\n      this.splice(i, 1);\n    }\n  }\n};\n\nwindow.globalAjaxQueue.push = function globalAjaxQueuePush(...args: (XMLHttpRequest|null)[]) {\n  this.active += args.length;\n\n  // cleanup ajax queue\n  this.clean();\n\n  // call original array push\n  return Array.prototype.push.call(this, ...args);\n};\n\nwindow.globalAjaxQueue.abort = function globalAjaxQueueAbort() {\n  // abort all queued requests if possible\n  this.forEach((x) => x && x.abort && x.abort());\n\n  // remove all elements from array\n  this.splice(0, this.length);\n\n  this.active = 0;\n};\n\ntype AnyFunction = (...params:any[]) => any; // eslint-disable-line\n\n/**\n * error callback to use by default\n */\nfunction defaultErrorCallback(deferred: XMLHttpRequest, status: string): void {\n  // do not display error message if request was aborted\n  if (status === 'abort' || !deferred || deferred.status === 0) {\n    return;\n  }\n\n  if (typeof Piwik_Popover === 'undefined') {\n    console.log(`Request failed: ${deferred.responseText}`); // mostly for tests\n    return;\n  }\n\n  if (Piwik_Popover.isOpen() && deferred && deferred.status === 500) {\n    $(document.body).html(piwikHelper.escape(deferred.responseText));\n  } else {\n    $('#loadingError').show();\n  }\n}\n\nclass ApiResponseError extends Error {}\n\n/**\n * Global ajax helper to handle requests within Matomo\n */\nexport default class AjaxHelper<T = any> { // eslint-disable-line\n  /**\n   * Format of response\n   */\n  format = 'json';\n\n  /**\n   * A timeout for the request which will override any global timeout\n   */\n  timeout: number|null = null;\n\n  /**\n   * Callback function to be executed on success\n   */\n  callback: AnyFunction|null = null;\n\n  /**\n   * Use this.callback if an error is returned\n   */\n  useRegularCallbackInCaseOfError = false;\n\n  /**\n   * Callback function to be executed on error\n   *\n   * @deprecated use the jquery promise API\n   */\n  errorCallback: AnyFunction|null;\n\n  withToken = false;\n\n  /**\n   * Callback function to be executed on complete (after error or success)\n   *\n   * @deprecated use the jquery promise API\n   */\n  completeCallback?: AnyFunction;\n\n  /**\n   * Params to be passed as GET params\n   * @see ajaxHelper.mixinDefaultGetParams\n   */\n  getParams: QueryParameters = {};\n\n  /**\n   * Base URL used in the AJAX request. Can be set by setUrl.\n   *\n   * It is set to '?' rather than 'index.php?' to increase chances that it works\n   * including for users who have an automatic 301 redirection from index.php? to ?\n   * POST values are missing when there is such 301 redirection. So by by-passing\n   * this 301 redirection, we avoid this issue.\n   *\n   * @see ajaxHelper.setUrl\n   */\n  getUrl = '?';\n\n  /**\n   * Params to be passed as GET params\n   * @see ajaxHelper.mixinDefaultPostParams\n   */\n  postParams: QueryParameters = {};\n\n  /**\n   * Element to be displayed while loading\n   */\n  loadingElement: HTMLElement|null|JQuery|string = null;\n\n  /**\n   * Element to be displayed on error\n   */\n  errorElement: HTMLElement|JQuery|string = '#ajaxError';\n\n  /**\n   * Extra headers to add to the request.\n   */\n  headers?: Record<string, string> = {\n    'X-Requested-With': 'XMLHttpRequest',\n  };\n\n  /**\n   * Handle for current request\n   */\n  requestHandle: JQuery.jqXHR|null = null;\n\n  abortController: AbortController|null = null;\n\n  defaultParams = ['idSite', 'period', 'date', 'segment'];\n\n  resolveWithHelper = false;\n\n  // helper method entry point\n  static fetch<R = any>( // eslint-disable-line\n    params: QueryParameters|QueryParameters[],\n    options: AjaxOptions = {},\n  ): Promise<R> {\n    const helper = new AjaxHelper<R>();\n    if (options.withTokenInUrl) {\n      helper.withTokenInUrl();\n    }\n    if (options.errorElement) {\n      helper.setErrorElement(options.errorElement);\n    }\n    if (options.redirectOnSuccess) {\n      helper.redirectOnSuccess(\n        options.redirectOnSuccess !== true ? options.redirectOnSuccess : undefined,\n      );\n    }\n    helper.setFormat(options.format || 'json');\n    if (Array.isArray(params)) {\n      helper.setBulkRequests(...(params as QueryParameters[]));\n    } else {\n      Object.keys(params).forEach((key) => {\n        if (/password/i.test(key)) {\n          throw new Error(`Password parameters are not allowed to be sent as GET parameter. Please send ${key} as POST parameter instead.`);\n        }\n      });\n\n      helper.addParams({\n        module: 'API',\n        format: options.format || 'json',\n        ...params,\n        // ajax helper does not encode the segment parameter assuming it is already encoded. this is\n        // probably for pre-angularjs code, so we don't want to do this now, but just treat segment\n        // as a normal query parameter input (so it will have double encoded values in input params\n        // object, then naturally triple encoded in the URL after a $.param call), however we need\n        // to support any existing uses of the old code, so instead we do a manual encode here. new\n        // code that uses .fetch() will not need to pre-encode the parameter, while old code\n        // can pre-encode it.\n        segment: params.segment ? encodeURIComponent(params.segment as string) : undefined,\n      }, 'get');\n    }\n    if (options.postParams) {\n      helper.addParams(options.postParams, 'post');\n    }\n    if (options.headers) {\n      helper.headers = { ...helper.headers, ...options.headers };\n    }\n\n    let createErrorNotification = true;\n    if (typeof options.createErrorNotification !== 'undefined'\n      && !options.createErrorNotification\n    ) {\n      helper.useCallbackInCaseOfError();\n      helper.setErrorCallback(null);\n      createErrorNotification = false;\n    }\n\n    if (options.abortController) {\n      helper.abortController = options.abortController;\n    }\n\n    if (options.returnResponseObject) {\n      helper.resolveWithHelper = true;\n    }\n\n    return helper.send().then((result: R | ErrorResponse | AjaxHelper) => {\n      const data = result instanceof AjaxHelper ? result.requestHandle!.responseJSON : result;\n\n      // check for error if not using default notification behavior\n      const results = helper.postParams.method === 'API.getBulkRequest' && Array.isArray(data) ? data : [data];\n      const errors = results.filter((r) => r.result === 'error').map((r) => r.message as string);\n\n      if (errors.length) {\n        throw new ApiResponseError(errors.filter((e) => e.length).join('\\n'));\n      }\n\n      return result as R;\n    }).catch((xhr: jqXHR) => {\n      if (createErrorNotification || xhr instanceof ApiResponseError) {\n        throw xhr;\n      }\n\n      let message = 'Something went wrong';\n      if (xhr.status === 504) {\n        message = 'Request was possibly aborted';\n      }\n      if (xhr.status === 429) {\n        message = 'Rate Limit was exceed';\n      }\n      throw new Error(message);\n    });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static post<R = any>(\n    params: QueryParameters,\n    // eslint-disable-next-line\n    postParams: any = {},\n    options: AjaxOptions = {},\n  ): Promise<R> {\n    return AjaxHelper.fetch<R>(params, { ...options, postParams });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static oneAtATime<R = any>(\n    method: string,\n    options?: AjaxOptions,\n  ): (params: QueryParameters, postParams?: QueryParameters) => Promise<R> {\n    let abortController: AbortController|null = null;\n\n    return (params: QueryParameters, postParams?: QueryParameters) => {\n      if (abortController) {\n        abortController.abort();\n      }\n\n      abortController = new AbortController();\n      return AjaxHelper.post<R>(\n        {\n          ...params,\n          method,\n        },\n        postParams,\n        {\n          ...options,\n          abortController,\n        },\n      ).finally(() => {\n        abortController = null;\n      });\n    };\n  }\n\n  constructor() {\n    this.errorCallback = defaultErrorCallback;\n  }\n\n  /**\n   * Adds params to the request.\n   * If params are given more then once, the latest given value is used for the request\n   *\n   * @param  initialParams\n   * @param  type  type of given parameters (POST or GET)\n   * @return {void}\n   */\n  addParams(initialParams: QueryParameters|string, type: string): void {\n    const params: QueryParameters = typeof initialParams === 'string'\n      ? window.broadcast.getValuesFromUrl(initialParams) : initialParams;\n\n    const arrayParams = ['compareSegments', 'comparePeriods', 'compareDates'];\n    Object.keys(params).forEach((key) => {\n      let value = params[key];\n      if (arrayParams.indexOf(key) !== -1\n        && !value\n      ) {\n        return;\n      }\n\n      if (typeof value === 'boolean') {\n        value = value ? 1 : 0;\n      }\n\n      if (type.toLowerCase() === 'get') {\n        this.getParams[key] = value;\n      } else if (type.toLowerCase() === 'post') {\n        this.postParams[key] = value;\n      }\n    });\n  }\n\n  withTokenInUrl(): void {\n    this.withToken = true;\n  }\n\n  /**\n   * Sets the base URL to use in the AJAX request.\n   */\n  setUrl(url: string): void {\n    this.addParams(broadcast.getValuesFromUrl(url), 'GET');\n  }\n\n  /**\n   * Gets this helper instance ready to send a bulk request. Each argument to this\n   * function is a single request to use.\n   */\n  setBulkRequests(...urls: Array<string|QueryParameters>): void {\n    const urlsProcessed = urls.map((u) => (typeof u === 'string' ? u : $.param(u)));\n\n    this.addParams({\n      module: 'API',\n      method: 'API.getBulkRequest',\n      urls: urlsProcessed,\n      format: 'json',\n    }, 'post');\n  }\n\n  /**\n   * Set a timeout (in milliseconds) for the request. This will override any global timeout.\n   *\n   * @param timeout  Timeout in milliseconds\n   */\n  setTimeout(timeout: number): void {\n    this.timeout = timeout;\n  }\n\n  /**\n   * Sets the callback called after the request finishes\n   *\n   * @param callback  Callback function\n   * @deprecated use the jquery promise API\n   */\n  setCallback(callback: AnyFunction): void {\n    this.callback = callback;\n  }\n\n  /**\n   * Set that the callback passed to setCallback() should be used if an application error (i.e. an\n   * Exception in PHP) is returned.\n   */\n  useCallbackInCaseOfError(): void {\n    this.useRegularCallbackInCaseOfError = true;\n  }\n\n  /**\n   * Set callback to redirect on success handler\n   * &update=1(+x) will be appended to the current url\n   *\n   * @param [params] to modify in redirect url\n   * @return {void}\n   */\n  redirectOnSuccess(params?: QueryParameters): void {\n    this.setCallback(() => {\n      piwikHelper.redirect(params);\n    });\n  }\n\n  /**\n   * Sets the callback called in case of an error within the request\n   *\n   * @deprecated use the jquery promise API\n   */\n  setErrorCallback(callback: AnyFunction|null): void {\n    this.errorCallback = callback;\n  }\n\n  /**\n   * Sets the complete callback which is called after an error or success callback.\n   *\n   * @deprecated use the jquery promise API\n   */\n  setCompleteCallback(callback: AnyFunction): void {\n    this.completeCallback = callback;\n  }\n\n  /**\n   * Sets the response format for the request\n   *\n   * @param format  response format (e.g. json, html, ...)\n   */\n  setFormat(format: string): void {\n    this.format = format;\n  }\n\n  /**\n   * Set the div element to show while request is loading\n   *\n   * @param [element]  selector for the loading element\n   */\n  setLoadingElement(element: string|HTMLElement|JQuery): void {\n    this.loadingElement = element || '#ajaxLoadingDiv';\n  }\n\n  /**\n   * Set the div element to show on error\n   *\n   * @param element  selector for the error element\n   */\n  setErrorElement(element: HTMLElement|JQuery|string): void {\n    if (!element) {\n      return;\n    }\n    this.errorElement = element;\n  }\n\n  /**\n   * Detect whether are allowed to use the given default parameter or not\n   */\n  private useGETDefaultParameter(parameter: string): boolean {\n    if (parameter && this.defaultParams) {\n      for (let i = 0; i < this.defaultParams.length; i += 1) {\n        if (this.defaultParams[i] === parameter) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Removes a default parameter that is usually send automatically along the request.\n   *\n   * @param parameter  A name such as \"period\", \"date\", \"segment\".\n   */\n  removeDefaultParameter(parameter: string): void {\n    if (parameter && this.defaultParams) {\n      for (let i = 0; i < this.defaultParams.length; i += 1) {\n        if (this.defaultParams[i] === parameter) {\n          this.defaultParams.splice(i, 1);\n        }\n      }\n    }\n  }\n\n  /**\n   * Send the request\n   */\n  send(): Promise<T | ErrorResponse> {\n    if ($(this.errorElement).length) {\n      $(this.errorElement).hide();\n    }\n\n    if (this.loadingElement) {\n      $(this.loadingElement).fadeIn();\n    }\n\n    this.requestHandle = this.buildAjaxCall();\n    window.globalAjaxQueue.push(this.requestHandle);\n\n    if (this.abortController) {\n      this.abortController.signal.addEventListener('abort', () => {\n        if (this.requestHandle) {\n          this.requestHandle.abort();\n        }\n      });\n    }\n\n    const result = new Promise<T | ErrorResponse>((resolve, reject) => {\n      this.requestHandle!.then((data: unknown) => {\n        if (this.resolveWithHelper) {\n          // NOTE: we can't resolve w/ the jquery xhr, because it's a promise, and will\n          // just result in following the promise chain back to 'data'\n          resolve(this as unknown as (T | ErrorResponse)); // casting hack here\n        } else {\n          resolve(data as (T | ErrorResponse)); // ignoring textStatus/jqXHR\n        }\n      }).fail((xhr: jqXHR) => {\n        if (xhr.status === 429) {\n          console.log(`Warning: the '${$.param(this.getParams)}' request was rate limited!`);\n          reject(xhr);\n          return;\n        }\n\n        if (xhr.statusText === 'abort' || xhr.status === 0) {\n          return;\n        }\n\n        console.log(`Warning: the ${$.param(this.getParams)} request failed!`);\n\n        reject(xhr);\n      });\n    });\n\n    return result;\n  }\n\n  /**\n   * Aborts the current request if it is (still) running\n   */\n  abort(): void {\n    if (this.requestHandle && typeof this.requestHandle.abort === 'function') {\n      this.requestHandle.abort();\n      this.requestHandle = null;\n    }\n  }\n\n  /**\n   * Builds and sends the ajax requests\n   */\n  private buildAjaxCall(): JQuery.jqXHR {\n    const self = this;\n    const parameters = this.mixinDefaultGetParams(this.getParams);\n\n    let url = this.getUrl;\n    if (url[url.length - 1] !== '?') {\n      url += '&';\n    }\n\n    // we took care of encoding &segment properly already, so we don't use $.param for it ($.param\n    // URL encodes the values)\n    if (parameters.segment) {\n      url = `${url}segment=${parameters.segment}&`;\n      delete parameters.segment;\n    }\n    if (parameters.date) {\n      url = `${url}date=${decodeURIComponent(parameters.date.toString())}&`;\n      delete parameters.date;\n    }\n    url += $.param(parameters);\n    const ajaxCall = {\n      type: 'POST',\n      async: true,\n      url,\n      dataType: this.format || 'json',\n      complete: this.completeCallback,\n      headers: this.headers ? this.headers : undefined,\n      error: function errorCallback(...args: any[]) { // eslint-disable-line\n        window.globalAjaxQueue.active -= 1;\n\n        if (self.errorCallback) {\n          self.errorCallback.apply(this, args);\n        }\n      },\n      success: (response: any, status: string, request: jqXHR) => { // eslint-disable-line\n        if (this.loadingElement) {\n          $(this.loadingElement).hide();\n        }\n\n        const results = this.postParams.method === 'API.getBulkRequest' && Array.isArray(response) ? response : [response];\n        const errors = results.filter((r) => r.result === 'error')\n          .map((r) => r.message as string)\n          .filter((e) => e.length)\n          // count occurrences of error messages\n          .reduce((acc: Record<string, number>, e: string) => {\n            acc[e] = (acc[e] || 0) + 1;\n            return acc;\n          }, {});\n\n        if (errors && Object.keys(errors).length && !this.useRegularCallbackInCaseOfError) {\n          let errorMessage = '';\n          Object.keys(errors).forEach((error) => {\n            if (errorMessage.length) {\n              errorMessage += '<br />';\n            }\n            // append error count if it occured more than once\n            if (errors[error] > 1) {\n              errorMessage += `${error} (${errors[error]}x)`;\n            } else {\n              errorMessage += error;\n            }\n          });\n          let placeAt = null;\n          let type: string|null = 'toast';\n          if ($(this.errorElement).length && errorMessage.length) {\n            $(this.errorElement).show();\n            placeAt = this.errorElement;\n            type = null;\n          }\n\n          const isLoggedIn = !document.querySelector('#login_form');\n          if (errorMessage && isLoggedIn) {\n            const UI = window['require']('piwik/UI'); // eslint-disable-line\n            const notification = new UI.Notification();\n            notification.show(errorMessage, {\n              placeat: placeAt,\n              context: 'error',\n              type,\n              id: 'ajaxHelper',\n            });\n            notification.scrollToNotification();\n          }\n        } else if (this.callback) {\n          this.callback(response, status, request);\n        }\n\n        window.globalAjaxQueue.active -= 1;\n        if (Matomo.ajaxRequestFinished) {\n          Matomo.ajaxRequestFinished();\n        }\n      },\n      data: this.mixinDefaultPostParams(this.postParams),\n      timeout: this.timeout !== null ? this.timeout : undefined,\n    };\n\n    return $.ajax(ajaxCall);\n  }\n\n  private isRequestToApiMethod() {\n    return (this.getParams && this.getParams.module === 'API' && this.getParams.method)\n      || (this.postParams && this.postParams.module === 'API' && this.postParams.method);\n  }\n\n  isWidgetizedRequest(): boolean {\n    return (broadcast.getValueFromUrl('module') === 'Widgetize');\n  }\n\n  private getDefaultPostParams() {\n    if (this.withToken || this.isRequestToApiMethod() || Matomo.shouldPropagateTokenAuth) {\n      return {\n        token_auth: Matomo.token_auth,\n        // When viewing a widgetized report there won't be any session that can be used, so don't\n        // force session usage\n        force_api_session: broadcast.isWidgetizeRequestWithoutSession() ? 0 : 1,\n      };\n    }\n\n    return {};\n  }\n\n  /**\n   * Mixin the default parameters to send as POST\n   *\n   * @param params   parameter object\n   */\n  private mixinDefaultPostParams(params: QueryParameters): QueryParameters {\n    const defaultParams = this.getDefaultPostParams();\n\n    const mergedParams = {\n      ...defaultParams,\n      ...params,\n    };\n\n    return mergedParams;\n  }\n\n  /**\n   * Mixin the default parameters to send as GET\n   *\n   * @param   params   parameter object\n   */\n  public mixinDefaultGetParams(originalParams: QueryParameters): QueryParameters {\n    const segment = MatomoUrl.getSearchParam('segment');\n\n    const defaultParams: Record<string, string> = {\n      idSite: Matomo.idSite ? Matomo.idSite.toString() : broadcast.getValueFromUrl('idSite'),\n      period: Matomo.period || broadcast.getValueFromUrl('period'),\n      segment,\n    };\n\n    const params = originalParams;\n\n    // never append token_auth to url\n    if (params.token_auth) {\n      params.token_auth = null;\n      delete params.token_auth;\n    }\n\n    Object.keys(defaultParams).forEach((key) => {\n      if (this.useGETDefaultParameter(key)\n        && (params[key] === null || typeof params[key] === 'undefined' || params[key] === '')\n        && (this.postParams[key] === null\n          || typeof this.postParams[key] === 'undefined'\n          || this.postParams[key] === '')\n        && defaultParams[key]\n      ) {\n        params[key] = defaultParams[key];\n      }\n    });\n\n    // handle default date & period if not already set\n    if (this.useGETDefaultParameter('date') && !params.date && !this.postParams.date) {\n      params.date = Matomo.currentDateString;\n    }\n\n    return params;\n  }\n\n  getRequestHandle(): jqXHR|null {\n    return this.requestHandle;\n  }\n}\n","import AjaxHelper from './AjaxHelper';\n\ndeclare global {\n  interface Window {\n    ajaxHelper: typeof AjaxHelper;\n  }\n}\n\nwindow.ajaxHelper = AjaxHelper;\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { watch } from 'vue';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\n\nconst { $ } = window;\n\nclass PopoverHandler {\n  constructor() {\n    this.setup();\n  }\n\n  private setup() {\n    watch(() => MatomoUrl.parsed.value.popover, () => this.onPopoverParamChanged());\n\n    if (MatomoUrl.parsed.value.popover) {\n      this.onPopoverParamChangedInitial();\n    }\n  }\n\n  // don't initiate the handler until the page had a chance to render,\n  // since some rowactions depend on what's been loaded.\n  private onPopoverParamChangedInitial() {\n    $(() => {\n      setTimeout(() => {\n        this.openOrClose();\n      });\n    });\n  }\n\n  private onPopoverParamChanged() {\n    // make sure all popover handles were registered\n    $(() => {\n      this.openOrClose();\n    });\n  }\n\n  private openOrClose() {\n    this.close();\n\n    // should be rather done by routing\n    const popoverParam = MatomoUrl.parsed.value.popover as string;\n    if (popoverParam) {\n      this.open(popoverParam);\n    } else {\n      // the URL should only be set to an empty popover if there are no popovers in the stack.\n      // to avoid avoid any strange inconsistent states, we reset the popover stack here.\n      window.broadcast.resetPopoverStack();\n    }\n  }\n\n  private close() {\n    window.Piwik_Popover.close();\n  }\n\n  private open(thePopoverParam: string) {\n    // in case the $ was encoded (e.g. when using copy&paste on urls in some browsers)\n    let popoverParam = decodeURIComponent(thePopoverParam);\n\n    // revert special encoding from broadcast.propagateNewPopoverParameter()\n    popoverParam = popoverParam.replace(/\\$/g, '%');\n    popoverParam = decodeURIComponent(popoverParam);\n\n    const popoverParamParts = popoverParam.split(':');\n    const handlerName = popoverParamParts[0];\n    popoverParamParts.shift();\n\n    const param = popoverParamParts.join(':');\n    if (typeof window.broadcast.popoverHandlers[handlerName] !== 'undefined'\n      && !window.broadcast.isLoginPage()\n    ) {\n      window.broadcast.popoverHandlers[handlerName](param);\n    }\n  }\n}\n\nexport default new PopoverHandler();\n","/*\n * General utils for managing cookies in Typescript.\n */\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function setCookie(name: string, val: string, seconds?: number) {\n  const date = new Date();\n\n  // set default day to 3 days\n  if (!seconds) {\n    // eslint-disable-next-line no-param-reassign\n    seconds = 3 * 24 * 60 * 1000;\n  }\n  // Set it expire in n days\n  date.setTime(date.getTime() + (seconds));\n\n  // Set it\n  document.cookie = `${name}=${val}; expires=${date.toUTCString()}; path=/`;\n}\n\n// eslint-disable-next-line consistent-return,@typescript-eslint/explicit-module-boundary-types\nexport function getCookie(name: string) {\n  const value = `; ${document.cookie}`;\n  const parts = value.split(`; ${name}=`);\n\n  // if cookie not exist return null\n  // eslint-disable-next-line eqeqeq\n  if (parts.length == 2) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    const data = parts.pop().split(';').shift();\n    if (typeof data !== 'undefined') {\n      return data;\n    }\n  }\n  return null;\n}\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function deleteCookie(name: string) {\n  const date = new Date();\n\n  // Set it expire in -1 days\n  date.setTime(date.getTime() + (-1 * 24 * 60 * 60 * 1000));\n\n  // Set it\n  document.cookie = `${name}=; expires=${date.toUTCString()}; path=/`;\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { translate } from './translate';\nimport Matomo from './Matomo/Matomo';\nimport { setCookie, getCookie } from './CookieHelper/CookieHelper';\n\nconst { $ } = window;\n\nfunction handleZenMode() {\n  let zenMode = !!parseInt(getCookie('zenMode')!, 10);\n  const iconSwitcher = $('.top_controls .icon-arrowup');\n\n  function updateZenMode() {\n    if (zenMode) {\n      $('body').addClass('zenMode');\n      iconSwitcher.addClass('icon-arrowdown').removeClass('icon-arrowup');\n      iconSwitcher.prop('title', translate('CoreHome_ExitZenMode'));\n    } else {\n      $('body').removeClass('zenMode');\n      iconSwitcher.removeClass('icon-arrowdown').addClass('icon-arrowup');\n      iconSwitcher.prop('title', translate('CoreHome_EnterZenMode'));\n    }\n  }\n\n  Matomo.helper.registerShortcut('z', translate('CoreHome_ShortcutZenMode'), (event) => {\n    if (event.altKey) {\n      return;\n    }\n\n    zenMode = !zenMode;\n    setCookie('zenMode', zenMode ? '1' : '0');\n    updateZenMode();\n  });\n\n  iconSwitcher.click(() => {\n    window.Mousetrap.trigger('z');\n  });\n\n  updateZenMode();\n}\n\nMatomo.on('Matomo.topControlsRendered', () => {\n  handleZenMode();\n});\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\n/**\n * Takes a raw URL and returns an HTML link tag for the URL, if the URL is for a matomo.org\n * domain then the URL will be modified to include campaign parameters\n *\n * @param url     URL to process\n * @param values  Optional [campaignOverride, sourceOverride, mediumOverride]\n * @return string\n */\nexport function externalRawLink(\n  url: string,\n  ...values: (string|null)[]\n): string {\n  const pkArgs = values as (string|null)[];\n  if (!window._pk_externalRawLink) { // eslint-disable-line\n    return url;\n  }\n  return window._pk_externalRawLink(url, pkArgs); // eslint-disable-line\n}\n\n/**\n * Takes a raw URL and returns an HTML link tag for the URL, if the URL is for a matomo.org\n * domain then the URL will be modified to include campaign parameters\n *\n * @param url              URL to process\n * @param values  Optional [campaignOverride, sourceOverride, mediumOverride]\n * @return string\n */\nexport function externalLink(\n  url: string,\n  ...values: (string|null)[]\n): string {\n  if (!url) {\n    return '';\n  }\n\n  const campaignOverride = (values.length > 0 && values[0] ? values[0] : null);\n  const sourceOverride = (values.length > 1 && values[1] ? values[1] : null);\n  const mediumOverride = (values.length > 2 && values[2] ? values[2] : null);\n  const returnUrl = externalRawLink(url, campaignOverride, sourceOverride, mediumOverride);\n\n  /* eslint-disable prefer-template */\n  return '<a target=\"_blank\" rel=\"noreferrer noopener\" href=\"' + returnUrl + '\">';\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { createApp } from 'vue';\nimport { translate, translateOrDefault } from './translate';\nimport { externalLink, externalRawLink } from './externalLink';\n\nexport default function createVueApp(\n  ...args: Parameters<typeof createApp>\n): ReturnType<typeof createApp> {\n  const app = createApp(...args);\n  app.config.globalProperties.$sanitize = window.vueSanitize;\n  app.config.globalProperties.translate = translate;\n  app.config.globalProperties.translateOrDefault = translateOrDefault;\n  app.config.globalProperties.externalLink = externalLink;\n  app.config.globalProperties.externalRawLink = externalRawLink;\n  return app;\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nconst pluginLoadingPromises: Record<string, Promise<unknown>> = {};\n\nconst PLUGIN_LOAD_TIMEOUT = 120;\nconst POLL_INTERVAL = 50;\nconst POLL_LIMIT = 1000;\n\n// code based off webpack's generated code for import()\n// currently does not load styles on demand\nexport default function importPluginUmd(plugin: string): Promise<unknown> {\n  if (pluginLoadingPromises[plugin]) {\n    return pluginLoadingPromises[plugin];\n  }\n\n  if ((window as any)[plugin]) {\n    return Promise.resolve((window as any)[plugin]);\n  }\n\n  const pluginUmdPath = `?module=Proxy&action=getPluginUmdJs&plugin=${plugin}`;\n\n  let promiseReject: ((value: unknown) => void) | undefined;\n  let promiseResolve: ((value: unknown) => void) | undefined;\n\n  const script = document.createElement('script') as any;\n  script.charset = 'utf-8';\n  script.timeout = PLUGIN_LOAD_TIMEOUT;\n  script.src = pluginUmdPath;\n\n  let timeout: ReturnType<typeof setTimeout>;\n\n  // create error before stack unwound to get useful stacktrace later\n  const error = new Error() as any;\n  const onScriptComplete = (event?: Event) => {\n    // avoid mem leaks in IE.\n    script.onerror = null;\n    script.onload = null;\n    clearTimeout(timeout);\n\n    // the script may not load entirely at the time onload is called, so we poll for a small\n    // amount of time until the window.PluginName object appears\n    let pollProgress = 0;\n    function checkPluginInWindow() {\n      pollProgress += POLL_INTERVAL;\n\n      // promise was already handled\n      if (!promiseReject || !promiseResolve) {\n        return;\n      }\n\n      // promise was not resolved, and window object exists\n      if ((window as any)[plugin] && promiseResolve) {\n        try {\n          promiseResolve((window as any)[plugin]);\n        } finally {\n          promiseReject = undefined;\n          promiseResolve = undefined;\n        }\n        return;\n      }\n\n      // script took too long to execute or failed to execute, and no plugin object appeared in\n      // window, so we report an error\n      if (pollProgress > POLL_LIMIT) {\n        try {\n          const errorType = event && (event.type === 'load' ? 'missing' : event.type);\n          const realSrc = event && event.target && (event.target as HTMLScriptElement).src;\n          error.message = `Loading plugin ${plugin} on demand failed.\\n(${errorType}: ${realSrc})`;\n          error.name = 'PluginOnDemandLoadError';\n          error.type = errorType;\n          error.request = realSrc;\n          promiseReject(error);\n        } finally {\n          promiseReject = undefined;\n          promiseResolve = undefined;\n        }\n\n        return;\n      }\n\n      setTimeout(checkPluginInWindow, POLL_INTERVAL);\n    }\n\n    setTimeout(checkPluginInWindow, POLL_INTERVAL);\n  };\n\n  timeout = setTimeout(() => {\n    onScriptComplete({ type: 'timeout', target: script } as unknown as Event);\n  }, PLUGIN_LOAD_TIMEOUT);\n  script.onerror = onScriptComplete;\n  script.onload = onScriptComplete;\n\n  document.head.appendChild(script);\n\n  return new Promise((resolve, reject) => {\n    promiseResolve = resolve;\n    promiseReject = reject;\n  });\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-ts-comment */\n\nimport { defineAsyncComponent } from 'vue';\nimport importPluginUmd from './importPluginUmd';\n\nexport default function useExternalPluginComponent(\n  plugin: string,\n  component: string,\n): typeof defineAsyncComponent {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return defineAsyncComponent(() => importPluginUmd(plugin).then((module: any) => {\n    if (!module) {\n      // @ts-ignore\n      resolve(null); // plugin not loaded\n    }\n\n    return module[component];\n  }));\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\n\nfunction getRef<T>(expander: string | HTMLElement, binding: DirectiveBinding<T>): HTMLElement|null {\n  return expander instanceof HTMLElement\n    ? expander\n    : binding.instance?.$refs[expander] as HTMLElement;\n}\n\nexport default {\n  getRef,\n};\n","const DEFAULT_DEBOUNCE_DELAY = 300;\n\nexport default function debounce<This, Args extends unknown[]>(\n  fn: (this: This, ...args: Args) => void,\n  delayInMs = DEFAULT_DEBOUNCE_DELAY,\n): (this: This, ...args: Args) => void {\n  let timeout: ReturnType<typeof setTimeout>;\n\n  return function wrapper(this: This, ...args: Args): void {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n\n    timeout = setTimeout(() => {\n      fn.call(this, ...args);\n    }, delayInMs);\n  };\n}\n","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div ref=\"root\">\n    <component v-if=\"componentWrapper\" :is=\"componentWrapper\"/>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, markRaw } from 'vue';\nimport Matomo from '../Matomo/Matomo';\n\nexport default defineComponent({\n  props: {\n    html: String,\n  },\n  mounted() {\n    Matomo.helper.compileVueEntryComponents(this.$refs.root as HTMLElement);\n  },\n  beforeUnmount() {\n    Matomo.helper.destroyVueComponent(this.$refs.root as HTMLElement);\n  },\n  computed: {\n    componentWrapper() {\n      if (!this.html) {\n        return null;\n      }\n\n      return markRaw({\n        template: this.html,\n      });\n    },\n  },\n});\n</script>\n","\nimport { defineComponent, markRaw } from 'vue';\nimport Matomo from '../Matomo/Matomo';\n\nexport default defineComponent({\n  props: {\n    html: String,\n  },\n  mounted() {\n    Matomo.helper.compileVueEntryComponents(this.$refs.root as HTMLElement);\n  },\n  beforeUnmount() {\n    Matomo.helper.destroyVueComponent(this.$refs.root as HTMLElement);\n  },\n  computed: {\n    componentWrapper() {\n      if (!this.html) {\n        return null;\n      }\n\n      return markRaw({\n        template: this.html,\n      });\n    },\n  },\n});\n","import { render } from \"./VueEntryContainer.vue?vue&type=template&id=54e7e876\"\nimport script from \"./VueEntryContainer.vue?vue&type=script&lang=ts\"\nexport * from \"./VueEntryContainer.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div v-show=\"loading\" class=\"loadingPiwik\">\n    <img src=\"plugins/Morpheus/images/loading-blue.gif\" alt=\"\"/>\n    <span>{{ loadingMessage }}</span>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { translate } from '../translate';\n\nexport default defineComponent({\n  props: {\n    loading: {\n      type: Boolean,\n      required: true,\n      default: false,\n    },\n    loadingMessage: {\n      type: String,\n      required: false,\n      default: translate('General_LoadingData'),\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport { translate } from '../translate';\n\nexport default defineComponent({\n  props: {\n    loading: {\n      type: Boolean,\n      required: true,\n      default: false,\n    },\n    loadingMessage: {\n      type: String,\n      required: false,\n      default: translate('General_LoadingData'),\n    },\n  },\n});\n","import { render } from \"./ActivityIndicator.vue?vue&type=template&id=7c5fe406\"\nimport script from \"./ActivityIndicator.vue?vue&type=script&lang=ts\"\nexport * from \"./ActivityIndicator.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    class=\"alert\"\n    :class=\"{ [`alert-${severity}`]: true }\"\n  >\n    <slot></slot>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  props: {\n    severity: {\n      type: String,\n      required: true,\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  props: {\n    severity: {\n      type: String,\n      required: true,\n    },\n  },\n});\n","import { render } from \"./Alert.vue?vue&type=template&id=c3863ae2\"\nimport script from \"./Alert.vue?vue&type=script&lang=ts\"\nexport * from \"./Alert.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\n\ninterface FocusAnywhereButHereArgs {\n  // input (provided by user)\n  blur: () => void,\n\n  // state/event handlers\n  isMouseDown?: boolean;\n  hasScrolled?: boolean;\n  onEscapeHandler?: (event: KeyboardEvent) => void;\n  onMouseDown?: () => void;\n  onClickOutsideElement?: (event: MouseEvent) => void;\n  onScroll?: () => void;\n}\n\nfunction onClickOutsideElement(\n  element: HTMLElement,\n  binding: DirectiveBinding<FocusAnywhereButHereArgs>,\n  event: MouseEvent,\n) {\n  const hadUsedScrollbar = binding.value.isMouseDown && binding.value.hasScrolled;\n  binding.value.isMouseDown = false;\n  binding.value.hasScrolled = false;\n\n  if (hadUsedScrollbar) {\n    return;\n  }\n\n  if (!element.contains(event.target as HTMLElement)) {\n    if (binding.value) {\n      binding.value.blur();\n    }\n  }\n}\n\nfunction onScroll(element: HTMLElement, binding: DirectiveBinding<FocusAnywhereButHereArgs>) {\n  binding.value.hasScrolled = true;\n}\n\nfunction onMouseDown(element: HTMLElement, binding: DirectiveBinding<FocusAnywhereButHereArgs>) {\n  binding.value.isMouseDown = true;\n  binding.value.hasScrolled = false;\n}\n\nfunction onEscapeHandler(\n  element: HTMLElement,\n  binding: DirectiveBinding<FocusAnywhereButHereArgs>,\n  event: KeyboardEvent,\n) {\n  if (event.which === 27) {\n    setTimeout(() => {\n      binding.value.isMouseDown = false;\n      binding.value.hasScrolled = false;\n      if (binding.value.blur) {\n        binding.value.blur();\n      }\n    }, 0);\n  }\n}\n\nconst doc = document.documentElement;\n\n/**\n * Usage (in a component):\n *\n * directives: {\n *   // function call is important since we store state in this directive\n *   FocusAnywhereButHere: FocusAnywhereButHere(),\n * }\n *\n * Note: the binding data needs to be static, changes will not be handled.\n */\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<FocusAnywhereButHereArgs>): void {\n    binding.value.isMouseDown = false;\n    binding.value.hasScrolled = false;\n    binding.value.onEscapeHandler = onEscapeHandler.bind(null, el, binding);\n    binding.value.onMouseDown = onMouseDown.bind(null, el, binding);\n    binding.value.onClickOutsideElement = onClickOutsideElement.bind(null, el, binding);\n    binding.value.onScroll = onScroll.bind(null, el, binding);\n\n    doc.addEventListener('keyup', binding.value.onEscapeHandler);\n    doc.addEventListener('mousedown', binding.value.onMouseDown);\n    doc.addEventListener('mouseup', binding.value.onClickOutsideElement);\n    doc.addEventListener('scroll', binding.value.onScroll);\n  },\n  unmounted(el: HTMLElement, binding: DirectiveBinding<FocusAnywhereButHereArgs>): void {\n    doc.removeEventListener('keyup', binding.value.onEscapeHandler!);\n    doc.removeEventListener('mousedown', binding.value.onMouseDown!);\n    doc.removeEventListener('mouseup', binding.value.onClickOutsideElement!);\n    doc.removeEventListener('scroll', binding.value.onScroll!);\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\n\ninterface FocusIfArgs {\n  // input (provided by user)\n  focused?: boolean;\n  afterFocus?: () => void;\n}\n\nfunction doFocusIf(el: HTMLElement, binding: DirectiveBinding<FocusIfArgs>): void {\n  if (binding.value?.focused && !binding.oldValue?.focused) {\n    setTimeout(() => {\n      el.focus();\n\n      if (binding.value.afterFocus) {\n        binding.value.afterFocus();\n      }\n    }, 5);\n  }\n}\n\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<FocusIfArgs>): void {\n    doFocusIf(el, binding);\n  },\n  updated(el: HTMLElement, binding: DirectiveBinding<FocusIfArgs>): void {\n    doFocusIf(el, binding);\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\n\ninterface TooltipsArgs {\n  content?: () => void;\n  delay?: number;\n  duration?: number;\n  show?: unknown;\n  tooltipClass?: string;\n}\n\nconst { $ } = window;\n\nfunction defaultContentTransform(this: HTMLElement) {\n  const title = $(this).attr('title') || '';\n  return window.vueSanitize(title.replace(/\\n/g, '<br />'));\n}\n\nfunction setupTooltips(el: HTMLElement, binding: DirectiveBinding<TooltipsArgs>) {\n  $(el).tooltip({\n    track: true,\n    content: binding.value?.content || defaultContentTransform,\n    show: typeof binding.value?.show !== 'undefined'\n      ? binding.value?.show\n      : {\n        delay: binding.value?.delay || 700,\n        duration: binding.value?.duration || 200,\n      },\n    hide: false,\n    tooltipClass: binding.value?.tooltipClass,\n  });\n}\n\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<TooltipsArgs>): void {\n    setTimeout(() => setupTooltips(el, binding));\n  },\n  updated(el: HTMLElement, binding: DirectiveBinding<TooltipsArgs>): void {\n    setTimeout(() => setupTooltips(el, binding));\n  },\n  beforeUnmount(el: HTMLElement): void {\n    try {\n      window.$(el).tooltip('destroy');\n    } catch (e) {\n      // ignore\n    }\n  },\n};\n","<!--\n  Matomo - free/libre analytics platform\n\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n<template>\n  <div v-show=\"modelValue\" ref=\"root\">\n    <slot></slot>\n  </div>\n</template>\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport Matomo from '../Matomo/Matomo';\n\nexport default defineComponent({\n  props: {\n    /**\n     * Whether the modal is displayed or not;\n     */\n    modelValue: {\n      type: Boolean,\n      required: true,\n    },\n  },\n  emits: ['yes', 'no', 'closeEnd', 'close', 'validation', 'update:modelValue'],\n  activated() {\n    this.$emit('update:modelValue', false);\n  },\n  watch: {\n    modelValue(newValue, oldValue) {\n      if (newValue) {\n        const slotElement = (this.$refs.root as HTMLElement).firstElementChild as HTMLElement;\n        Matomo.helper.modalConfirm(slotElement, {\n          yes: () => { this.$emit('yes'); },\n          no: () => { this.$emit('no'); },\n          validation: () => { this.$emit('validation'); },\n        }, {\n          onCloseEnd: () => {\n            // materialize removes the child element, so we move it back to the slot\n            (this.$refs.root as HTMLElement).appendChild(slotElement);\n            this.$emit('update:modelValue', false);\n            this.$emit('closeEnd');\n          },\n        });\n      } else if (newValue === false && oldValue === true) {\n        // the user closed the dialog, e.g. by pressing Esc or clicking away from it\n        $('.modal.open').modal('close');\n        this.$emit('close');\n      }\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport Matomo from '../Matomo/Matomo';\n\nexport default defineComponent({\n  props: {\n    /**\n     * Whether the modal is displayed or not;\n     */\n    modelValue: {\n      type: Boolean,\n      required: true,\n    },\n  },\n  emits: ['yes', 'no', 'closeEnd', 'close', 'validation', 'update:modelValue'],\n  activated() {\n    this.$emit('update:modelValue', false);\n  },\n  watch: {\n    modelValue(newValue, oldValue) {\n      if (newValue) {\n        const slotElement = (this.$refs.root as HTMLElement).firstElementChild as HTMLElement;\n        Matomo.helper.modalConfirm(slotElement, {\n          yes: () => { this.$emit('yes'); },\n          no: () => { this.$emit('no'); },\n          validation: () => { this.$emit('validation'); },\n        }, {\n          onCloseEnd: () => {\n            // materialize removes the child element, so we move it back to the slot\n            (this.$refs.root as HTMLElement).appendChild(slotElement);\n            this.$emit('update:modelValue', false);\n            this.$emit('closeEnd');\n          },\n        });\n      } else if (newValue === false && oldValue === true) {\n        // the user closed the dialog, e.g. by pressing Esc or clicking away from it\n        $('.modal.open').modal('close');\n        this.$emit('close');\n      }\n    },\n  },\n});\n","import { render } from \"./MatomoDialog.vue?vue&type=template&id=239b8b1e\"\nimport script from \"./MatomoDialog.vue?vue&type=script&lang=ts\"\nexport * from \"./MatomoDialog.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport DirectiveUtilities from '../directiveUtilities';\n\ninterface ExpandOnClickArgs {\n  // input (specified by user)\n  expander: string | HTMLElement,\n  onClosed?: () => void;\n\n  // state\n  isMouseDown?: boolean;\n  hasScrolled?: boolean;\n\n  // event handlers\n  onExpand?: () => void;\n  onClickOutsideElement?: (event: MouseEvent) => void;\n  onScroll?: () => void;\n  onMouseDown?: () => void;\n  onEscapeHandler?: (event: KeyboardEvent) => void;\n}\n\nfunction onExpand(element: HTMLElement) {\n  element.classList.toggle('expanded');\n\n  const positionElement = element.querySelector('.dropdown.positionInViewport');\n  if (positionElement) {\n    Matomo.helper.setMarginLeftToBeInViewport(positionElement);\n  }\n}\n\nfunction onClickOutsideElement(\n  element: HTMLElement,\n  binding: DirectiveBinding<ExpandOnClickArgs>,\n  event: MouseEvent,\n) {\n  const hadUsedScrollbar = binding.value.isMouseDown && binding.value.hasScrolled;\n  binding.value.isMouseDown = false;\n  binding.value.hasScrolled = false;\n\n  if (hadUsedScrollbar) {\n    return;\n  }\n\n  if (!element.contains(event.target as HTMLElement)) {\n    element.classList.remove('expanded');\n\n    if (binding.value?.onClosed) {\n      binding.value.onClosed();\n    }\n  }\n}\n\nfunction onScroll(binding: DirectiveBinding<ExpandOnClickArgs>) {\n  binding.value.hasScrolled = true;\n}\n\nfunction onMouseDown(binding: DirectiveBinding<ExpandOnClickArgs>) {\n  binding.value.isMouseDown = true;\n  binding.value.hasScrolled = false;\n}\n\nfunction onEscapeHandler(\n  element: HTMLElement,\n  binding: DirectiveBinding<ExpandOnClickArgs>,\n  event: KeyboardEvent,\n) {\n  if (event.which === 27) {\n    binding.value.isMouseDown = false;\n    binding.value.hasScrolled = false;\n    element.classList.remove('expanded');\n  }\n}\n\nconst doc = document.documentElement;\nconst { $ } = window;\n\n/**\n * Usage (in a component):\n *\n * directives: {\n *   ExpandOnClick: ExpandOnClick(), // function call is important since we store state\n *                                   // in this directive\n * }\n */\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<ExpandOnClickArgs>): void {\n    binding.value.isMouseDown = false;\n    binding.value.hasScrolled = false;\n    binding.value.onExpand = onExpand.bind(null, el);\n    binding.value.onEscapeHandler = onEscapeHandler.bind(null, el, binding);\n    binding.value.onMouseDown = onMouseDown.bind(null, binding);\n    binding.value.onClickOutsideElement = onClickOutsideElement.bind(null, el, binding);\n    binding.value.onScroll = onScroll.bind(null, binding);\n\n    setTimeout(() => {\n      const expander = DirectiveUtilities.getRef(binding.value.expander, binding);\n      if (expander) {\n        $(expander).on('click', binding.value.onExpand!);\n      }\n    });\n    doc.addEventListener('keyup', binding.value.onEscapeHandler);\n    doc.addEventListener('mousedown', binding.value.onMouseDown);\n    doc.addEventListener('mouseup', binding.value.onClickOutsideElement);\n    doc.addEventListener('scroll', binding.value.onScroll);\n  },\n  unmounted(el: HTMLElement, binding: DirectiveBinding<ExpandOnClickArgs>): void {\n    const expander = DirectiveUtilities.getRef(binding.value.expander, binding);\n    if (expander) {\n      $(expander).off('click', binding.value.onExpand!);\n    }\n    doc.removeEventListener('keyup', binding.value.onEscapeHandler!);\n    doc.removeEventListener('mousedown', binding.value.onMouseDown!);\n    doc.removeEventListener('mouseup', binding.value.onClickOutsideElement!);\n    doc.removeEventListener('scroll', binding.value.onScroll!);\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport DirectiveUtilities from '../directiveUtilities';\n\ninterface ExpandOnHoverArgs {\n  // input (provided by user)\n  expander: string | HTMLElement,\n\n  // event handlers\n  onMouseEnter?: () => void;\n  onMouseLeave?: () => void;\n  onClickOutsideElement?: (event: MouseEvent) => void;\n  onEscapeHandler?: (event: KeyboardEvent) => void;\n}\n\nfunction onMouseEnter(element: HTMLElement) {\n  element.classList.add('expanded');\n\n  const positionElement = element.querySelector('.dropdown.positionInViewport');\n  if (positionElement) {\n    Matomo.helper.setMarginLeftToBeInViewport(positionElement);\n  }\n}\n\nfunction onMouseLeave(element: HTMLElement) {\n  element.classList.remove('expanded');\n}\n\nfunction onClickOutsideElement(element: HTMLElement, event: MouseEvent) {\n  if (!element.contains(event.target as HTMLElement)) {\n    element.classList.remove('expanded');\n  }\n}\n\nfunction onEscapeHandler(element: HTMLElement, event: KeyboardEvent) {\n  if (event.which === 27) {\n    element.classList.remove('expanded');\n  }\n}\n\nconst doc = document.documentElement;\n\n/**\n * Usage (in a component):\n *\n * directives: {\n *   ExpandOnHover: ExpandOnHover(), // function call is important since we store state\n *                                   // in this directive\n * }\n */\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<ExpandOnHoverArgs>): void {\n    binding.value.onMouseEnter = onMouseEnter.bind(null, el);\n    binding.value.onMouseLeave = onMouseLeave.bind(null, el);\n    binding.value.onClickOutsideElement = onClickOutsideElement.bind(null, el);\n    binding.value.onEscapeHandler = onEscapeHandler.bind(null, el);\n\n    setTimeout(() => {\n      const expander = DirectiveUtilities.getRef(binding.value.expander, binding);\n      if (expander) {\n        expander.addEventListener('mouseenter', binding.value.onMouseEnter!);\n      }\n    });\n\n    el.addEventListener('mouseleave', binding.value.onMouseLeave);\n    doc.addEventListener('keyup', binding.value.onEscapeHandler);\n    doc.addEventListener('mouseup', binding.value.onClickOutsideElement);\n  },\n  unmounted(el: HTMLElement, binding: DirectiveBinding<ExpandOnHoverArgs>): void {\n    const expander = DirectiveUtilities.getRef(binding.value.expander, binding);\n    if (expander) {\n      expander.removeEventListener('mouseenter', binding.value.onMouseEnter!);\n    }\n    el.removeEventListener('mouseleave', binding.value.onMouseLeave!);\n    document.removeEventListener('keyup', binding.value.onEscapeHandler!);\n    document.removeEventListener('mouseup', binding.value.onClickOutsideElement!);\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\nimport { translate } from '../translate';\n\ninterface ShowSensitiveDataArgs {\n  sensitiveData: string;\n  showCharacters?: number;\n  clickElementSelector: string|HTMLElement|JQuery;\n}\n\nconst { $ } = window;\n\n/**\n * Handles visibility of sensitive data. By default data will be shown replaced with stars (*)\n * On click on the element the full data will be shown\n *\n * Configuration attributes:\n * data-show-characters          number of characters to show in clear text (defaults to 6)\n * data-click-element-selector   selector for element that will show the full data on click\n *                               (defaults to element)\n *\n * Example:\n * <div v-show-sensitive-date=\"some text\"></div>\n */\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<ShowSensitiveDataArgs>): void {\n    const element = $(el);\n\n    const { sensitiveData } = binding.value;\n    const showCharacters = binding.value.showCharacters || 6;\n    const clickElement = binding.value.clickElementSelector || element;\n\n    let protectedData = '';\n    if (showCharacters > 0) {\n      protectedData += sensitiveData.slice(0, showCharacters);\n    }\n    protectedData += sensitiveData.slice(showCharacters).replace(/./g, '*');\n    element.html(protectedData);\n\n    function onClickHandler() {\n      element.html(sensitiveData);\n      $(clickElement).css({\n        cursor: '',\n      });\n      $(clickElement).tooltip('destroy');\n    }\n\n    $(clickElement).tooltip({\n      content: translate('CoreHome_ClickToSeeFullInformation'),\n      items: '*',\n      track: true,\n    });\n\n    $(clickElement).one('click', onClickHandler);\n    $(clickElement).css({\n      cursor: 'pointer',\n    });\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nconst { $ } = window;\n\nexport default {\n  mounted(el: HTMLElement): void {\n    const element = $(el) as JQuery;\n\n    // BC for materializecss 0.97 => 1.0\n    if (!element.attr('data-target')\n      && element.attr('data-activates')\n    ) {\n      element.attr('data-target', element.attr('data-activates')!);\n    }\n\n    const target = element.attr('data-target');\n    if (target && $(`#${target}`).length) {\n      (element as any).dropdown({ // eslint-disable-line\n        inDuration: 300,\n        outDuration: 225,\n        constrainWidth: false, // Does not change width of dropdown to that of the activator\n        //  hover: true, // Activate on hover\n        belowOrigin: true, // Displays dropdown below the button\n      });\n    }\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\n\nconst { $ } = window;\n\ninterface SelectOnFocusArgs {\n  // state\n  focusedElement?: HTMLElement;\n  elementSupportsSelect?: boolean;\n\n  // event handlers\n  onFocusHandler?: (event: Event) => void;\n  onClickHandler?: (event: MouseEvent) => void;\n  onBlurHandler?: (event: Event) => void;\n}\n\nfunction onFocusHandler(binding: DirectiveBinding<SelectOnFocusArgs>, event: Event) {\n  if (binding.value.focusedElement !== event.target) {\n    binding.value.focusedElement = event.target as HTMLElement;\n    $(event.target!).select();\n  }\n}\n\nfunction onClickHandler(event: Event) {\n  // .select() + focus and blur seems to not work on pre elements\n  const range = document.createRange();\n  range.selectNode(event.target as Node);\n  const selection = window.getSelection();\n  if (selection && selection.rangeCount > 0) {\n    selection.removeAllRanges();\n  }\n  if (selection) {\n    selection.addRange(range);\n  }\n}\n\nfunction onBlurHandler(binding: DirectiveBinding<SelectOnFocusArgs>) {\n  delete binding.value.focusedElement;\n}\n\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<SelectOnFocusArgs>): void {\n    const tagName = el.tagName.toLowerCase();\n    binding.value.elementSupportsSelect = tagName === 'textarea';\n\n    if (binding.value.elementSupportsSelect) {\n      binding.value.onFocusHandler = onFocusHandler.bind(null, binding);\n      binding.value.onBlurHandler = onBlurHandler.bind(null, binding);\n\n      el.addEventListener('focus', binding.value.onFocusHandler);\n      el.addEventListener('blur', binding.value.onBlurHandler);\n    } else {\n      binding.value.onClickHandler = onClickHandler;\n\n      el.addEventListener('click', binding.value.onClickHandler);\n    }\n  },\n  unmounted(el: HTMLElement, binding: DirectiveBinding<SelectOnFocusArgs>): void {\n    if (binding.value.elementSupportsSelect) {\n      el.removeEventListener('focus', binding.value.onFocusHandler!);\n      el.removeEventListener('blur', binding.value.onBlurHandler!);\n    } else {\n      el.removeEventListener('click', binding.value.onClickHandler!);\n    }\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\nimport { translate } from '../translate';\n\ninterface CopyToClipboardArgs {\n  // state\n  transitionOpen?: boolean;\n\n  // event handlers\n  onClickHandler?: (event: MouseEvent) => void;\n  onTransitionEndHandler?: (event: Event) => void;\n}\n\nfunction onClickHandler(pre: HTMLElement) {\n  if (pre) {\n    const textarea = document.createElement('textarea');\n    textarea.value = pre.innerText;\n    textarea.setAttribute('readonly', '');\n    textarea.style.position = 'absolute';\n    textarea.style.left = '-9999px';\n    document.body.appendChild(textarea);\n    textarea.select();\n    document.execCommand('copy');\n    document.body.removeChild(textarea);\n    const btn = (pre.parentElement as HTMLButtonElement);\n    if (btn) {\n      const icon = btn.getElementsByTagName('i')[0];\n      if (icon) {\n        icon.classList.remove('copyToClipboardIcon');\n        icon.classList.add('copyToClipboardIconCheck');\n      }\n      const copied = btn.getElementsByClassName('copyToClipboardCopiedDiv')[0];\n      if (copied) {\n        (copied as HTMLDivElement).style.display = 'inline-block';\n        setTimeout(() => {\n          (copied as HTMLDivElement).style.display = 'none';\n        }, 2500);\n      }\n    }\n  }\n}\n\nfunction onTransitionEndHandler(el: HTMLElement, binding: DirectiveBinding<CopyToClipboardArgs>) {\n  if (binding.value.transitionOpen) {\n    const btn = (el.parentElement as HTMLButtonElement);\n    if (btn) {\n      const icon = btn.getElementsByTagName('i')[0];\n      if (icon) {\n        icon.classList.remove('copyToClipboardIconCheck');\n        icon.classList.add('copyToClipboardIcon');\n      }\n    }\n    binding.value.transitionOpen = false;\n  } else {\n    binding.value.transitionOpen = true;\n  }\n}\n\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<CopyToClipboardArgs>): void {\n    const tagName = el.tagName.toLowerCase();\n    if (tagName === 'pre') {\n      const btn = document.createElement('button');\n      btn.setAttribute('type', 'button');\n      btn.className = 'copyToClipboardButton';\n\n      const positionDiv = document.createElement('div');\n      positionDiv.className = 'copyToClipboardPositionDiv';\n\n      const icon = document.createElement('i');\n      icon.className = 'copyToClipboardIcon';\n      btn.appendChild(icon);\n\n      const sp = document.createElement('span');\n      sp.className = 'copyToClipboardSpan';\n      sp.innerHTML = translate('General_Copy');\n      btn.appendChild(sp);\n\n      positionDiv.appendChild(btn);\n\n      const cdiv = document.createElement('div');\n      cdiv.className = 'copyToClipboardCopiedDiv';\n      cdiv.innerHTML = translate('General_CopiedToClipboard');\n\n      positionDiv.appendChild(cdiv);\n\n      const pe = el.parentElement;\n      if (pe) {\n        pe.classList.add('copyToClipboardWrapper');\n        pe.appendChild(positionDiv);\n      }\n\n      binding.value.onClickHandler = onClickHandler.bind(null, el);\n      btn.addEventListener('click', binding.value.onClickHandler);\n\n      binding.value.onTransitionEndHandler = onTransitionEndHandler.bind(null, el, binding);\n      btn.addEventListener('transitionend', binding.value.onTransitionEndHandler);\n    }\n  },\n  unmounted(el: HTMLElement, binding: DirectiveBinding<CopyToClipboardArgs>): void {\n    el.removeEventListener('click', binding.value.onClickHandler!);\n    el.removeEventListener('transitionend', binding.value.onTransitionEndHandler!);\n  },\n};\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\n/* eslint-disable @typescript-eslint/ban-ts-comment */\n\nimport { DirectiveBinding } from 'vue';\nimport DirectiveUtilities from '../directiveUtilities';\n\ninterface SideNavArgs {\n  activator: HTMLElement | string;\n\n  // directive state\n  initialized?: boolean;\n}\n\n/**\n * Will activate the materialize side nav feature once rendered. We use this directive as\n * it makes sure the actual left menu is rendered at the time we init the side nav.\n *\n * Has to be set on a collaapsible element\n *\n * Example:\n * <div class=\"collapsible\" v-side-nav=\"nav .activateLeftMenu\">...</div>\n */\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<SideNavArgs>): void {\n    if (!binding.value.activator) {\n      return;\n    }\n\n    setTimeout(() => {\n      if (!binding.value.initialized) {\n        binding.value.initialized = true;\n\n        const sideNavActivator = DirectiveUtilities.getRef(binding.value.activator, binding);\n        if (sideNavActivator) {\n          window.$(sideNavActivator).show();\n\n          const targetSelector = sideNavActivator.getAttribute('data-target');\n\n          // @ts-ignore\n          window.$(`#${targetSelector}`).sidenav({\n            closeOnClick: true,\n          });\n        }\n      }\n\n      if (el.classList.contains('collapsible')) {\n        window.$(el).collapsible();\n      }\n    });\n  },\n};\n","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    class=\"enrichedHeadline\"\n    v-on:mouseenter=\"showIcons = true\"\n    v-on:mouseleave=\"showIcons = false\"\n    ref=\"root\"\n  >\n    <div\n      v-if=\"!editUrl\"\n      class=\"title\"\n      tabindex=\"6\"\n    >\n      <slot />\n    </div>\n    <a\n      v-if=\"editUrl\"\n      class=\"title\"\n      :href=\"editUrl\"\n      :title=\"translate('CoreHome_ClickToEditX', htmlEntities(actualFeatureName))\"\n    >\n      <slot />\n    </a>\n    <span\n      v-show=\"showIcons || showInlineHelp\"\n      class=\"iconsBar\"\n    >\n      <a\n        v-if=\"helpUrl && !actualInlineHelp\"\n        rel=\"noreferrer noopener\"\n        target=\"_blank\"\n        class=\"helpIcon\"\n        :href=\"helpUrl\"\n        :title=\"translate('CoreHome_ExternalHelp')\"\n      ><span class=\"icon-help\" /></a>\n      <a\n        v-if=\"actualInlineHelp\"\n        v-on:click=\"showInlineHelp = !showInlineHelp\"\n        class=\"helpIcon\"\n        :class=\"{ 'active': showInlineHelp }\"\n        :title=\"translate(reportGenerated ? 'General_HelpReport' : 'General_Help')\"\n      ><span class=\"icon-info\" /></a>\n      <div class=\"ratingIcons\" v-if=\"showRateFeature\">\n        <component :title=\"actualFeatureName\" :is=\"rateFeature\"></component>\n      </div>\n    </span>\n    <div\n      class=\"inlineHelp\"\n      v-show=\"showInlineHelp\"\n    >\n      <div v-html=\"$sanitize(actualInlineHelp)\"/>\n      <span class=\"helpDate\"\n            v-if=\"reportGenerated!=''\"\n            v-html=\"$sanitize(reportGenerated)\"></span>\n      <a\n        v-if=\"helpUrl\"\n        rel=\"noreferrer noopener\"\n        target=\"_blank\"\n        class=\"readMore\"\n        :href=\"helpUrl\"\n      >{{ translate('General_MoreDetails') }}</a>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport Periods from '../Periods/Periods';\nimport { translateOrDefault } from '../translate';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\ninterface EnrichedHeadlineData {\n  showIcons: boolean;\n  showInlineHelp: boolean;\n  actualFeatureName?: string | null;\n  actualInlineHelp?: string | null,\n}\n\n/**\n * Usage:\n *\n * <h2><EnrichedHeadline>All Websites Dashboard</EnrichedHeadline></h2>\n * -> uses \"All Websites Dashboard\" as featurename\n *\n * <h2><EnrichedHeadline feature-name=\"All Websites Dashboard\">All Websites Dashboard (Total:\n * 309 Visits)</EnrichedHeadline></h2>\n * -> custom featurename\n *\n * <h2><EnrichedHeadline help-url=\"http://piwik.org/guide\">All Websites Dashboard</EnrichedHeadline></h2>\n * -> shows help icon and links to external url\n *\n * <h2><EnrichedHeadline edit-url=\"index.php?module=Foo&action=bar&id=4\">All Websites\n * Dashboard</EnrichedHeadline></h2>\n * -> makes the headline clickable linking to the specified url\n *\n * <h2><EnrichedHeadline inline-help=\"inlineHelp\">Pages report</EnrichedHeadline></h2>\n * -> inlineHelp specified via a attribute shows help icon on headline hover\n *\n * <h2><EnrichedHeadline>All Websites Dashboard\n *     <div class=\"inlineHelp\">My <strong>inline help</strong></div>\n * </EnrichedHeadline></h2>\n * -> alternative definition for inline help\n * -> shows help icon to display inline help on click. Note: You can combine inlinehelp and help-url\n *\n * * <h2><EnrichedHeadline report-generated=\"generated time\">Pages report</EnrichedHeadline></h2>\n * -> reportGenerated specified via this attribute shows a clock icon with a tooltip which\n * activated by hover\n * -> the tooltip shows the value of the attribute\n */\nexport default defineComponent({\n  props: {\n    helpUrl: {\n      type: String,\n      default: '',\n    },\n    editUrl: {\n      type: String,\n      default: '',\n    },\n    reportGenerated: String,\n    featureName: String,\n    inlineHelp: String,\n  },\n  data(): EnrichedHeadlineData {\n    return {\n      showIcons: false,\n      showInlineHelp: false,\n      actualFeatureName: this.featureName,\n      actualInlineHelp: this.inlineHelp,\n    };\n  },\n  watch: {\n    inlineHelp(newValue: string) {\n      this.actualInlineHelp = newValue;\n    },\n    featureName(newValue: string) {\n      this.actualFeatureName = newValue;\n    },\n  },\n  mounted() {\n    const root = this.$refs.root as HTMLElement;\n\n    if (!this.actualInlineHelp) {\n      let helpNode = root.querySelector('.title .inlineHelp');\n      if (!helpNode && root.parentElement?.nextElementSibling) {\n        // hack for reports :(\n        helpNode = (root.parentElement.nextElementSibling as HTMLElement)\n          .querySelector('.reportDocumentation');\n      }\n\n      if (helpNode) {\n        // hackish solution to get binded html of p tag within the help node\n        // at this point the ng-bind-html is not yet converted into html when report is not\n        // initially loaded. Using $compile doesn't work. So get and set it manually\n        const helpDocs = helpNode.getAttribute('data-content')?.trim();\n        if (helpDocs && helpDocs.length) {\n          this.actualInlineHelp = `<p>${helpDocs}</p>`;\n          setTimeout(() => helpNode!.remove(), 0);\n        }\n      }\n    }\n\n    if (!this.actualFeatureName) {\n      this.actualFeatureName = root.querySelector('.title')?.textContent;\n    }\n\n    if (Matomo.period && Matomo.currentDateString) {\n      const currentPeriod = Periods.parse(\n        Matomo.period as string,\n        Matomo.currentDateString as string,\n      );\n\n      if (this.reportGenerated\n        && currentPeriod.containsToday()\n      ) {\n        window.$(root.querySelector('.report-generated')!).tooltip({\n          track: true,\n          content: this.reportGenerated,\n          items: 'div',\n          show: false,\n          hide: false,\n        });\n      }\n    }\n  },\n  methods: {\n    htmlEntities(v: string) {\n      return Matomo.helper.htmlEntities(v);\n    },\n  },\n  computed: {\n    showRateFeature() {\n      return translateOrDefault('Feedback_SendFeedback') !== 'Feedback_SendFeedback';\n    },\n    rateFeature() {\n      if (this.showRateFeature) {\n        return useExternalPluginComponent('Feedback', 'RateFeature');\n      }\n      return '';\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport Periods from '../Periods/Periods';\nimport { translateOrDefault } from '../translate';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\ninterface EnrichedHeadlineData {\n  showIcons: boolean;\n  showInlineHelp: boolean;\n  actualFeatureName?: string | null;\n  actualInlineHelp?: string | null,\n}\n\n/**\n * Usage:\n *\n * <h2><EnrichedHeadline>All Websites Dashboard</EnrichedHeadline></h2>\n * -> uses \"All Websites Dashboard\" as featurename\n *\n * <h2><EnrichedHeadline feature-name=\"All Websites Dashboard\">All Websites Dashboard (Total:\n * 309 Visits)</EnrichedHeadline></h2>\n * -> custom featurename\n *\n * <h2><EnrichedHeadline help-url=\"http://piwik.org/guide\">All Websites Dashboard</EnrichedHeadline></h2>\n * -> shows help icon and links to external url\n *\n * <h2><EnrichedHeadline edit-url=\"index.php?module=Foo&action=bar&id=4\">All Websites\n * Dashboard</EnrichedHeadline></h2>\n * -> makes the headline clickable linking to the specified url\n *\n * <h2><EnrichedHeadline inline-help=\"inlineHelp\">Pages report</EnrichedHeadline></h2>\n * -> inlineHelp specified via a attribute shows help icon on headline hover\n *\n * <h2><EnrichedHeadline>All Websites Dashboard\n *     <div class=\"inlineHelp\">My <strong>inline help</strong></div>\n * </EnrichedHeadline></h2>\n * -> alternative definition for inline help\n * -> shows help icon to display inline help on click. Note: You can combine inlinehelp and help-url\n *\n * * <h2><EnrichedHeadline report-generated=\"generated time\">Pages report</EnrichedHeadline></h2>\n * -> reportGenerated specified via this attribute shows a clock icon with a tooltip which\n * activated by hover\n * -> the tooltip shows the value of the attribute\n */\nexport default defineComponent({\n  props: {\n    helpUrl: {\n      type: String,\n      default: '',\n    },\n    editUrl: {\n      type: String,\n      default: '',\n    },\n    reportGenerated: String,\n    featureName: String,\n    inlineHelp: String,\n  },\n  data(): EnrichedHeadlineData {\n    return {\n      showIcons: false,\n      showInlineHelp: false,\n      actualFeatureName: this.featureName,\n      actualInlineHelp: this.inlineHelp,\n    };\n  },\n  watch: {\n    inlineHelp(newValue: string) {\n      this.actualInlineHelp = newValue;\n    },\n    featureName(newValue: string) {\n      this.actualFeatureName = newValue;\n    },\n  },\n  mounted() {\n    const root = this.$refs.root as HTMLElement;\n\n    if (!this.actualInlineHelp) {\n      let helpNode = root.querySelector('.title .inlineHelp');\n      if (!helpNode && root.parentElement?.nextElementSibling) {\n        // hack for reports :(\n        helpNode = (root.parentElement.nextElementSibling as HTMLElement)\n          .querySelector('.reportDocumentation');\n      }\n\n      if (helpNode) {\n        // hackish solution to get binded html of p tag within the help node\n        // at this point the ng-bind-html is not yet converted into html when report is not\n        // initially loaded. Using $compile doesn't work. So get and set it manually\n        const helpDocs = helpNode.getAttribute('data-content')?.trim();\n        if (helpDocs && helpDocs.length) {\n          this.actualInlineHelp = `<p>${helpDocs}</p>`;\n          setTimeout(() => helpNode!.remove(), 0);\n        }\n      }\n    }\n\n    if (!this.actualFeatureName) {\n      this.actualFeatureName = root.querySelector('.title')?.textContent;\n    }\n\n    if (Matomo.period && Matomo.currentDateString) {\n      const currentPeriod = Periods.parse(\n        Matomo.period as string,\n        Matomo.currentDateString as string,\n      );\n\n      if (this.reportGenerated\n        && currentPeriod.containsToday()\n      ) {\n        window.$(root.querySelector('.report-generated')!).tooltip({\n          track: true,\n          content: this.reportGenerated,\n          items: 'div',\n          show: false,\n          hide: false,\n        });\n      }\n    }\n  },\n  methods: {\n    htmlEntities(v: string) {\n      return Matomo.helper.htmlEntities(v);\n    },\n  },\n  computed: {\n    showRateFeature() {\n      return translateOrDefault('Feedback_SendFeedback') !== 'Feedback_SendFeedback';\n    },\n    rateFeature() {\n      if (this.showRateFeature) {\n        return useExternalPluginComponent('Feedback', 'RateFeature');\n      }\n      return '';\n    },\n  },\n});\n","import { render } from \"./EnrichedHeadline.vue?vue&type=template&id=cbaca8ea\"\nimport script from \"./EnrichedHeadline.vue?vue&type=script&lang=ts\"\nexport * from \"./EnrichedHeadline.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div :class=\"{ card: true, 'card-with-image': !!this.imageUrl }\" ref=\"root\">\n    <div class=\"card-content\">\n      <h2\n        v-if=\"contentTitle && !actualFeature && !helpUrl && !actualHelpText\"\n        class=\"card-title\"\n      >{{ decode(contentTitle) }}</h2>\n      <h2\n        v-if=\"contentTitle && (actualFeature || helpUrl || actualHelpText)\"\n        class=\"card-title\"\n      >\n        <EnrichedHeadline\n          :feature-name=\"actualFeature\"\n          :help-url=\"helpUrl\"\n          :inline-help=\"actualHelpText\"\n        >\n          {{ decode(contentTitle) }}\n        </EnrichedHeadline>\n      </h2>\n      <div ref=\"content\">\n        <slot />\n      </div>\n    </div>\n    <div class=\"card-image hide-on-med-and-down\" v-if=\"imageUrl\">\n      <img :src=\"imageUrl\" :alt=\"actualImageAltText\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport EnrichedHeadline from '../EnrichedHeadline/EnrichedHeadline.vue';\nimport Matomo from '../Matomo/Matomo';\n\nlet adminContent: HTMLElement|null = null;\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    contentTitle: String,\n    feature: String,\n    helpUrl: String,\n    helpText: String,\n    anchor: String,\n    imageUrl: String,\n    imageAltText: String,\n  },\n  components: {\n    EnrichedHeadline,\n  },\n  data() {\n    return {\n      actualFeature: this.feature,\n      actualHelpText: this.helpText,\n      actualImageAltText: this.imageAltText ? this.imageAltText : this.contentTitle,\n    };\n  },\n  watch: {\n    feature(newValue: string) {\n      this.actualFeature = newValue;\n    },\n    helpText(newValue: string) {\n      this.actualHelpText = newValue;\n    },\n  },\n  mounted() {\n    const root = this.$refs.root as HTMLElement;\n    const content = this.$refs.content as HTMLElement;\n\n    if (this.anchor && root && root.parentElement) {\n      const anchorElement = document.createElement('a');\n      anchorElement.id = this.anchor;\n      $(root.parentElement).prepend(anchorElement);\n    }\n\n    setTimeout(() => {\n      const inlineHelp = content.querySelector('.contentHelp');\n      if (inlineHelp) {\n        this.actualHelpText = inlineHelp.innerHTML;\n        inlineHelp.remove();\n      }\n    }, 0);\n\n    if (this.actualFeature && this.actualFeature === 'true') {\n      this.actualFeature = this.contentTitle;\n    }\n\n    if (adminContent === null) {\n      // cache admin node for further content blocks\n      adminContent = document.querySelector('#content.admin');\n    }\n\n    let contentTopPosition: number|null = null;\n    if (adminContent) {\n      contentTopPosition = adminContent.offsetTop;\n    }\n\n    if (contentTopPosition || contentTopPosition === 0) {\n      const parents = root.closest('.widgetLoader') as HTMLElement;\n\n      // when shown within the widget loader, we need to get the offset of that element\n      // as the widget loader might be still shown. Would otherwise not position correctly\n      // the widgets on the admin home page\n      const topThis = parents ? parents.offsetTop : root.offsetTop;\n\n      if (topThis - contentTopPosition < 17) {\n        // we make sure to display the first card with no margin-top to have it on same as line as\n        // navigation\n        root.style.marginTop = '0';\n      }\n    }\n  },\n  methods: {\n    decode(s: string) {\n      return Matomo.helper.htmlDecode(s);\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport EnrichedHeadline from '../EnrichedHeadline/EnrichedHeadline.vue';\nimport Matomo from '../Matomo/Matomo';\n\nlet adminContent: HTMLElement|null = null;\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    contentTitle: String,\n    feature: String,\n    helpUrl: String,\n    helpText: String,\n    anchor: String,\n    imageUrl: String,\n    imageAltText: String,\n  },\n  components: {\n    EnrichedHeadline,\n  },\n  data() {\n    return {\n      actualFeature: this.feature,\n      actualHelpText: this.helpText,\n      actualImageAltText: this.imageAltText ? this.imageAltText : this.contentTitle,\n    };\n  },\n  watch: {\n    feature(newValue: string) {\n      this.actualFeature = newValue;\n    },\n    helpText(newValue: string) {\n      this.actualHelpText = newValue;\n    },\n  },\n  mounted() {\n    const root = this.$refs.root as HTMLElement;\n    const content = this.$refs.content as HTMLElement;\n\n    if (this.anchor && root && root.parentElement) {\n      const anchorElement = document.createElement('a');\n      anchorElement.id = this.anchor;\n      $(root.parentElement).prepend(anchorElement);\n    }\n\n    setTimeout(() => {\n      const inlineHelp = content.querySelector('.contentHelp');\n      if (inlineHelp) {\n        this.actualHelpText = inlineHelp.innerHTML;\n        inlineHelp.remove();\n      }\n    }, 0);\n\n    if (this.actualFeature && this.actualFeature === 'true') {\n      this.actualFeature = this.contentTitle;\n    }\n\n    if (adminContent === null) {\n      // cache admin node for further content blocks\n      adminContent = document.querySelector('#content.admin');\n    }\n\n    let contentTopPosition: number|null = null;\n    if (adminContent) {\n      contentTopPosition = adminContent.offsetTop;\n    }\n\n    if (contentTopPosition || contentTopPosition === 0) {\n      const parents = root.closest('.widgetLoader') as HTMLElement;\n\n      // when shown within the widget loader, we need to get the offset of that element\n      // as the widget loader might be still shown. Would otherwise not position correctly\n      // the widgets on the admin home page\n      const topThis = parents ? parents.offsetTop : root.offsetTop;\n\n      if (topThis - contentTopPosition < 17) {\n        // we make sure to display the first card with no margin-top to have it on same as line as\n        // navigation\n        root.style.marginTop = '0';\n      }\n    }\n  },\n  methods: {\n    decode(s: string) {\n      return Matomo.helper.htmlDecode(s);\n    },\n  },\n});\n","import { render } from \"./ContentBlock.vue?vue&type=template&id=a32a48ea\"\nimport script from \"./ContentBlock.vue?vue&type=script&lang=ts\"\nexport * from \"./ContentBlock.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    v-if=\"isComparing\"\n    ref=\"root\"\n    class=\"matomo-comparisons\"\n    v-tooltips=\"{ duration: 200, delay: 200, content: transformTooltipContent }\"\n  >\n    <h3>{{ translate('General_Comparisons') }}</h3>\n    <div\n      class=\"comparison card\"\n      v-for=\"(comparison, $index) in segmentComparisons\"\n      :key=\"comparison.index\"\n    >\n      <div class=\"comparison-type\">{{ translate('General_Segment') }}</div>\n      <div\n        class=\"title\"\n        :title=\"comparison.title + '<br/>' + decodeURIComponent(comparison.params.segment)\"\n      >\n        <a\n          target=\"_blank\"\n          :href=\"getUrlToSegment(comparison.params.segment)\"\n        >\n          {{ comparison.title }}\n        </a>\n      </div>\n      <div\n        class=\"comparison-period\"\n        v-for=\"periodComparison in periodComparisons\"\n        :key=\"periodComparison.index\"\n        :title=\"getComparisonTooltip(comparison, periodComparison)\"\n      >\n        <span\n          class=\"comparison-dot\"\n          :style=\"{\n            'background-color': getSeriesColor(comparison, periodComparison)\n          }\"\n        />\n        <span class=\"comparison-period-label\">\n          {{ periodComparison.title }} ({{ getComparisonPeriodType(periodComparison) }})\n        </span>\n      </div>\n      <a\n        class=\"remove-button\"\n        v-on:click=\"removeSegmentComparison($index)\"\n        v-if=\"segmentComparisons.length > 1\"\n      >\n        <span\n          class=\"icon icon-close\"\n          :title=\"translate('General_ClickToRemoveComp')\"\n        />\n      </a>\n    </div>\n    <div\n      class=\"loadingPiwik\"\n      style=\"display:none;\"\n    >\n      <img\n        src=\"plugins/Morpheus/images/loading-blue.gif\"\n        :alt=\"translate('General_LoadingData')\"\n      />\n      {{ translate('General_LoadingData') }}\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed } from 'vue';\nimport { AnyComparison } from './Comparisons.store';\nimport ComparisonsStoreInstance from './Comparisons.store.instance';\nimport Matomo from '../Matomo/Matomo';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport { translate } from '../translate';\nimport Tooltips from '../Tooltips/Tooltips';\n\ninterface ProcessedReportComparison {\n  compareSegmentPretty: string;\n  comparePeriodPretty: string;\n  nb_visits: number;\n  nb_visits_change: number;\n}\n\ninterface ProcessedReportData {\n  comparisons?: ProcessedReportComparison[];\n}\n\ninterface ProcessedReportResponse {\n  reportData: ProcessedReportData;\n}\n\ninterface ComparisonState {\n  comparisonTooltips: Record<string, Record<string, string>>|null;\n}\n\nexport default defineComponent({\n  props: {\n  },\n  directives: {\n    Tooltips,\n  },\n  data(): ComparisonState {\n    return {\n      comparisonTooltips: null,\n    };\n  },\n  setup() {\n    // accessing has to be done through a computed property so we can use the computed\n    // instance directly in the template. unfortunately, vue won't register to changes.\n    const isComparing = computed(\n      () => ComparisonsStoreInstance.isComparing() && !window.broadcast.isNoDataPage(),\n    );\n    const segmentComparisons = computed(() => ComparisonsStoreInstance.getSegmentComparisons());\n    const periodComparisons = computed(() => ComparisonsStoreInstance.getPeriodComparisons());\n    const getSeriesColor = ComparisonsStoreInstance.getSeriesColor.bind(ComparisonsStoreInstance);\n\n    function transformTooltipContent(this: HTMLElement) {\n      const title = window.$(this).attr('title');\n      if (!title) {\n        return title;\n      }\n      return window.vueSanitize(title.replace(/\\n/g, '<br />'));\n    }\n\n    return {\n      isComparing,\n      segmentComparisons,\n      periodComparisons,\n      getSeriesColor,\n      transformTooltipContent,\n    };\n  },\n  methods: {\n    comparisonHasSegment(comparison: AnyComparison) {\n      return typeof comparison.params.segment !== 'undefined';\n    },\n    removeSegmentComparison(index: number) {\n      // otherwise the tooltip will be stuck on the screen\n      window.$(this.$refs.root as HTMLElement).tooltip('destroy');\n      ComparisonsStoreInstance.removeSegmentComparison(index);\n    },\n    getComparisonPeriodType(comparison: AnyComparison) {\n      const { period } = comparison.params;\n      if (period === 'range') {\n        return translate('CoreHome_PeriodRange');\n      }\n      const periodStr = translate(\n        `Intl_Period${period.substring(0, 1).toUpperCase()}${period.substring(1)}`,\n      );\n      return periodStr.substring(0, 1).toUpperCase() + periodStr.substring(1);\n    },\n    getComparisonTooltip(\n      segmentComparison: AnyComparison,\n      periodComparison: AnyComparison,\n    ): string|undefined {\n      if (!this.comparisonTooltips\n        || !Object.keys(this.comparisonTooltips).length\n      ) {\n        return undefined;\n      }\n\n      return (this.comparisonTooltips[periodComparison.index] || {})[segmentComparison.index];\n    },\n    getUrlToSegment(segment: string) {\n      const hash = { ...MatomoUrl.hashParsed.value };\n      delete hash.comparePeriods;\n      delete hash.compareDates;\n      delete hash.compareSegments;\n      hash.segment = segment;\n      return `${window.location.search}#?${MatomoUrl.stringify(hash)}`;\n    },\n    onComparisonsChanged() {\n      this.comparisonTooltips = null;\n\n      if (!ComparisonsStoreInstance.isComparing()) {\n        return;\n      }\n\n      const periodComparisons = ComparisonsStoreInstance.getPeriodComparisons();\n      const segmentComparisons = ComparisonsStoreInstance.getSegmentComparisons();\n      AjaxHelper.fetch({\n        method: 'API.getProcessedReport',\n        apiModule: 'VisitsSummary',\n        apiAction: 'get',\n        compare: '1',\n        compareSegments: MatomoUrl.getSearchParam('compareSegments'),\n        comparePeriods: MatomoUrl.getSearchParam('comparePeriods'),\n        compareDates: MatomoUrl.getSearchParam('compareDates'),\n        format_metrics: '1',\n      }).then((report) => {\n        this.comparisonTooltips = {};\n        periodComparisons.forEach((periodComp) => {\n          this.comparisonTooltips![periodComp.index] = {};\n\n          segmentComparisons.forEach((segmentComp) => {\n            const tooltip = this.generateComparisonTooltip(report, periodComp, segmentComp);\n            this.comparisonTooltips![periodComp.index][segmentComp.index] = tooltip;\n          });\n        });\n      });\n    },\n    generateComparisonTooltip(\n      visitsSummary: ProcessedReportResponse,\n      periodComp: AnyComparison,\n      segmentComp: AnyComparison,\n    ): string {\n      if (!visitsSummary.reportData.comparisons) { // sanity check\n        return '';\n      }\n\n      const firstRowIndex = ComparisonsStoreInstance.getComparisonSeriesIndex(\n        periodComp.index,\n        0,\n      );\n\n      const firstRow = visitsSummary.reportData.comparisons[firstRowIndex];\n\n      const comparisonRowIndex = ComparisonsStoreInstance.getComparisonSeriesIndex(\n        periodComp.index,\n        segmentComp.index,\n      );\n      const comparisonRow = visitsSummary.reportData.comparisons[comparisonRowIndex];\n\n      const firstPeriodRow = visitsSummary.reportData.comparisons[segmentComp.index];\n\n      let tooltip = '<div class=\"comparison-card-tooltip\">';\n\n      let visitsPercent = ((comparisonRow.nb_visits / firstRow.nb_visits) * 100)\n        .toFixed(2);\n      visitsPercent = `${visitsPercent}%`;\n\n      tooltip += translate('General_ComparisonCardTooltip1', [\n        `'${comparisonRow.compareSegmentPretty}'`,\n        comparisonRow.comparePeriodPretty,\n        visitsPercent,\n        comparisonRow.nb_visits.toString(),\n        firstRow.nb_visits.toString(),\n      ]);\n      if (periodComp.index > 0) {\n        tooltip += '<br/><br/>';\n        tooltip += translate('General_ComparisonCardTooltip2', [\n          comparisonRow.nb_visits_change.toString(),\n          firstPeriodRow.compareSegmentPretty,\n          firstPeriodRow.comparePeriodPretty,\n        ]);\n      }\n\n      tooltip += '</div>';\n      return tooltip;\n    },\n  },\n  mounted() {\n    Matomo.on('piwikComparisonsChanged', () => {\n      this.onComparisonsChanged();\n    });\n\n    this.onComparisonsChanged();\n  },\n});\n</script>\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { reactive, readonly, DeepReadonly } from 'vue';\nimport Matomo from '../Matomo/Matomo';\n\ninterface SegmentInfo {\n  definition: string;\n  name: string;\n}\n\ninterface SegmentsStoreData {\n  availableSegments: SegmentInfo[];\n}\n\nclass SegmentsStore {\n  private segmentState = reactive<SegmentsStoreData>({\n    availableSegments: [],\n  });\n\n  get state(): DeepReadonly<SegmentsStoreData> {\n    return readonly(this.segmentState);\n  }\n\n  constructor() {\n    Matomo.on('piwikSegmentationInited', () => this.setSegmentState());\n  }\n\n  private setSegmentState() {\n    try {\n      const uiControlObject = $('.segmentEditorPanel').data('uiControlObject');\n      this.segmentState.availableSegments = uiControlObject.impl.availableSegments || [];\n    } catch (e) {\n      // segment editor is not initialized yet\n    }\n  }\n}\n\nexport default new SegmentsStore();\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport {\n  reactive,\n  watch,\n  computed,\n  readonly,\n} from 'vue';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport Matomo from '../Matomo/Matomo';\nimport { translate } from '../translate';\nimport Periods from '../Periods/Periods';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport SegmentsStore from '../Segmentation/Segments.store';\n\nconst SERIES_COLOR_COUNT = 8;\nconst SERIES_SHADE_COUNT = 3;\n\nexport interface SegmentComparison {\n  params: {\n    segment: string,\n  },\n  title: string,\n  index: number,\n}\n\nexport interface PeriodComparison {\n  params: {\n    period: string,\n    date: string,\n  },\n  title: string,\n  index: number,\n}\n\nexport interface AnyComparison {\n  params: { [name: string]: string },\n  title: string,\n  index: number,\n}\n\nexport interface ComparisonsStoreState {\n  comparisonsDisabledFor: string[];\n}\n\nexport interface ComparisonSeriesInfo {\n  index: number;\n  params: { [key: string]: string };\n  color: string;\n}\n\nfunction wrapArray<T>(values: T | T[]): T[] {\n  if (!values) {\n    return [];\n  }\n  return Array.isArray(values) ? values : [values];\n}\n\nexport default class ComparisonsStore {\n  private privateState = reactive<ComparisonsStoreState>({\n    comparisonsDisabledFor: [],\n  });\n\n  readonly state = readonly(this.privateState); // for tests\n\n  private colors: { [key: string]: string } = {};\n\n  readonly segmentComparisons = computed(() => this.parseSegmentComparisons());\n\n  readonly periodComparisons = computed(() => this.parsePeriodComparisons());\n\n  readonly isEnabled = computed(() => this.checkEnabledForCurrentPage());\n\n  constructor() {\n    if (document.readyState === 'complete'\n      || document.readyState === 'interactive') {\n      this.loadComparisonsDisabledFor();\n    } else {\n      document.addEventListener('DOMContentLoaded', () => {\n        this.loadComparisonsDisabledFor();\n      });\n    }\n\n    $(() => {\n      this.colors = this.getAllSeriesColors() as { [key: string]: string };\n    });\n\n    watch(\n      () => this.getComparisons(),\n      () => Matomo.postEvent('piwikComparisonsChanged'),\n      { deep: true },\n    );\n  }\n\n  getComparisons(): AnyComparison[] {\n    return (this.getSegmentComparisons() as AnyComparison[])\n      .concat(this.getPeriodComparisons() as AnyComparison[]);\n  }\n\n  isComparing(): boolean {\n    return this.isComparisonEnabled()\n      // first two in each array are for the currently selected segment/period\n      && (this.segmentComparisons.value.length > 1\n        || this.periodComparisons.value.length > 1);\n  }\n\n  isComparingPeriods(): boolean {\n    return this.getPeriodComparisons().length > 1; // first is currently selected period\n  }\n\n  getSegmentComparisons(): SegmentComparison[] {\n    if (!this.isComparisonEnabled()) {\n      return [];\n    }\n\n    return this.segmentComparisons.value;\n  }\n\n  getPeriodComparisons(): PeriodComparison[] {\n    if (!this.isComparisonEnabled()) {\n      return [];\n    }\n\n    return this.periodComparisons.value;\n  }\n\n  getSeriesColor(\n    segmentComparison: SegmentComparison,\n    periodComparison: PeriodComparison,\n    metricIndex = 0,\n  ): string {\n    const seriesIndex = this.getComparisonSeriesIndex(\n      periodComparison.index,\n      segmentComparison.index,\n    ) % SERIES_COLOR_COUNT;\n\n    if (metricIndex === 0) {\n      return this.colors[`series${seriesIndex}`];\n    }\n\n    const shadeIndex = metricIndex % SERIES_SHADE_COUNT;\n    return this.colors[`series${seriesIndex}-shade${shadeIndex}`];\n  }\n\n  getSeriesColorName(seriesIndex: number, metricIndex: number): string {\n    let colorName = `series${(seriesIndex % SERIES_COLOR_COUNT)}`;\n    if (metricIndex > 0) {\n      colorName += `-shade${(metricIndex % SERIES_SHADE_COUNT)}`;\n    }\n    return colorName;\n  }\n\n  isComparisonEnabled(): boolean {\n    return this.isEnabled.value;\n  }\n\n  getIndividualComparisonRowIndices(seriesIndex: number): {\n    segmentIndex: number,\n    periodIndex: number,\n  } {\n    const segmentCount = this.getSegmentComparisons().length;\n    const segmentIndex = seriesIndex % segmentCount;\n    const periodIndex = Math.floor(seriesIndex / segmentCount);\n\n    return {\n      segmentIndex,\n      periodIndex,\n    };\n  }\n\n  getComparisonSeriesIndex(periodIndex: number, segmentIndex: number): number {\n    const segmentCount = this.getSegmentComparisons().length;\n    return periodIndex * segmentCount + segmentIndex;\n  }\n\n  getAllComparisonSeries(): ComparisonSeriesInfo[] {\n    const seriesInfo: ComparisonSeriesInfo[] = [];\n\n    let seriesIndex = 0;\n    this.getPeriodComparisons().forEach((periodComp) => {\n      this.getSegmentComparisons().forEach((segmentComp) => {\n        seriesInfo.push({\n          index: seriesIndex,\n          params: { ...segmentComp.params, ...periodComp.params },\n          color: this.colors[`series${seriesIndex}`],\n        });\n        seriesIndex += 1;\n      });\n    });\n\n    return seriesInfo;\n  }\n\n  removeSegmentComparison(index: number): void {\n    if (!this.isComparisonEnabled()) {\n      throw new Error('Comparison disabled.');\n    }\n\n    const newComparisons: SegmentComparison[] = [...this.segmentComparisons.value];\n    newComparisons.splice(index, 1);\n\n    const extraParams: {[key: string]: string} = {};\n    if (index === 0) {\n      extraParams.segment = newComparisons[0].params.segment;\n    }\n\n    this.updateQueryParamsFromComparisons(\n      newComparisons,\n      this.periodComparisons.value,\n      extraParams,\n    );\n  }\n\n  addSegmentComparison(params: { [name: string]: string }): void {\n    if (!this.isComparisonEnabled()) {\n      throw new Error('Comparison disabled.');\n    }\n\n    const newComparisons = this.segmentComparisons.value\n      .concat([{ params, index: -1, title: '' } as SegmentComparison]);\n    this.updateQueryParamsFromComparisons(newComparisons, this.periodComparisons.value);\n  }\n\n  private updateQueryParamsFromComparisons(\n    segmentComparisons: SegmentComparison[],\n    periodComparisons: PeriodComparison[],\n    extraParams = {},\n  ) {\n    // get unique segments/periods/dates from new Comparisons\n    const compareSegments: {[key: string]: boolean} = {};\n    const comparePeriodDatePairs: {[key: string]: boolean} = {};\n\n    let firstSegment = false;\n    let firstPeriod = false;\n\n    segmentComparisons.forEach((comparison) => {\n      if (firstSegment) {\n        compareSegments[comparison.params.segment] = true;\n      } else {\n        firstSegment = true;\n      }\n    });\n\n    periodComparisons.forEach((comparison) => {\n      if (firstPeriod) {\n        comparePeriodDatePairs[`${comparison.params.period}|${comparison.params.date}`] = true;\n      } else {\n        firstPeriod = true;\n      }\n    });\n\n    const comparePeriods: string[] = [];\n    const compareDates: string[] = [];\n    Object.keys(comparePeriodDatePairs).forEach((pair) => {\n      const parts = pair.split('|');\n      comparePeriods.push(parts[0]);\n      compareDates.push(parts[1]);\n    });\n\n    const compareParams: {[key: string]: string[]} = {\n      compareSegments: Object.keys(compareSegments),\n      comparePeriods,\n      compareDates,\n    };\n\n    // change the page w/ these new param values\n    const baseParams = Matomo.helper.isReportingPage()\n      ? MatomoUrl.hashParsed.value\n      : MatomoUrl.urlParsed.value;\n    MatomoUrl.updateLocation({\n      ...baseParams,\n      ...compareParams,\n      ...extraParams,\n    });\n  }\n\n  private getAllSeriesColors() {\n    const { ColorManager } = Matomo;\n    if (!ColorManager) {\n      return [];\n    }\n\n    const seriesColorNames = [];\n\n    for (let i = 0; i < SERIES_COLOR_COUNT; i += 1) {\n      seriesColorNames.push(`series${i}`);\n      for (let j = 0; j < SERIES_SHADE_COUNT; j += 1) {\n        seriesColorNames.push(`series${i}-shade${j}`);\n      }\n    }\n\n    return ColorManager.getColors('comparison-series-color', seriesColorNames);\n  }\n\n  private loadComparisonsDisabledFor() {\n    const matomoModule: string = MatomoUrl.parsed.value.module as string;\n\n    // Skip while installing, updating or logging in\n    if (matomoModule === 'CoreUpdater'\n      || matomoModule === 'Installation'\n      || matomoModule === 'Overlay'\n      || window.piwik.isPagesComparisonApiDisabled\n      || window.piwik.installation\n      || window.broadcast.isLoginPage()\n    ) {\n      this.privateState.comparisonsDisabledFor = [];\n      return;\n    }\n\n    AjaxHelper.fetch({\n      module: 'API',\n      method: 'API.getPagesComparisonsDisabledFor',\n    }).then((result) => {\n      this.privateState.comparisonsDisabledFor = result;\n    });\n  }\n\n  private parseSegmentComparisons(): SegmentComparison[] {\n    const { availableSegments } = SegmentsStore.state;\n\n    const compareSegments: string[] = [\n      ...wrapArray(MatomoUrl.parsed.value.compareSegments as string[]),\n    ];\n\n    // add base comparisons\n    compareSegments.unshift(MatomoUrl.parsed.value.segment as string || '');\n\n    const newSegmentComparisons: SegmentComparison[] = [];\n    compareSegments.forEach((segment, idx) => {\n      let storedSegment!: { definition: string, name: string };\n\n      availableSegments.forEach((s) => {\n        if (s.definition === segment\n          || s.definition === decodeURIComponent(segment)\n          || decodeURIComponent(s.definition) === segment\n        ) {\n          storedSegment = s;\n        }\n      });\n\n      let segmentTitle = storedSegment ? storedSegment.name : translate('General_Unknown');\n      if (segment.trim() === '') {\n        segmentTitle = translate('SegmentEditor_DefaultAllVisits');\n      }\n\n      newSegmentComparisons.push({\n        params: {\n          segment,\n        },\n        title: Matomo.helper.htmlDecode(segmentTitle),\n        index: idx,\n      });\n    });\n\n    return newSegmentComparisons;\n  }\n\n  private parsePeriodComparisons(): PeriodComparison[] {\n    const comparePeriods: string[] = [\n      ...wrapArray(MatomoUrl.parsed.value.comparePeriods as string[]),\n    ];\n\n    const compareDates: string[] = [\n      ...wrapArray(MatomoUrl.parsed.value.compareDates as string[]),\n    ];\n\n    comparePeriods.unshift(MatomoUrl.parsed.value.period as string);\n    compareDates.unshift(MatomoUrl.parsed.value.date as string);\n\n    const newPeriodComparisons: PeriodComparison[] = [];\n    for (let i = 0; i < Math.min(compareDates.length, comparePeriods.length); i += 1) {\n      let title;\n      try {\n        title = Periods.parse(comparePeriods[i], compareDates[i]).getPrettyString();\n      } catch (e) {\n        title = translate('General_Error');\n      }\n\n      newPeriodComparisons.push({\n        params: {\n          date: compareDates[i],\n          period: comparePeriods[i],\n        },\n        title,\n        index: i,\n      });\n    }\n\n    return newPeriodComparisons;\n  }\n\n  private checkEnabledForCurrentPage() {\n    // category/subcategory is not included on top bar pages, so in that case we use module/action\n    const category = MatomoUrl.parsed.value.category || MatomoUrl.parsed.value.module;\n    const subcategory = MatomoUrl.parsed.value.subcategory\n      || MatomoUrl.parsed.value.action;\n\n    const id = `${category}.${subcategory}`;\n    const isEnabled = this.privateState.comparisonsDisabledFor.indexOf(id) === -1\n      && this.privateState.comparisonsDisabledFor.indexOf(`${category}.*`) === -1;\n\n    document.documentElement.classList.toggle('comparisonsDisabled', !isEnabled);\n\n    return isEnabled;\n  }\n}\n","import ComparisonsStore from './Comparisons.store';\n\nexport default new ComparisonsStore();\n","\nimport { defineComponent, computed } from 'vue';\nimport { AnyComparison } from './Comparisons.store';\nimport ComparisonsStoreInstance from './Comparisons.store.instance';\nimport Matomo from '../Matomo/Matomo';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport { translate } from '../translate';\nimport Tooltips from '../Tooltips/Tooltips';\n\ninterface ProcessedReportComparison {\n  compareSegmentPretty: string;\n  comparePeriodPretty: string;\n  nb_visits: number;\n  nb_visits_change: number;\n}\n\ninterface ProcessedReportData {\n  comparisons?: ProcessedReportComparison[];\n}\n\ninterface ProcessedReportResponse {\n  reportData: ProcessedReportData;\n}\n\ninterface ComparisonState {\n  comparisonTooltips: Record<string, Record<string, string>>|null;\n}\n\nexport default defineComponent({\n  props: {\n  },\n  directives: {\n    Tooltips,\n  },\n  data(): ComparisonState {\n    return {\n      comparisonTooltips: null,\n    };\n  },\n  setup() {\n    // accessing has to be done through a computed property so we can use the computed\n    // instance directly in the template. unfortunately, vue won't register to changes.\n    const isComparing = computed(\n      () => ComparisonsStoreInstance.isComparing() && !window.broadcast.isNoDataPage(),\n    );\n    const segmentComparisons = computed(() => ComparisonsStoreInstance.getSegmentComparisons());\n    const periodComparisons = computed(() => ComparisonsStoreInstance.getPeriodComparisons());\n    const getSeriesColor = ComparisonsStoreInstance.getSeriesColor.bind(ComparisonsStoreInstance);\n\n    function transformTooltipContent(this: HTMLElement) {\n      const title = window.$(this).attr('title');\n      if (!title) {\n        return title;\n      }\n      return window.vueSanitize(title.replace(/\\n/g, '<br />'));\n    }\n\n    return {\n      isComparing,\n      segmentComparisons,\n      periodComparisons,\n      getSeriesColor,\n      transformTooltipContent,\n    };\n  },\n  methods: {\n    comparisonHasSegment(comparison: AnyComparison) {\n      return typeof comparison.params.segment !== 'undefined';\n    },\n    removeSegmentComparison(index: number) {\n      // otherwise the tooltip will be stuck on the screen\n      window.$(this.$refs.root as HTMLElement).tooltip('destroy');\n      ComparisonsStoreInstance.removeSegmentComparison(index);\n    },\n    getComparisonPeriodType(comparison: AnyComparison) {\n      const { period } = comparison.params;\n      if (period === 'range') {\n        return translate('CoreHome_PeriodRange');\n      }\n      const periodStr = translate(\n        `Intl_Period${period.substring(0, 1).toUpperCase()}${period.substring(1)}`,\n      );\n      return periodStr.substring(0, 1).toUpperCase() + periodStr.substring(1);\n    },\n    getComparisonTooltip(\n      segmentComparison: AnyComparison,\n      periodComparison: AnyComparison,\n    ): string|undefined {\n      if (!this.comparisonTooltips\n        || !Object.keys(this.comparisonTooltips).length\n      ) {\n        return undefined;\n      }\n\n      return (this.comparisonTooltips[periodComparison.index] || {})[segmentComparison.index];\n    },\n    getUrlToSegment(segment: string) {\n      const hash = { ...MatomoUrl.hashParsed.value };\n      delete hash.comparePeriods;\n      delete hash.compareDates;\n      delete hash.compareSegments;\n      hash.segment = segment;\n      return `${window.location.search}#?${MatomoUrl.stringify(hash)}`;\n    },\n    onComparisonsChanged() {\n      this.comparisonTooltips = null;\n\n      if (!ComparisonsStoreInstance.isComparing()) {\n        return;\n      }\n\n      const periodComparisons = ComparisonsStoreInstance.getPeriodComparisons();\n      const segmentComparisons = ComparisonsStoreInstance.getSegmentComparisons();\n      AjaxHelper.fetch({\n        method: 'API.getProcessedReport',\n        apiModule: 'VisitsSummary',\n        apiAction: 'get',\n        compare: '1',\n        compareSegments: MatomoUrl.getSearchParam('compareSegments'),\n        comparePeriods: MatomoUrl.getSearchParam('comparePeriods'),\n        compareDates: MatomoUrl.getSearchParam('compareDates'),\n        format_metrics: '1',\n      }).then((report) => {\n        this.comparisonTooltips = {};\n        periodComparisons.forEach((periodComp) => {\n          this.comparisonTooltips![periodComp.index] = {};\n\n          segmentComparisons.forEach((segmentComp) => {\n            const tooltip = this.generateComparisonTooltip(report, periodComp, segmentComp);\n            this.comparisonTooltips![periodComp.index][segmentComp.index] = tooltip;\n          });\n        });\n      });\n    },\n    generateComparisonTooltip(\n      visitsSummary: ProcessedReportResponse,\n      periodComp: AnyComparison,\n      segmentComp: AnyComparison,\n    ): string {\n      if (!visitsSummary.reportData.comparisons) { // sanity check\n        return '';\n      }\n\n      const firstRowIndex = ComparisonsStoreInstance.getComparisonSeriesIndex(\n        periodComp.index,\n        0,\n      );\n\n      const firstRow = visitsSummary.reportData.comparisons[firstRowIndex];\n\n      const comparisonRowIndex = ComparisonsStoreInstance.getComparisonSeriesIndex(\n        periodComp.index,\n        segmentComp.index,\n      );\n      const comparisonRow = visitsSummary.reportData.comparisons[comparisonRowIndex];\n\n      const firstPeriodRow = visitsSummary.reportData.comparisons[segmentComp.index];\n\n      let tooltip = '<div class=\"comparison-card-tooltip\">';\n\n      let visitsPercent = ((comparisonRow.nb_visits / firstRow.nb_visits) * 100)\n        .toFixed(2);\n      visitsPercent = `${visitsPercent}%`;\n\n      tooltip += translate('General_ComparisonCardTooltip1', [\n        `'${comparisonRow.compareSegmentPretty}'`,\n        comparisonRow.comparePeriodPretty,\n        visitsPercent,\n        comparisonRow.nb_visits.toString(),\n        firstRow.nb_visits.toString(),\n      ]);\n      if (periodComp.index > 0) {\n        tooltip += '<br/><br/>';\n        tooltip += translate('General_ComparisonCardTooltip2', [\n          comparisonRow.nb_visits_change.toString(),\n          firstPeriodRow.compareSegmentPretty,\n          firstPeriodRow.comparePeriodPretty,\n        ]);\n      }\n\n      tooltip += '</div>';\n      return tooltip;\n    },\n  },\n  mounted() {\n    Matomo.on('piwikComparisonsChanged', () => {\n      this.onComparisonsChanged();\n    });\n\n    this.onComparisonsChanged();\n  },\n});\n","import { render } from \"./Comparisons.vue?vue&type=template&id=39ac6c4e\"\nimport script from \"./Comparisons.vue?vue&type=script&lang=ts\"\nexport * from \"./Comparisons.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    ref=\"root\"\n    class=\"menuDropdown\"\n    v-focus-anywhere-but-here=\"{ blur: lostFocus }\"\n  >\n    <span\n      class=\"title\"\n      @click=\"showItems = !showItems\"\n      :title=\"tooltip\"\n    >\n      <span v-html=\"$sanitize(this.actualMenuTitle)\" />\n      <span class=\"icon-chevron-down reporting-menu-sub-icon\" />\n    </span>\n    <div\n      class=\"items\"\n      v-show=\"showItems\"\n    >\n      <div\n        class=\"search\"\n        v-if=\"showSearch && showItems\"\n      >\n        <input\n          type=\"text\"\n          v-model=\"searchTerm\"\n          v-focus-if=\"{ focused: showItems }\"\n          @keydown=\"onSearchTermKeydown($event)\"\n          :placeholder=\"translate('General_Search')\"\n        />\n        <div\n          v-show=\"!searchTerm\"\n          class=\"search_ico icon-search\"\n          :title=\"translate('General_Search')\"\n        />\n        <div\n          v-show=\"searchTerm\"\n          v-on:click=\"searchTerm = '';searchItems('')\"\n          class=\"reset icon-close\"\n          :title=\"translate('General_Clear')\"\n        />\n      </div>\n      <div v-on:click=\"selectItem($event)\">\n        <slot />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport FocusAnywhereButHere from '../FocusAnywhereButHere/FocusAnywhereButHere';\nimport FocusIf from '../FocusIf/FocusIf';\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    menuTitle: String,\n    tooltip: String,\n    showSearch: Boolean,\n    menuTitleChangeOnClick: Boolean,\n  },\n  directives: {\n    FocusAnywhereButHere,\n    FocusIf,\n  },\n  emits: ['afterSelect'],\n  watch: {\n    menuTitle() {\n      this.actualMenuTitle = this.menuTitle;\n    },\n  },\n  data() {\n    return {\n      showItems: false,\n      searchTerm: '',\n      actualMenuTitle: this.menuTitle,\n    };\n  },\n  methods: {\n    lostFocus() {\n      this.showItems = false;\n    },\n    selectItem(event: MouseEvent) {\n      const targetClasses = (event.target as HTMLElement).classList;\n      if (!targetClasses.contains('item')\n        || targetClasses.contains('disabled')\n        || targetClasses.contains('separator')\n      ) {\n        return;\n      }\n\n      if (this.menuTitleChangeOnClick) {\n        this.actualMenuTitle = ((event.target as HTMLElement).textContent || '')\n          .replace(/[\\u0000-\\u2666]/g, (c) => `&#${c.charCodeAt(0)};`); // eslint-disable-line\n      }\n\n      this.showItems = false;\n\n      $(this.$slots.default!()[0]!.el as HTMLElement).find('.item').removeClass('active');\n      targetClasses.add('active');\n\n      this.$emit('afterSelect', event.target);\n    },\n    onSearchTermKeydown() {\n      setTimeout(() => {\n        this.searchItems(this.searchTerm);\n      });\n    },\n    searchItems(unprocessedSearchTerm: string) {\n      const searchTerm = unprocessedSearchTerm.toLowerCase();\n\n      $(this.$refs.root as HTMLElement).find('.item').each((index: number, node: HTMLElement) => {\n        const $node = $(node);\n\n        if ($node.text().toLowerCase().indexOf(searchTerm) === -1) {\n          $node.hide();\n        } else {\n          $node.show();\n        }\n      });\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport FocusAnywhereButHere from '../FocusAnywhereButHere/FocusAnywhereButHere';\nimport FocusIf from '../FocusIf/FocusIf';\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    menuTitle: String,\n    tooltip: String,\n    showSearch: Boolean,\n    menuTitleChangeOnClick: Boolean,\n  },\n  directives: {\n    FocusAnywhereButHere,\n    FocusIf,\n  },\n  emits: ['afterSelect'],\n  watch: {\n    menuTitle() {\n      this.actualMenuTitle = this.menuTitle;\n    },\n  },\n  data() {\n    return {\n      showItems: false,\n      searchTerm: '',\n      actualMenuTitle: this.menuTitle,\n    };\n  },\n  methods: {\n    lostFocus() {\n      this.showItems = false;\n    },\n    selectItem(event: MouseEvent) {\n      const targetClasses = (event.target as HTMLElement).classList;\n      if (!targetClasses.contains('item')\n        || targetClasses.contains('disabled')\n        || targetClasses.contains('separator')\n      ) {\n        return;\n      }\n\n      if (this.menuTitleChangeOnClick) {\n        this.actualMenuTitle = ((event.target as HTMLElement).textContent || '')\n          .replace(/[\\u0000-\\u2666]/g, (c) => `&#${c.charCodeAt(0)};`); // eslint-disable-line\n      }\n\n      this.showItems = false;\n\n      $(this.$slots.default!()[0]!.el as HTMLElement).find('.item').removeClass('active');\n      targetClasses.add('active');\n\n      this.$emit('afterSelect', event.target);\n    },\n    onSearchTermKeydown() {\n      setTimeout(() => {\n        this.searchItems(this.searchTerm);\n      });\n    },\n    searchItems(unprocessedSearchTerm: string) {\n      const searchTerm = unprocessedSearchTerm.toLowerCase();\n\n      $(this.$refs.root as HTMLElement).find('.item').each((index: number, node: HTMLElement) => {\n        const $node = $(node);\n\n        if ($node.text().toLowerCase().indexOf(searchTerm) === -1) {\n          $node.hide();\n        } else {\n          $node.show();\n        }\n      });\n    },\n  },\n});\n","import { render } from \"./MenuItemsDropdown.vue?vue&type=template&id=3418188f\"\nimport script from \"./MenuItemsDropdown.vue?vue&type=script&lang=ts\"\nexport * from \"./MenuItemsDropdown.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div ref=\"root\"/>\n</template>\n\n<script lang=\"ts\">\nimport {\n  defineComponent,\n  ref,\n  watch,\n  onMounted,\n} from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport { parseDate } from '../Periods';\n\nconst DEFAULT_STEP_MONTHS = 1;\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    selectedDateStart: Date,\n    selectedDateEnd: Date,\n    highlightedDateStart: Date,\n    highlightedDateEnd: Date,\n    viewDate: [String, Date],\n    stepMonths: Number,\n    disableMonthDropdown: Boolean,\n    options: Object,\n  },\n  emits: ['cellHover', 'cellHoverLeave', 'dateSelect'],\n  setup(props, context) {\n    const root = ref<HTMLElement|null>(null);\n\n    function setDateCellColor($dateCell: JQuery, dateValue: Date): void {\n      const $dateCellLink = $dateCell.children('a');\n\n      if (props.selectedDateStart\n        && props.selectedDateEnd\n        && dateValue >= props.selectedDateStart\n        && dateValue <= props.selectedDateEnd\n      ) {\n        $dateCell.addClass('ui-datepicker-current-period');\n      } else {\n        $dateCell.removeClass('ui-datepicker-current-period');\n      }\n\n      if (props.highlightedDateStart\n        && props.highlightedDateEnd\n        && dateValue >= props.highlightedDateStart\n        && dateValue <= props.highlightedDateEnd\n      ) {\n        // other-month cells don't have links, so the <td> must have the ui-state-hover class\n        const elementToAddClassTo = $dateCellLink.length ? $dateCellLink : $dateCell;\n        elementToAddClassTo.addClass('ui-state-hover');\n      } else {\n        $dateCell.removeClass('ui-state-hover');\n        $dateCellLink.removeClass('ui-state-hover');\n      }\n    }\n\n    function getCellDate($dateCell: JQuery, month: number, year: number): Date {\n      if ($dateCell.hasClass('ui-datepicker-other-month')) {\n        return getOtherMonthDate($dateCell, month, year); // eslint-disable-line\n      }\n\n      const day = parseInt($dateCell.children('a,span').text(), 10);\n\n      return new Date(year, month, day);\n    }\n\n    function getOtherMonthDate($dateCell: JQuery, month: number, year: number) {\n      let date;\n\n      const $row = $dateCell.parent();\n      const $rowCells = $row.children('td');\n\n      // if in the first row, the date cell is before the current month\n      if ($row.is(':first-child')) {\n        const $firstDateInMonth = $row.children('td:not(.ui-datepicker-other-month)').first();\n\n        date = getCellDate($firstDateInMonth, month, year);\n        date.setDate($rowCells.index($dateCell) - $rowCells.index($firstDateInMonth) + 1);\n        return date;\n      }\n\n      // the date cell is after the current month\n      const $lastDateInMonth = $row.children('td:not(.ui-datepicker-other-month)').last();\n\n      date = getCellDate($lastDateInMonth, month, year);\n      date.setDate(date.getDate() + $rowCells.index($dateCell) - $rowCells.index($lastDateInMonth));\n      return date;\n    }\n\n    function getMonthYearDisplayed(): number[] {\n      const element = $(root.value!) as JQuery;\n\n      const $firstCellWithMonth = element.find('td[data-month]');\n      const month = parseInt($firstCellWithMonth.attr('data-month')!, 10);\n      const year = parseInt($firstCellWithMonth.attr('data-year')!, 10);\n\n      return [month, year];\n    }\n\n    function setDatePickerCellColors() {\n      const element = $(root.value!);\n\n      const $calendarTable = element.find('.ui-datepicker-calendar');\n\n      const monthYear = getMonthYearDisplayed();\n\n      // highlight the rest of the cells by first getting the date for the first cell\n      // in the calendar, then just incrementing by one for the rest of the cells.\n      const $cells = $calendarTable.find('td');\n      const $firstDateCell = $cells.first();\n      const currentDate = getCellDate($firstDateCell, monthYear[0], monthYear[1]);\n\n      $cells.each(function setCellColor() {\n        setDateCellColor($(this), currentDate);\n\n        currentDate.setDate(currentDate.getDate() + 1);\n      });\n    }\n\n    function viewDateChanged(): boolean {\n      if (!props.viewDate) {\n        return false;\n      }\n\n      let date: Date;\n      if (typeof props.viewDate === 'string') {\n        try {\n          date = parseDate(props.viewDate);\n        } catch (e) {\n          return false;\n        }\n      } else {\n        date = props.viewDate as Date;\n      }\n\n      const element = $(root.value!);\n\n      // only change the datepicker date if the date is outside of the current month/year.\n      // this avoids a re-render in other cases.\n      const monthYear = getMonthYearDisplayed();\n      if (monthYear[0] !== date.getMonth() || monthYear[1] !== date.getFullYear()) {\n        element.datepicker('setDate', date);\n        return true;\n      }\n\n      return false;\n    }\n\n    // remove the ui-state-active class & click handlers for every cell. we bypass\n    // the datepicker's date selection logic for smoother browser rendering.\n    function onJqueryUiRenderedPicker(): void {\n      const element = $(root.value!);\n\n      element.find('td[data-event]').off('click');\n      element.find('.ui-state-active').removeClass('ui-state-active');\n      element.find('.ui-datepicker-current-day').removeClass('ui-datepicker-current-day');\n\n      // add href to left/right nav in calendar so they can be accessed via keyboard\n      element.find('.ui-datepicker-prev,.ui-datepicker-next').attr('href', '');\n    }\n\n    function stepMonthsChanged(): boolean {\n      const element = $(root.value!);\n\n      const stepMonths = props.stepMonths || DEFAULT_STEP_MONTHS;\n      if (element.datepicker('option', 'stepMonths') === stepMonths) {\n        return false;\n      }\n\n      // setting stepMonths will change the month in view back to the selected date. to avoid\n      // we set the selected date to the month in view.\n      const currentMonth = $('.ui-datepicker-month', element).val() as number;\n      const currentYear = $('.ui-datepicker-year', element).val() as number;\n\n      element\n        .datepicker('option', 'stepMonths', stepMonths)\n        .datepicker('setDate', new Date(currentYear, currentMonth));\n\n      onJqueryUiRenderedPicker();\n\n      return true;\n    }\n\n    function enableDisableMonthDropdown(): void {\n      const element = $(root.value!);\n      const monthPicker = element.find('.ui-datepicker-month')[0] as HTMLInputElement;\n      if (monthPicker) {\n        monthPicker.disabled = props.disableMonthDropdown;\n      }\n    }\n\n    function handleOtherMonthClick(this: HTMLElement) {\n      if (!$(this).hasClass('ui-state-hover')) {\n        return;\n      }\n\n      const $row = $(this).parent();\n      const $tbody = $row.parent();\n\n      if ($row.is(':first-child')) {\n        // click on first of the month\n        $tbody.find('a').first().click();\n      } else {\n        // click on last of month\n        $tbody.find('a').last().click();\n      }\n    }\n\n    function onCalendarViewChange() {\n      // clicking left/right re-enables the month dropdown, so we disable it again\n      enableDisableMonthDropdown();\n\n      setDatePickerCellColors();\n    }\n\n    // on a prop change (NOTE: we can't watch just `props`, since then newProps and oldProps will\n    // have the same values (since it is a proxy object). Using a copy doesn't quite work, the\n    // object it returns will always be different, BUT, since we check what changes it works\n    // for our purposes. The only downside is that it runs on every tick basically, but since\n    // that is within the context of the date picker component, it's bearable.\n    watch(() => ({ ...props }), (newProps: typeof props, oldProps: typeof props) => {\n      let redraw = false;\n\n      [\n        (x: typeof props): Date|undefined => x.selectedDateStart,\n        (x: typeof props): Date|undefined => x.selectedDateEnd,\n        (x: typeof props): Date|undefined => x.highlightedDateStart,\n        (x: typeof props): Date|undefined => x.highlightedDateEnd,\n      ].forEach((selector) => {\n        if (redraw) {\n          return;\n        }\n\n        const newProp = selector(newProps);\n        const oldProp = selector(oldProps);\n\n        if (!newProp && oldProp) {\n          redraw = true;\n        }\n\n        if (newProp && !oldProp) {\n          redraw = true;\n        }\n\n        if (newProp\n          && oldProp\n          && newProp.getTime() !== oldProp.getTime()\n        ) {\n          redraw = true;\n        }\n      });\n\n      if (newProps.viewDate !== oldProps.viewDate && viewDateChanged()) {\n        redraw = true;\n      }\n\n      if (newProps.stepMonths !== oldProps.stepMonths) {\n        stepMonthsChanged();\n      }\n\n      if (newProps.disableMonthDropdown !== oldProps.disableMonthDropdown) {\n        enableDisableMonthDropdown();\n      }\n\n      // redraw when selected/highlighted dates change\n      if (redraw) {\n        setDatePickerCellColors();\n      }\n    });\n\n    onMounted(() => {\n      const element = $(root.value!);\n\n      const customOptions = props.options || {};\n      const datePickerOptions = {\n        ...Matomo.getBaseDatePickerOptions(),\n        ...customOptions,\n        onChangeMonthYear: () => {\n          // datepicker renders the HTML after this hook is called, so we use setTimeout\n          // to run some code after the render.\n          setTimeout(() => {\n            onJqueryUiRenderedPicker();\n          });\n        },\n      };\n      element.datepicker(datePickerOptions);\n\n      element.on('mouseover', 'tbody td a', (event) => {\n        // this event is triggered when a user clicks a date as well. in that case,\n        // the originalEvent is null. we don't need to redraw again for that, so\n        // we ignore events like that.\n        if (event.originalEvent) {\n          setDatePickerCellColors();\n        }\n      });\n\n      // on hover cell, execute scope.cellHover()\n      element.on('mouseenter', 'tbody td', function onMouseEnter() {\n        const monthYear = getMonthYearDisplayed();\n\n        const $dateCell = $(this);\n        const dateValue = getCellDate($dateCell, monthYear[0], monthYear[1]);\n        context.emit('cellHover', { date: dateValue, $cell: $dateCell });\n      });\n\n      // overrides jquery UI handler that unhighlights a cell when the mouse leaves it\n      element.on('mouseout', 'tbody td a', () => {\n        setDatePickerCellColors();\n      });\n\n      // call scope.cellHoverLeave() when mouse leaves table body (can't do event on tbody, for\n      // some reason that fails, so we do two events, one on the table & one on thead)\n      element\n        .on('mouseleave', 'table', () => context.emit('cellHoverLeave'))\n        .on('mouseenter', 'thead', () => context.emit('cellHoverLeave'));\n\n      // make sure whitespace is clickable when the period makes it appropriate\n      element.on('click', 'tbody td.ui-datepicker-other-month', handleOtherMonthClick);\n\n      // NOTE: using a selector w/ .on() doesn't seem to work for some reason...\n      element.on('click', (e) => {\n        e.preventDefault();\n\n        const $target = $(e.target).closest('a');\n        if (!$target.is('.ui-datepicker-next')\n          && !$target.is('.ui-datepicker-prev')\n        ) {\n          return;\n        }\n\n        onCalendarViewChange();\n      });\n\n      // when a cell is clicked, invoke the onDateSelected function. this, in conjunction\n      // with onJqueryUiRenderedPicker(), overrides the date picker's click behavior.\n      element.on('click', 'td[data-month]', (event) => {\n        const $cell = $(event.target).closest('td') as JQuery;\n        const month = parseInt($cell.attr('data-month')!, 10);\n        const year = parseInt($cell.attr('data-year')!, 10);\n        const day = parseInt($cell.children('a,span').text(), 10);\n        context.emit('dateSelect', { date: new Date(year, month, day) });\n      });\n\n      const renderPostProcessed = stepMonthsChanged();\n\n      viewDateChanged();\n      enableDisableMonthDropdown();\n\n      if (!renderPostProcessed) {\n        onJqueryUiRenderedPicker();\n      }\n\n      setDatePickerCellColors();\n    });\n\n    return {\n      root,\n    };\n  },\n});\n</script>\n","\nimport {\n  defineComponent,\n  ref,\n  watch,\n  onMounted,\n} from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport { parseDate } from '../Periods';\n\nconst DEFAULT_STEP_MONTHS = 1;\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    selectedDateStart: Date,\n    selectedDateEnd: Date,\n    highlightedDateStart: Date,\n    highlightedDateEnd: Date,\n    viewDate: [String, Date],\n    stepMonths: Number,\n    disableMonthDropdown: Boolean,\n    options: Object,\n  },\n  emits: ['cellHover', 'cellHoverLeave', 'dateSelect'],\n  setup(props, context) {\n    const root = ref<HTMLElement|null>(null);\n\n    function setDateCellColor($dateCell: JQuery, dateValue: Date): void {\n      const $dateCellLink = $dateCell.children('a');\n\n      if (props.selectedDateStart\n        && props.selectedDateEnd\n        && dateValue >= props.selectedDateStart\n        && dateValue <= props.selectedDateEnd\n      ) {\n        $dateCell.addClass('ui-datepicker-current-period');\n      } else {\n        $dateCell.removeClass('ui-datepicker-current-period');\n      }\n\n      if (props.highlightedDateStart\n        && props.highlightedDateEnd\n        && dateValue >= props.highlightedDateStart\n        && dateValue <= props.highlightedDateEnd\n      ) {\n        // other-month cells don't have links, so the <td> must have the ui-state-hover class\n        const elementToAddClassTo = $dateCellLink.length ? $dateCellLink : $dateCell;\n        elementToAddClassTo.addClass('ui-state-hover');\n      } else {\n        $dateCell.removeClass('ui-state-hover');\n        $dateCellLink.removeClass('ui-state-hover');\n      }\n    }\n\n    function getCellDate($dateCell: JQuery, month: number, year: number): Date {\n      if ($dateCell.hasClass('ui-datepicker-other-month')) {\n        return getOtherMonthDate($dateCell, month, year); // eslint-disable-line\n      }\n\n      const day = parseInt($dateCell.children('a,span').text(), 10);\n\n      return new Date(year, month, day);\n    }\n\n    function getOtherMonthDate($dateCell: JQuery, month: number, year: number) {\n      let date;\n\n      const $row = $dateCell.parent();\n      const $rowCells = $row.children('td');\n\n      // if in the first row, the date cell is before the current month\n      if ($row.is(':first-child')) {\n        const $firstDateInMonth = $row.children('td:not(.ui-datepicker-other-month)').first();\n\n        date = getCellDate($firstDateInMonth, month, year);\n        date.setDate($rowCells.index($dateCell) - $rowCells.index($firstDateInMonth) + 1);\n        return date;\n      }\n\n      // the date cell is after the current month\n      const $lastDateInMonth = $row.children('td:not(.ui-datepicker-other-month)').last();\n\n      date = getCellDate($lastDateInMonth, month, year);\n      date.setDate(date.getDate() + $rowCells.index($dateCell) - $rowCells.index($lastDateInMonth));\n      return date;\n    }\n\n    function getMonthYearDisplayed(): number[] {\n      const element = $(root.value!) as JQuery;\n\n      const $firstCellWithMonth = element.find('td[data-month]');\n      const month = parseInt($firstCellWithMonth.attr('data-month')!, 10);\n      const year = parseInt($firstCellWithMonth.attr('data-year')!, 10);\n\n      return [month, year];\n    }\n\n    function setDatePickerCellColors() {\n      const element = $(root.value!);\n\n      const $calendarTable = element.find('.ui-datepicker-calendar');\n\n      const monthYear = getMonthYearDisplayed();\n\n      // highlight the rest of the cells by first getting the date for the first cell\n      // in the calendar, then just incrementing by one for the rest of the cells.\n      const $cells = $calendarTable.find('td');\n      const $firstDateCell = $cells.first();\n      const currentDate = getCellDate($firstDateCell, monthYear[0], monthYear[1]);\n\n      $cells.each(function setCellColor() {\n        setDateCellColor($(this), currentDate);\n\n        currentDate.setDate(currentDate.getDate() + 1);\n      });\n    }\n\n    function viewDateChanged(): boolean {\n      if (!props.viewDate) {\n        return false;\n      }\n\n      let date: Date;\n      if (typeof props.viewDate === 'string') {\n        try {\n          date = parseDate(props.viewDate);\n        } catch (e) {\n          return false;\n        }\n      } else {\n        date = props.viewDate as Date;\n      }\n\n      const element = $(root.value!);\n\n      // only change the datepicker date if the date is outside of the current month/year.\n      // this avoids a re-render in other cases.\n      const monthYear = getMonthYearDisplayed();\n      if (monthYear[0] !== date.getMonth() || monthYear[1] !== date.getFullYear()) {\n        element.datepicker('setDate', date);\n        return true;\n      }\n\n      return false;\n    }\n\n    // remove the ui-state-active class & click handlers for every cell. we bypass\n    // the datepicker's date selection logic for smoother browser rendering.\n    function onJqueryUiRenderedPicker(): void {\n      const element = $(root.value!);\n\n      element.find('td[data-event]').off('click');\n      element.find('.ui-state-active').removeClass('ui-state-active');\n      element.find('.ui-datepicker-current-day').removeClass('ui-datepicker-current-day');\n\n      // add href to left/right nav in calendar so they can be accessed via keyboard\n      element.find('.ui-datepicker-prev,.ui-datepicker-next').attr('href', '');\n    }\n\n    function stepMonthsChanged(): boolean {\n      const element = $(root.value!);\n\n      const stepMonths = props.stepMonths || DEFAULT_STEP_MONTHS;\n      if (element.datepicker('option', 'stepMonths') === stepMonths) {\n        return false;\n      }\n\n      // setting stepMonths will change the month in view back to the selected date. to avoid\n      // we set the selected date to the month in view.\n      const currentMonth = $('.ui-datepicker-month', element).val() as number;\n      const currentYear = $('.ui-datepicker-year', element).val() as number;\n\n      element\n        .datepicker('option', 'stepMonths', stepMonths)\n        .datepicker('setDate', new Date(currentYear, currentMonth));\n\n      onJqueryUiRenderedPicker();\n\n      return true;\n    }\n\n    function enableDisableMonthDropdown(): void {\n      const element = $(root.value!);\n      const monthPicker = element.find('.ui-datepicker-month')[0] as HTMLInputElement;\n      if (monthPicker) {\n        monthPicker.disabled = props.disableMonthDropdown;\n      }\n    }\n\n    function handleOtherMonthClick(this: HTMLElement) {\n      if (!$(this).hasClass('ui-state-hover')) {\n        return;\n      }\n\n      const $row = $(this).parent();\n      const $tbody = $row.parent();\n\n      if ($row.is(':first-child')) {\n        // click on first of the month\n        $tbody.find('a').first().click();\n      } else {\n        // click on last of month\n        $tbody.find('a').last().click();\n      }\n    }\n\n    function onCalendarViewChange() {\n      // clicking left/right re-enables the month dropdown, so we disable it again\n      enableDisableMonthDropdown();\n\n      setDatePickerCellColors();\n    }\n\n    // on a prop change (NOTE: we can't watch just `props`, since then newProps and oldProps will\n    // have the same values (since it is a proxy object). Using a copy doesn't quite work, the\n    // object it returns will always be different, BUT, since we check what changes it works\n    // for our purposes. The only downside is that it runs on every tick basically, but since\n    // that is within the context of the date picker component, it's bearable.\n    watch(() => ({ ...props }), (newProps: typeof props, oldProps: typeof props) => {\n      let redraw = false;\n\n      [\n        (x: typeof props): Date|undefined => x.selectedDateStart,\n        (x: typeof props): Date|undefined => x.selectedDateEnd,\n        (x: typeof props): Date|undefined => x.highlightedDateStart,\n        (x: typeof props): Date|undefined => x.highlightedDateEnd,\n      ].forEach((selector) => {\n        if (redraw) {\n          return;\n        }\n\n        const newProp = selector(newProps);\n        const oldProp = selector(oldProps);\n\n        if (!newProp && oldProp) {\n          redraw = true;\n        }\n\n        if (newProp && !oldProp) {\n          redraw = true;\n        }\n\n        if (newProp\n          && oldProp\n          && newProp.getTime() !== oldProp.getTime()\n        ) {\n          redraw = true;\n        }\n      });\n\n      if (newProps.viewDate !== oldProps.viewDate && viewDateChanged()) {\n        redraw = true;\n      }\n\n      if (newProps.stepMonths !== oldProps.stepMonths) {\n        stepMonthsChanged();\n      }\n\n      if (newProps.disableMonthDropdown !== oldProps.disableMonthDropdown) {\n        enableDisableMonthDropdown();\n      }\n\n      // redraw when selected/highlighted dates change\n      if (redraw) {\n        setDatePickerCellColors();\n      }\n    });\n\n    onMounted(() => {\n      const element = $(root.value!);\n\n      const customOptions = props.options || {};\n      const datePickerOptions = {\n        ...Matomo.getBaseDatePickerOptions(),\n        ...customOptions,\n        onChangeMonthYear: () => {\n          // datepicker renders the HTML after this hook is called, so we use setTimeout\n          // to run some code after the render.\n          setTimeout(() => {\n            onJqueryUiRenderedPicker();\n          });\n        },\n      };\n      element.datepicker(datePickerOptions);\n\n      element.on('mouseover', 'tbody td a', (event) => {\n        // this event is triggered when a user clicks a date as well. in that case,\n        // the originalEvent is null. we don't need to redraw again for that, so\n        // we ignore events like that.\n        if (event.originalEvent) {\n          setDatePickerCellColors();\n        }\n      });\n\n      // on hover cell, execute scope.cellHover()\n      element.on('mouseenter', 'tbody td', function onMouseEnter() {\n        const monthYear = getMonthYearDisplayed();\n\n        const $dateCell = $(this);\n        const dateValue = getCellDate($dateCell, monthYear[0], monthYear[1]);\n        context.emit('cellHover', { date: dateValue, $cell: $dateCell });\n      });\n\n      // overrides jquery UI handler that unhighlights a cell when the mouse leaves it\n      element.on('mouseout', 'tbody td a', () => {\n        setDatePickerCellColors();\n      });\n\n      // call scope.cellHoverLeave() when mouse leaves table body (can't do event on tbody, for\n      // some reason that fails, so we do two events, one on the table & one on thead)\n      element\n        .on('mouseleave', 'table', () => context.emit('cellHoverLeave'))\n        .on('mouseenter', 'thead', () => context.emit('cellHoverLeave'));\n\n      // make sure whitespace is clickable when the period makes it appropriate\n      element.on('click', 'tbody td.ui-datepicker-other-month', handleOtherMonthClick);\n\n      // NOTE: using a selector w/ .on() doesn't seem to work for some reason...\n      element.on('click', (e) => {\n        e.preventDefault();\n\n        const $target = $(e.target).closest('a');\n        if (!$target.is('.ui-datepicker-next')\n          && !$target.is('.ui-datepicker-prev')\n        ) {\n          return;\n        }\n\n        onCalendarViewChange();\n      });\n\n      // when a cell is clicked, invoke the onDateSelected function. this, in conjunction\n      // with onJqueryUiRenderedPicker(), overrides the date picker's click behavior.\n      element.on('click', 'td[data-month]', (event) => {\n        const $cell = $(event.target).closest('td') as JQuery;\n        const month = parseInt($cell.attr('data-month')!, 10);\n        const year = parseInt($cell.attr('data-year')!, 10);\n        const day = parseInt($cell.children('a,span').text(), 10);\n        context.emit('dateSelect', { date: new Date(year, month, day) });\n      });\n\n      const renderPostProcessed = stepMonthsChanged();\n\n      viewDateChanged();\n      enableDisableMonthDropdown();\n\n      if (!renderPostProcessed) {\n        onJqueryUiRenderedPicker();\n      }\n\n      setDatePickerCellColors();\n    });\n\n    return {\n      root,\n    };\n  },\n});\n","import { render } from \"./DatePicker.vue?vue&type=template&id=589729fc\"\nimport script from \"./DatePicker.vue?vue&type=script&lang=ts\"\nexport * from \"./DatePicker.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"dateRangePicker\">\n    <div id=\"calendarRangeFrom\">\n      <h6>\n        {{ translate('General_DateRangeFrom') }}\n        <input\n          type=\"text\"\n          id=\"inputCalendarFrom\"\n          name=\"inputCalendarFrom\"\n          class=\"browser-default\"\n          v-model=\"startDateText\"\n          @keydown=\"onRangeInputChanged('from', $event)\"\n          @keyup=\"handleEnterPress($event)\"\n        />\n      </h6>\n      <DatePicker\n        id=\"calendarFrom\"\n        :view-date=\"startDate\"\n        :selected-date-start=\"fromPickerSelectedDates[0]\"\n        :selected-date-end=\"fromPickerSelectedDates[1]\"\n        :highlighted-date-start=\"fromPickerHighlightedDates[0]\"\n        :highlighted-date-end=\"fromPickerHighlightedDates[1]\"\n        @date-select=\"setStartRangeDate($event.date)\"\n        @cell-hover=\"fromPickerHighlightedDates = getNewHighlightedDates($event.date, $event.$cell)\"\n        @cell-hover-leave=\"fromPickerHighlightedDates = [null, null]\"\n      >\n      </DatePicker>\n    </div>\n    <div id=\"calendarRangeTo\">\n      <h6>\n        {{ translate('General_DateRangeTo') }}\n        <input\n          type=\"text\"\n          id=\"inputCalendarTo\"\n          name=\"inputCalendarTo\"\n          class=\"browser-default\"\n          v-model=\"endDateText\"\n          @keydown=\"onRangeInputChanged('to', $event)\"\n          @keyup=\"handleEnterPress($event)\"\n        />\n      </h6>\n      <DatePicker\n        id=\"calendarTo\"\n        :view-date=\"endDate\"\n        :selected-date-start=\"toPickerSelectedDates[0]\"\n        :selected-date-end=\"toPickerSelectedDates[1]\"\n        :highlighted-date-start=\"toPickerHighlightedDates[0]\"\n        :highlighted-date-end=\"toPickerHighlightedDates[1]\"\n        @date-select=\"setEndRangeDate($event.date)\"\n        @cell-hover=\"toPickerHighlightedDates = getNewHighlightedDates($event.date, $event.$cell)\"\n        @cell-hover-leave=\"toPickerHighlightedDates = [null, null]\"\n      >\n      </DatePicker>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport DatePicker from '../DatePicker/DatePicker.vue';\nimport { parseDate, format } from '../Periods/utilities';\nimport ChangeEvent = JQuery.ChangeEvent;\n\nconst DATE_FORMAT = 'YYYY-MM-DD';\n\ninterface DateRangePickerState {\n  fromPickerSelectedDates: (Date|null)[];\n  toPickerSelectedDates: (Date|null)[];\n  fromPickerHighlightedDates: (Date|null)[];\n  toPickerHighlightedDates: (Date|null)[];\n  startDateText?: string;\n  endDateText?: string;\n  startDateInvalid: boolean;\n  endDateInvalid: boolean;\n}\n\nexport default defineComponent({\n  props: {\n    startDate: String,\n    endDate: String,\n  },\n  components: {\n    DatePicker,\n  },\n  data(): DateRangePickerState {\n    let startDate = null;\n    try {\n      if (this.startDate) {\n        startDate = parseDate(this.startDate);\n      }\n    } catch (e) {\n      // ignore\n    }\n\n    let endDate = null;\n    try {\n      if (this.endDate) {\n        endDate = parseDate(this.endDate);\n      }\n    } catch (e) {\n      // ignore\n    }\n\n    return {\n      fromPickerSelectedDates: [startDate, startDate],\n      toPickerSelectedDates: [endDate, endDate],\n      fromPickerHighlightedDates: [null, null],\n      toPickerHighlightedDates: [null, null],\n      startDateText: this.startDate,\n      endDateText: this.endDate,\n      startDateInvalid: false,\n      endDateInvalid: false,\n    };\n  },\n  emits: ['rangeChange', 'submit'],\n  watch: {\n    startDate() {\n      this.startDateText = this.startDate;\n      this.setStartRangeDateFromStr(this.startDate);\n    },\n    endDate() {\n      this.endDateText = this.endDate;\n      this.setEndRangeDateFromStr(this.endDate);\n    },\n  },\n  mounted() {\n    this.rangeChanged(); // emit with initial range pair\n  },\n  methods: {\n    setStartRangeDate(date: Date) {\n      this.fromPickerSelectedDates = [date, date];\n\n      this.rangeChanged();\n    },\n    setEndRangeDate(date: Date) {\n      this.toPickerSelectedDates = [date, date];\n\n      this.rangeChanged();\n    },\n    onRangeInputChanged(source: string, event: ChangeEvent) {\n      setTimeout(() => {\n        if (source === 'from') {\n          this.setStartRangeDateFromStr(event.target.value);\n        } else {\n          this.setEndRangeDateFromStr(event.target.value);\n        }\n      });\n    },\n    getNewHighlightedDates(date: Date, $cell: JQuery) {\n      if ($cell.hasClass('ui-datepicker-unselectable')) {\n        return null;\n      }\n\n      return [date, date];\n    },\n    handleEnterPress($event: KeyboardEvent) {\n      if ($event.keyCode !== 13) {\n        return;\n      }\n\n      this.$emit('submit', {\n        start: this.startDate,\n        end: this.endDate,\n      });\n    },\n    setStartRangeDateFromStr(dateStr?: string) {\n      this.startDateInvalid = true;\n\n      let startDateParsed: Date|null = null;\n      try {\n        if (dateStr && dateStr.length === DATE_FORMAT.length) {\n          startDateParsed = parseDate(dateStr);\n        }\n      } catch (e) {\n        // ignore\n      }\n\n      if (startDateParsed) {\n        this.fromPickerSelectedDates = [startDateParsed, startDateParsed];\n        this.startDateInvalid = false;\n\n        this.rangeChanged();\n      }\n    },\n    setEndRangeDateFromStr(dateStr?: string) {\n      this.endDateInvalid = true;\n\n      let endDateParsed: Date|null = null;\n      try {\n        if (dateStr && dateStr.length === DATE_FORMAT.length) {\n          endDateParsed = parseDate(dateStr);\n        }\n      } catch (e) {\n        // ignore\n      }\n\n      if (endDateParsed) {\n        this.toPickerSelectedDates = [endDateParsed, endDateParsed];\n        this.endDateInvalid = false;\n\n        this.rangeChanged();\n      }\n    },\n    rangeChanged() {\n      this.$emit('rangeChange', {\n        start: this.fromPickerSelectedDates[0] ? format(this.fromPickerSelectedDates[0]) : null,\n        end: this.toPickerSelectedDates[0] ? format(this.toPickerSelectedDates[0]) : null,\n      });\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport DatePicker from '../DatePicker/DatePicker.vue';\nimport { parseDate, format } from '../Periods/utilities';\nimport ChangeEvent = JQuery.ChangeEvent;\n\nconst DATE_FORMAT = 'YYYY-MM-DD';\n\ninterface DateRangePickerState {\n  fromPickerSelectedDates: (Date|null)[];\n  toPickerSelectedDates: (Date|null)[];\n  fromPickerHighlightedDates: (Date|null)[];\n  toPickerHighlightedDates: (Date|null)[];\n  startDateText?: string;\n  endDateText?: string;\n  startDateInvalid: boolean;\n  endDateInvalid: boolean;\n}\n\nexport default defineComponent({\n  props: {\n    startDate: String,\n    endDate: String,\n  },\n  components: {\n    DatePicker,\n  },\n  data(): DateRangePickerState {\n    let startDate = null;\n    try {\n      if (this.startDate) {\n        startDate = parseDate(this.startDate);\n      }\n    } catch (e) {\n      // ignore\n    }\n\n    let endDate = null;\n    try {\n      if (this.endDate) {\n        endDate = parseDate(this.endDate);\n      }\n    } catch (e) {\n      // ignore\n    }\n\n    return {\n      fromPickerSelectedDates: [startDate, startDate],\n      toPickerSelectedDates: [endDate, endDate],\n      fromPickerHighlightedDates: [null, null],\n      toPickerHighlightedDates: [null, null],\n      startDateText: this.startDate,\n      endDateText: this.endDate,\n      startDateInvalid: false,\n      endDateInvalid: false,\n    };\n  },\n  emits: ['rangeChange', 'submit'],\n  watch: {\n    startDate() {\n      this.startDateText = this.startDate;\n      this.setStartRangeDateFromStr(this.startDate);\n    },\n    endDate() {\n      this.endDateText = this.endDate;\n      this.setEndRangeDateFromStr(this.endDate);\n    },\n  },\n  mounted() {\n    this.rangeChanged(); // emit with initial range pair\n  },\n  methods: {\n    setStartRangeDate(date: Date) {\n      this.fromPickerSelectedDates = [date, date];\n\n      this.rangeChanged();\n    },\n    setEndRangeDate(date: Date) {\n      this.toPickerSelectedDates = [date, date];\n\n      this.rangeChanged();\n    },\n    onRangeInputChanged(source: string, event: ChangeEvent) {\n      setTimeout(() => {\n        if (source === 'from') {\n          this.setStartRangeDateFromStr(event.target.value);\n        } else {\n          this.setEndRangeDateFromStr(event.target.value);\n        }\n      });\n    },\n    getNewHighlightedDates(date: Date, $cell: JQuery) {\n      if ($cell.hasClass('ui-datepicker-unselectable')) {\n        return null;\n      }\n\n      return [date, date];\n    },\n    handleEnterPress($event: KeyboardEvent) {\n      if ($event.keyCode !== 13) {\n        return;\n      }\n\n      this.$emit('submit', {\n        start: this.startDate,\n        end: this.endDate,\n      });\n    },\n    setStartRangeDateFromStr(dateStr?: string) {\n      this.startDateInvalid = true;\n\n      let startDateParsed: Date|null = null;\n      try {\n        if (dateStr && dateStr.length === DATE_FORMAT.length) {\n          startDateParsed = parseDate(dateStr);\n        }\n      } catch (e) {\n        // ignore\n      }\n\n      if (startDateParsed) {\n        this.fromPickerSelectedDates = [startDateParsed, startDateParsed];\n        this.startDateInvalid = false;\n\n        this.rangeChanged();\n      }\n    },\n    setEndRangeDateFromStr(dateStr?: string) {\n      this.endDateInvalid = true;\n\n      let endDateParsed: Date|null = null;\n      try {\n        if (dateStr && dateStr.length === DATE_FORMAT.length) {\n          endDateParsed = parseDate(dateStr);\n        }\n      } catch (e) {\n        // ignore\n      }\n\n      if (endDateParsed) {\n        this.toPickerSelectedDates = [endDateParsed, endDateParsed];\n        this.endDateInvalid = false;\n\n        this.rangeChanged();\n      }\n    },\n    rangeChanged() {\n      this.$emit('rangeChange', {\n        start: this.fromPickerSelectedDates[0] ? format(this.fromPickerSelectedDates[0]) : null,\n        end: this.toPickerSelectedDates[0] ? format(this.toPickerSelectedDates[0]) : null,\n      });\n    },\n  },\n});\n","import { render } from \"./DateRangePicker.vue?vue&type=template&id=67755d44\"\nimport script from \"./DateRangePicker.vue?vue&type=script&lang=ts\"\nexport * from \"./DateRangePicker.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <DatePicker\n    :selected-date-start=\"selectedDates[0]\"\n    :selected-date-end=\"selectedDates[1]\"\n    :highlighted-date-start=\"highlightedDates[0]\"\n    :highlighted-date-end=\"highlightedDates[1]\"\n    :view-date=\"viewDate\"\n    :step-months=\"period === 'year' ? 12 : 1\"\n    :disable-month-dropdown=\"period === 'year'\"\n    @cell-hover=\"onHoverNormalCell($event.date, $event.$cell)\"\n    @cell-hover-leave=\"onHoverLeaveNormalCells()\"\n    @date-select=\"onDateSelected($event.date)\"\n  >\n  </DatePicker>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, watch, ref } from 'vue';\nimport DatePicker from '../DatePicker/DatePicker.vue';\nimport Matomo from '../Matomo/Matomo';\nimport { Periods, parseDate } from '../Periods';\n\nconst piwikMinDate = new Date(Matomo.minDateYear, Matomo.minDateMonth - 1, Matomo.minDateDay);\nconst piwikMaxDate = new Date(Matomo.maxDateYear, Matomo.maxDateMonth - 1, Matomo.maxDateDay);\n\nexport default defineComponent({\n  props: {\n    period: {\n      type: String,\n      required: true,\n    },\n    date: [String, Date],\n  },\n  components: {\n    DatePicker,\n  },\n  emits: ['select'],\n  setup(props, context) {\n    const viewDate = ref<string|Date|undefined|null>(props.date);\n    const selectedDates = ref<(Date|null)[]>([null, null]);\n    const highlightedDates = ref<(Date|null)[]>([null, null]);\n\n    function getBoundedDateRange(date: string|Date) {\n      const dates = Periods.get(props.period).parse(date).getDateRange();\n\n      // make sure highlighted date range is within min/max date range\n      dates[0] = piwikMinDate < dates[0] ? dates[0] : piwikMinDate;\n      dates[1] = piwikMaxDate > dates[1] ? dates[1] : piwikMaxDate;\n\n      return dates;\n    }\n\n    function onHoverNormalCell(cellDate: Date, $cell: JQuery) {\n      const isOutOfMinMaxDateRange = cellDate < piwikMinDate || cellDate > piwikMaxDate;\n\n      // don't highlight anything if the period is month or day, and we're hovering over calendar\n      // whitespace. since there are no dates, it's doesn't make sense what you're selecting.\n      const shouldNotHighlightFromWhitespace = $cell.hasClass('ui-datepicker-other-month')\n        && (props.period === 'month' || props.period === 'day');\n\n      if (isOutOfMinMaxDateRange\n        || shouldNotHighlightFromWhitespace\n      ) {\n        highlightedDates.value = [null, null];\n        return;\n      }\n\n      highlightedDates.value = getBoundedDateRange(cellDate);\n    }\n\n    function onHoverLeaveNormalCells() {\n      highlightedDates.value = [null, null];\n    }\n\n    function onDateSelected(date: Date) {\n      context.emit('select', { date });\n    }\n\n    function onChanges() {\n      if (!props.period || !props.date) {\n        selectedDates.value = [null, null];\n        viewDate.value = null;\n        return;\n      }\n\n      selectedDates.value = getBoundedDateRange(props.date);\n      viewDate.value = parseDate(props.date);\n    }\n\n    watch(props, onChanges);\n\n    onChanges();\n\n    return {\n      selectedDates,\n      highlightedDates,\n      viewDate,\n      onHoverNormalCell,\n      onHoverLeaveNormalCells,\n      onDateSelected,\n    };\n  },\n});\n</script>\n","\nimport { defineComponent, watch, ref } from 'vue';\nimport DatePicker from '../DatePicker/DatePicker.vue';\nimport Matomo from '../Matomo/Matomo';\nimport { Periods, parseDate } from '../Periods';\n\nconst piwikMinDate = new Date(Matomo.minDateYear, Matomo.minDateMonth - 1, Matomo.minDateDay);\nconst piwikMaxDate = new Date(Matomo.maxDateYear, Matomo.maxDateMonth - 1, Matomo.maxDateDay);\n\nexport default defineComponent({\n  props: {\n    period: {\n      type: String,\n      required: true,\n    },\n    date: [String, Date],\n  },\n  components: {\n    DatePicker,\n  },\n  emits: ['select'],\n  setup(props, context) {\n    const viewDate = ref<string|Date|undefined|null>(props.date);\n    const selectedDates = ref<(Date|null)[]>([null, null]);\n    const highlightedDates = ref<(Date|null)[]>([null, null]);\n\n    function getBoundedDateRange(date: string|Date) {\n      const dates = Periods.get(props.period).parse(date).getDateRange();\n\n      // make sure highlighted date range is within min/max date range\n      dates[0] = piwikMinDate < dates[0] ? dates[0] : piwikMinDate;\n      dates[1] = piwikMaxDate > dates[1] ? dates[1] : piwikMaxDate;\n\n      return dates;\n    }\n\n    function onHoverNormalCell(cellDate: Date, $cell: JQuery) {\n      const isOutOfMinMaxDateRange = cellDate < piwikMinDate || cellDate > piwikMaxDate;\n\n      // don't highlight anything if the period is month or day, and we're hovering over calendar\n      // whitespace. since there are no dates, it's doesn't make sense what you're selecting.\n      const shouldNotHighlightFromWhitespace = $cell.hasClass('ui-datepicker-other-month')\n        && (props.period === 'month' || props.period === 'day');\n\n      if (isOutOfMinMaxDateRange\n        || shouldNotHighlightFromWhitespace\n      ) {\n        highlightedDates.value = [null, null];\n        return;\n      }\n\n      highlightedDates.value = getBoundedDateRange(cellDate);\n    }\n\n    function onHoverLeaveNormalCells() {\n      highlightedDates.value = [null, null];\n    }\n\n    function onDateSelected(date: Date) {\n      context.emit('select', { date });\n    }\n\n    function onChanges() {\n      if (!props.period || !props.date) {\n        selectedDates.value = [null, null];\n        viewDate.value = null;\n        return;\n      }\n\n      selectedDates.value = getBoundedDateRange(props.date);\n      viewDate.value = parseDate(props.date);\n    }\n\n    watch(props, onChanges);\n\n    onChanges();\n\n    return {\n      selectedDates,\n      highlightedDates,\n      viewDate,\n      onHoverNormalCell,\n      onHoverLeaveNormalCells,\n      onDateSelected,\n    };\n  },\n});\n","import { render } from \"./PeriodDatePicker.vue?vue&type=template&id=6d1fa14c\"\nimport script from \"./PeriodDatePicker.vue?vue&type=script&lang=ts\"\nexport * from \"./PeriodDatePicker.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <transition\n    :name=\"type === 'toast' ? 'slow-fade-out' : undefined\"\n    @after-leave=\"toastClosed()\"\n  >\n    <div v-if=\"!deleted\">\n      <transition :name=\"type === 'toast' ? 'toast-slide-up' : undefined\" appear>\n        <div>\n          <transition :name=\"animate ? 'fade-in' : undefined\" appear>\n            <div\n              class=\"notification system\"\n              :class=\"cssClasses\"\n              :style=\"style\"\n              ref=\"root\"\n              :data-notification-instance-id=\"notificationInstanceId\"\n            >\n              <button\n                type=\"button\"\n                class=\"close\"\n                data-dismiss=\"alert\"\n                v-if=\"canClose\"\n                v-on:click=\"closeNotification($event)\"\n              >\n                &times;\n              </button>\n              <strong v-if=\"title\">{{ title }}</strong>\n              <!-- ng-transclude causes directive child elements to be added here -->\n              <div class=\"notification-body\">\n                <div v-if=\"message\" v-html=\"$sanitize(message)\"/>\n                <div v-if=\"!message\">\n                  <slot />\n                </div>\n              </div>\n            </div>\n          </transition>\n        </div>\n      </transition>\n    </div>\n  </transition>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, nextTick } from 'vue';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    notificationId: String,\n    // NOTE: notificationId refers to server side ID for notifications stored in the session.\n    // this ID is just so it can be selected outside of this component (just for scrolling).\n    notificationInstanceId: String,\n    title: String,\n    context: String,\n    type: String,\n    noclear: Boolean,\n    toastLength: {\n      type: Number,\n      default: 12 * 1000,\n    },\n    style: [String, Object],\n    animate: Boolean,\n    message: String,\n    cssClass: String,\n  },\n  computed: {\n    cssClasses() {\n      const result: Record<string, boolean> = {};\n      if (this.context) {\n        result[`notification-${this.context}`] = true;\n      }\n      if (this.cssClass) {\n        result[this.cssClass] = true;\n      }\n      return result;\n    },\n    canClose() {\n      if (this.type === 'persistent') {\n        // otherwise it is never possible to dismiss the notification\n        return true;\n      }\n\n      return !this.noclear;\n    },\n  },\n  emits: ['closed'],\n  data() {\n    return {\n      deleted: false,\n    };\n  },\n  mounted() {\n    const addToastEvent = () => {\n      setTimeout(() => {\n        this.deleted = true;\n      }, this.toastLength);\n    };\n\n    if (this.type === 'toast') {\n      addToastEvent();\n    }\n\n    if (this.style) {\n      $(this.$refs.root as HTMLElement).css(this.style as string);\n    }\n  },\n  methods: {\n    toastClosed() {\n      nextTick(() => {\n        this.$emit('closed');\n      });\n    },\n    closeNotification(event: MouseEvent) {\n      if (this.canClose && event && event.target) {\n        this.deleted = true;\n\n        nextTick(() => {\n          this.$emit('closed');\n        });\n      }\n\n      this.markNotificationAsRead();\n    },\n    markNotificationAsRead() {\n      if (!this.notificationId) {\n        return;\n      }\n      AjaxHelper.post({ // GET params\n        module: 'CoreHome',\n        action: 'markNotificationAsRead',\n      }, { // POST params\n        notificationId: this.notificationId,\n      },\n      { withTokenInUrl: true });\n    },\n  },\n});\n</script>\n","\nimport { defineComponent, nextTick } from 'vue';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    notificationId: String,\n    // NOTE: notificationId refers to server side ID for notifications stored in the session.\n    // this ID is just so it can be selected outside of this component (just for scrolling).\n    notificationInstanceId: String,\n    title: String,\n    context: String,\n    type: String,\n    noclear: Boolean,\n    toastLength: {\n      type: Number,\n      default: 12 * 1000,\n    },\n    style: [String, Object],\n    animate: Boolean,\n    message: String,\n    cssClass: String,\n  },\n  computed: {\n    cssClasses() {\n      const result: Record<string, boolean> = {};\n      if (this.context) {\n        result[`notification-${this.context}`] = true;\n      }\n      if (this.cssClass) {\n        result[this.cssClass] = true;\n      }\n      return result;\n    },\n    canClose() {\n      if (this.type === 'persistent') {\n        // otherwise it is never possible to dismiss the notification\n        return true;\n      }\n\n      return !this.noclear;\n    },\n  },\n  emits: ['closed'],\n  data() {\n    return {\n      deleted: false,\n    };\n  },\n  mounted() {\n    const addToastEvent = () => {\n      setTimeout(() => {\n        this.deleted = true;\n      }, this.toastLength);\n    };\n\n    if (this.type === 'toast') {\n      addToastEvent();\n    }\n\n    if (this.style) {\n      $(this.$refs.root as HTMLElement).css(this.style as string);\n    }\n  },\n  methods: {\n    toastClosed() {\n      nextTick(() => {\n        this.$emit('closed');\n      });\n    },\n    closeNotification(event: MouseEvent) {\n      if (this.canClose && event && event.target) {\n        this.deleted = true;\n\n        nextTick(() => {\n          this.$emit('closed');\n        });\n      }\n\n      this.markNotificationAsRead();\n    },\n    markNotificationAsRead() {\n      if (!this.notificationId) {\n        return;\n      }\n      AjaxHelper.post({ // GET params\n        module: 'CoreHome',\n        action: 'markNotificationAsRead',\n      }, { // POST params\n        notificationId: this.notificationId,\n      },\n      { withTokenInUrl: true });\n    },\n  },\n});\n","import { render } from \"./Notification.vue?vue&type=template&id=897c6e1a\"\nimport script from \"./Notification.vue?vue&type=script&lang=ts\"\nexport * from \"./Notification.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"notification-group\">\n    <Notification\n      v-for=\"(notification, index) in notifications\"\n      :key=\"notification.id || `no-id-${index}`\"\n      :notification-id=\"notification.id\"\n      :title=\"notification.title\"\n      :context=\"notification.context\"\n      :type=\"notification.type\"\n      :noclear=\"notification.noclear\"\n      :toast-length=\"notification.toastLength\"\n      :style=\"notification.style\"\n      :animate=\"notification.animate\"\n      :message=\"notification.message\"\n      :notification-instance-id=\"notification.notificationInstanceId\"\n      :css-class=\"notification.class\"\n      @closed=\"removeNotification(notification.id)\"\n    >\n      <div v-html=\"$sanitize(notification.message)\"/>\n    </Notification>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport NotificationsStore from './Notifications.store';\nimport Notification from './Notification.vue';\n\nexport default defineComponent({\n  props: {\n    group: String,\n  },\n  components: {\n    Notification,\n  },\n  computed: {\n    notifications() {\n      return NotificationsStore.state.notifications.filter((n) => {\n        if (this.group) {\n          return this.group === n.group;\n        }\n\n        return !n.group;\n      });\n    },\n  },\n  methods: {\n    removeNotification(id: string) {\n      NotificationsStore.remove(id);\n    },\n  },\n});\n</script>\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport {\n  DeepReadonly,\n  reactive,\n  createVNode,\n  readonly,\n} from 'vue';\nimport NotificationComponent from './Notification.vue';\nimport Matomo from '../Matomo/Matomo';\nimport createVueApp from '../createVueApp';\nimport Notification from './Notification';\n\ninterface NotificationsData {\n  notifications: Notification[];\n}\n\nconst { $ } = window;\n\nclass NotificationsStore {\n  private privateState = reactive<NotificationsData>({\n    notifications: [],\n  });\n\n  private nextNotificationId = 0;\n\n  get state(): DeepReadonly<NotificationsData> {\n    return readonly(this.privateState);\n  }\n\n  appendNotification(notification: Notification): void {\n    this.checkMessage(notification.message);\n\n    // remove existing notification before adding\n    if (notification.id) {\n      this.remove(notification.id);\n    }\n    this.privateState.notifications.push(notification);\n  }\n\n  prependNotification(notification: Notification): void {\n    this.checkMessage(notification.message);\n\n    // remove existing notification before adding\n    if (notification.id) {\n      this.remove(notification.id);\n    }\n    this.privateState.notifications.unshift(notification);\n  }\n\n  /**\n   * Removes a previously shown notification having the given notification id.\n   */\n  remove(id: string): void {\n    this.privateState.notifications = this.privateState.notifications.filter(\n      (n) => n.id !== id,\n    );\n  }\n\n  parseNotificationDivs(): void {\n    const $notificationNodes = $('[data-role=\"notification\"]');\n\n    const notificationsToShow: Notification[] = [];\n    $notificationNodes.each((index: number, notificationNode: HTMLElement) => {\n      const $notificationNode = $(notificationNode);\n      const attributes = $notificationNode.data();\n      const message = $notificationNode.html();\n\n      if (message) {\n        notificationsToShow.push({ ...attributes, message, animate: false } as Notification);\n      }\n\n      $notificationNodes.remove();\n    });\n\n    notificationsToShow.forEach((n) => this.show(n));\n  }\n\n  clearTransientNotifications(): void {\n    this.privateState.notifications = this.privateState.notifications.filter(\n      (n) => n.type !== 'transient',\n    );\n  }\n\n  /**\n   * Creates a notification and shows it to the user.\n   */\n  show(notification: Notification): string {\n    this.checkMessage(notification.message);\n\n    let addMethod = notification.prepend ? this.prependNotification : this.appendNotification;\n\n    let notificationPosition: Notification['placeat'] = '#notificationContainer';\n    if (notification.placeat) {\n      notificationPosition = notification.placeat;\n    } else {\n      // If a modal is open, we want to make sure the error message is visible and therefore\n      // show it within the opened modal\n      const modalSelector = '.modal.open .modal-content';\n      const modal = document.querySelector(modalSelector);\n      if (modal) {\n        if (!modal.querySelector('#modalNotificationContainer')) {\n          $(modal).prepend('<div id=\"modalNotificationContainer\"/>');\n        }\n\n        notificationPosition = `${modalSelector} #modalNotificationContainer`;\n        addMethod = this.prependNotification;\n      }\n    }\n\n    const group = notification.group\n      || (notificationPosition ? notificationPosition.toString() : '');\n\n    this.initializeNotificationContainer(notificationPosition, group);\n\n    const notificationInstanceId = (this.nextNotificationId += 1).toString();\n\n    addMethod.call(this, {\n      ...notification,\n      noclear: !!notification.noclear,\n      group,\n      notificationId: notification.id,\n      notificationInstanceId,\n      type: notification.type || 'transient',\n    });\n\n    return notificationInstanceId;\n  }\n\n  scrollToNotification(notificationInstanceId: string) {\n    setTimeout(() => {\n      const element = document.querySelector(\n        `[data-notification-instance-id='${notificationInstanceId}']`,\n      ) as HTMLElement;\n      if (element) {\n        Matomo.helper.lazyScrollTo(element, 250);\n      }\n    });\n  }\n\n  /**\n   * Shows a notification at a certain point with a quick upwards animation.\n   */\n  toast(notification: Notification): void {\n    this.checkMessage(notification.message);\n\n    const $placeat = notification.placeat ? $(notification.placeat) : undefined;\n    if (!$placeat || !$placeat.length) {\n      throw new Error('A valid selector is required for the placeat option when using Notification.toast().');\n    }\n\n    const toastElement = document.createElement('div');\n    toastElement.style.position = 'absolute';\n    toastElement.style.top = `${$placeat.offset()!.top}px`;\n    toastElement.style.left = `${$placeat.offset()!.left}px`;\n    toastElement.style.zIndex = '1000';\n    document.body.appendChild(toastElement);\n\n    const app = createVueApp({\n      render: () => createVNode(NotificationComponent, {\n        ...notification,\n        notificationId: notification.id,\n        type: 'toast',\n        onClosed: () => {\n          app.unmount();\n        },\n      }),\n    });\n    app.mount(toastElement);\n  }\n\n  private initializeNotificationContainer(\n    notificationPosition: Notification['placeat'],\n    group: string,\n  ) {\n    if (!notificationPosition) {\n      return;\n    }\n\n    const $container = $(notificationPosition);\n    if ($container.children('.notification-group').length) {\n      return;\n    }\n\n    // avoiding a dependency cycle. won't need to do this when NotificationGroup's do not need\n    // to be dynamically initialized.\n    const NotificationGroup = (window as any).CoreHome.NotificationGroup; // eslint-disable-line\n\n    const app = createVueApp({\n      template: '<NotificationGroup :group=\"group\"></NotificationGroup>',\n      data: () => ({ group }),\n    });\n    app.component('NotificationGroup', NotificationGroup);\n    app.mount($container[0]);\n  }\n\n  private checkMessage(message: string) {\n    if (!message) {\n      throw new Error('No message given, cannot display notification');\n    }\n  }\n}\n\nconst instance = new NotificationsStore();\nexport default instance;\n\n// parse notifications on dom load\n$(() => instance.parseNotificationDivs());\n","\nimport { defineComponent } from 'vue';\nimport NotificationsStore from './Notifications.store';\nimport Notification from './Notification.vue';\n\nexport default defineComponent({\n  props: {\n    group: String,\n  },\n  components: {\n    Notification,\n  },\n  computed: {\n    notifications() {\n      return NotificationsStore.state.notifications.filter((n) => {\n        if (this.group) {\n          return this.group === n.group;\n        }\n\n        return !n.group;\n      });\n    },\n  },\n  methods: {\n    removeNotification(id: string) {\n      NotificationsStore.remove(id);\n    },\n  },\n});\n","import { render } from \"./NotificationGroup.vue?vue&type=template&id=672051da\"\nimport script from \"./NotificationGroup.vue?vue&type=script&lang=ts\"\nexport * from \"./NotificationGroup.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <a\n    class=\"item-help-icon\"\n    tabindex=\"5\"\n    href=\"javascript:\"\n    @click=\"showHelp\"\n  >\n    <span class=\"icon-help\"/>\n  </a>\n</template>\n<script lang=\"ts\">\n\nimport { defineComponent } from 'vue';\nimport { NotificationsStore } from '../Notification';\n\nconst REPORTING_HELP_NOTIFICATION_ID = 'reportingMenu-help';\n\nexport default defineComponent({\n  props: {\n    message: {\n      type: String,\n      required: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      currentName: '',\n    };\n  },\n  methods: {\n    showHelp() {\n      if (this.currentName !== '') {\n        NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n        this.currentName = '';\n        return;\n      }\n      NotificationsStore.show({\n        context: 'info',\n        id: REPORTING_HELP_NOTIFICATION_ID,\n        type: 'help',\n        noclear: true,\n        class: 'help-notification',\n        message: this.message,\n        placeat: '#notificationContainer',\n        prepend: true,\n      });\n      if (this.name !== '') {\n        this.currentName = this.name;\n      }\n    },\n  },\n});\n</script>\n","\n\nimport { defineComponent } from 'vue';\nimport { NotificationsStore } from '../Notification';\n\nconst REPORTING_HELP_NOTIFICATION_ID = 'reportingMenu-help';\n\nexport default defineComponent({\n  props: {\n    message: {\n      type: String,\n      required: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      currentName: '',\n    };\n  },\n  methods: {\n    showHelp() {\n      if (this.currentName !== '') {\n        NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n        this.currentName = '';\n        return;\n      }\n      NotificationsStore.show({\n        context: 'info',\n        id: REPORTING_HELP_NOTIFICATION_ID,\n        type: 'help',\n        noclear: true,\n        class: 'help-notification',\n        message: this.message,\n        placeat: '#notificationContainer',\n        prepend: true,\n      });\n      if (this.name !== '') {\n        this.currentName = this.name;\n      }\n    },\n  },\n});\n","import { render } from \"./ShowHelpLink.vue?vue&type=template&id=19288664\"\nimport script from \"./ShowHelpLink.vue?vue&type=script&lang=ts\"\nexport * from \"./ShowHelpLink.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport {\n  reactive,\n  computed,\n  readonly,\n  DeepReadonly,\n} from 'vue';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport Site from './Site';\n\ninterface SitesStoreState {\n  initialSites: DeepReadonly<Site[]>;\n  isInitialized: boolean;\n}\n\ninterface SitesStoreStateFiltered extends SitesStoreState {\n  excludedSites: number[];\n}\n\nclass SitesStore {\n  private state = reactive<SitesStoreState>({\n    initialSites: [],\n    isInitialized: false,\n  });\n\n  private stateFiltered = reactive<SitesStoreStateFiltered>({\n    initialSites: [],\n    isInitialized: false,\n    excludedSites: [],\n  });\n\n  private currentRequestAbort: AbortController | null = null;\n\n  private limitRequest?: Promise<{ value: number|string }>;\n\n  public readonly initialSites = computed(() => readonly(this.state.initialSites));\n\n  public readonly initialSitesFiltered = computed(() => readonly(this.stateFiltered.initialSites));\n\n  loadInitialSites(onlySitesWithAdminAccess = false,\n    sitesToExclude: number[] = []): Promise<DeepReadonly<Site[]>|null> {\n    if (this.state.isInitialized && sitesToExclude.length === 0) {\n      return Promise.resolve(readonly(this.state.initialSites));\n    }\n\n    // If the filtered state has already been initialized with the same sites, return that.\n    if (this.stateFiltered.isInitialized\n      && sitesToExclude.length === this.stateFiltered.excludedSites.length\n      && (sitesToExclude.every((val, index) => val === this.stateFiltered.excludedSites[index]))) {\n      return Promise.resolve(readonly(this.stateFiltered.initialSites));\n    }\n\n    // If we want to exclude certain sites, perform the search for that.\n    if (sitesToExclude.length > 0) {\n      this.searchSite('%', onlySitesWithAdminAccess, sitesToExclude).then((sites) => {\n        this.stateFiltered.isInitialized = true;\n        this.stateFiltered.excludedSites = sitesToExclude;\n        if (sites !== null) {\n          this.stateFiltered.initialSites = sites;\n        }\n      });\n    }\n\n    // If the main state has already been initialized, no need to continue.\n    if (this.state.isInitialized) {\n      return Promise.resolve(readonly(this.state.initialSites));\n    }\n\n    return this.searchSite('%', onlySitesWithAdminAccess, sitesToExclude).then((sites) => {\n      this.state.isInitialized = true;\n      if (sites !== null) {\n        this.state.initialSites = sites;\n      }\n      return sites;\n    });\n  }\n\n  loadSite(idSite: number|string): void {\n    if (idSite === 'all') {\n      MatomoUrl.updateUrl({\n        ...MatomoUrl.urlParsed.value,\n        module: 'MultiSites',\n        action: 'index',\n        date: MatomoUrl.parsed.value.date,\n        period: MatomoUrl.parsed.value.period,\n      });\n    } else {\n      MatomoUrl.updateUrl({\n        ...MatomoUrl.urlParsed.value,\n        segment: '',\n        idSite,\n      }, {\n        ...MatomoUrl.hashParsed.value,\n        segment: '',\n        idSite,\n      });\n    }\n  }\n\n  searchSite(term?: string, onlySitesWithAdminAccess = false,\n    sitesToExclude: number[] = []): Promise<DeepReadonly<Site[]>|null> {\n    if (!term) {\n      return this.loadInitialSites(onlySitesWithAdminAccess, sitesToExclude);\n    }\n\n    if (this.currentRequestAbort) {\n      this.currentRequestAbort.abort();\n    }\n\n    if (!this.limitRequest) {\n      this.limitRequest = AjaxHelper.fetch({ method: 'SitesManager.getNumWebsitesToDisplayPerPage' });\n    }\n\n    return this.limitRequest.then((response) => {\n      const limit = response.value;\n\n      let methodToCall = 'SitesManager.getPatternMatchSites';\n      if (onlySitesWithAdminAccess) {\n        methodToCall = 'SitesManager.getSitesWithAdminAccess';\n      }\n\n      this.currentRequestAbort = new AbortController();\n      return AjaxHelper.fetch({\n        method: methodToCall,\n        limit,\n        pattern: term,\n        sitesToExclude,\n      }, {\n        abortController: this.currentRequestAbort,\n      });\n    }).then((response) => {\n      if (response) {\n        return this.processWebsitesList(response as Site[]);\n      }\n\n      return null;\n    }).finally(() => {\n      this.currentRequestAbort = null;\n    });\n  }\n\n  private processWebsitesList(response: Site[]): Site[] {\n    let sites = response;\n\n    if (!sites || !sites.length) {\n      return [];\n    }\n\n    sites = sites.map((s) => ({\n      ...s,\n      name: s.group ? `[${s.group}] ${s.name}` : s.name,\n    }));\n\n    sites.sort((lhs: Site, rhs: Site) => {\n      if (lhs.name.toLowerCase() < rhs.name.toLowerCase()) {\n        return -1;\n      }\n      return lhs.name.toLowerCase() > rhs.name.toLowerCase() ? 1 : 0;\n    });\n\n    return sites;\n  }\n}\n\nexport default new SitesStore();\n","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    class=\"siteSelector piwikSelector borderedControl\"\n    :class=\"{'expanded': showSitesList, 'disabled': !hasMultipleSites}\"\n    v-focus-anywhere-but-here=\"{ blur: onBlur }\"\n  >\n    <input\n      v-if=\"name\"\n      type=\"hidden\"\n      :value=\"displayedModelValue?.id\"\n      :name=\"name\"\n    />\n    <a\n      ref=\"selectorLink\"\n      @click=\"onClickSelector\"\n      @keydown=\"onPressEnter($event)\"\n      href=\"javascript:void(0)\"\n      :class=\"{'loading': isLoading}\"\n      class=\"title\"\n      tabindex=\"4\"\n      :title=\"selectorLinkTitle\"\n    >\n      <span\n        class=\"icon icon-chevron-down\"\n        :class=\"{'iconHidden': isLoading, 'collapsed': !showSitesList}\"\n      />\n      <span>\n        <span\n          v-text=\"displayedModelValue?.name || firstSiteName\"\n          v-if=\"displayedModelValue?.name || !placeholder\"\n        />\n        <span\n          v-if=\"!displayedModelValue?.name && placeholder\"\n          class=\"placeholder\"\n        >{{ placeholder }}</span>\n      </span>\n    </a>\n    <div\n      v-show=\"showSitesList\"\n      class=\"dropdown\"\n    >\n      <div\n        class=\"custom_select_search\"\n        v-show=\"autocompleteMinSites <= sites.length || searchTerm\"\n      >\n        <input\n          type=\"text\"\n          @click=\"searchTerm = '';loadInitialSites()\"\n          v-model=\"searchTerm\"\n          tabindex=\"4\"\n          class=\"websiteSearch inp browser-default\"\n          v-focus-if=\"{ focused: shouldFocusOnSearch }\"\n          :placeholder=\"translate('General_Search')\"\n        />\n        <img\n          title=\"Clear\"\n          v-show=\"searchTerm\"\n          @click=\"searchTerm = '';loadInitialSites()\"\n          class=\"reset\"\n          src=\"plugins/CoreHome/images/reset_search.png\"\n        />\n      </div>\n      <div v-if=\"allSitesLocation === 'top' && showAllSitesItem\">\n        <AllSitesLink\n          :href=\"urlAllSites\"\n          :all-sites-text=\"allSitesText\"\n          @click=\"onAllSitesClick($event)\"\n        />\n      </div>\n      <div class=\"custom_select_container\">\n        <ul\n          class=\"custom_select_ul_list\"\n          @click=\"showSitesList = false\"\n        >\n          <li\n            @click=\"switchSite({ ...site, id: site.idsite }, $event)\"\n            v-show=\"!(!showSelectedSite && `${activeSiteId}` === `${site.idsite}`)\"\n            v-for=\"(site, index) in sites\"\n            :key=\"index\"\n          >\n            <a\n              @click=\"$event.preventDefault()\"\n              v-html=\"$sanitize(getMatchedSiteName(site.name))\"\n              tabindex=\"4\"\n              :href=\"getUrlForSiteId(site.idsite)\"\n              :title=\"site.name\"\n            />\n          </li>\n        </ul>\n        <ul\n          v-show=\"!sites.length && searchTerm\"\n          class=\"custom_select_ul_list\"\n        >\n          <li>\n            <div class=\"noresult\">\n              {{ translate('SitesManager_NotFound') + ' ' + searchTerm }}\n            </div>\n          </li>\n        </ul>\n      </div>\n      <div v-if=\"allSitesLocation === 'bottom' && showAllSitesItem\">\n        <AllSitesLink\n          :href=\"urlAllSites\"\n          :all-sites-text=\"allSitesText\"\n          @click=\"onAllSitesClick($event)\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { DeepReadonly, defineComponent } from 'vue';\nimport FocusAnywhereButHere from '../FocusAnywhereButHere/FocusAnywhereButHere';\nimport FocusIf from '../FocusIf/FocusIf';\nimport AllSitesLink from './AllSitesLink.vue';\nimport Matomo from '../Matomo/Matomo';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { translate } from '../translate';\nimport SitesStore from './SitesStore';\nimport debounce from '../debounce';\nimport SiteRef from './SiteRef';\nimport Site from './Site';\n\ninterface SiteSelectorState {\n  searchTerm: string;\n  showSitesList: boolean;\n  activeSiteId: string;\n  isLoading: boolean;\n  sites: DeepReadonly<Site[]>;\n  autocompleteMinSites: number;\n}\n\nexport default defineComponent({\n  props: {\n    modelValue: Object,\n    showSelectedSite: {\n      type: Boolean,\n      default: false,\n    },\n    showAllSitesItem: {\n      type: Boolean,\n      default: true,\n    },\n    switchSiteOnSelect: {\n      type: Boolean,\n      default: true,\n    },\n    onlySitesWithAdminAccess: {\n      type: Boolean,\n      default: false,\n    },\n    name: {\n      type: String,\n      default: '',\n    },\n    allSitesText: {\n      type: String,\n      default: translate('General_MultiSitesSummary'),\n    },\n    allSitesLocation: {\n      type: String,\n      default: 'bottom',\n    },\n    placeholder: String,\n    defaultToFirstSite: Boolean,\n    sitesToExclude: {\n      type: Array,\n      default: () => [] as number[],\n    },\n  },\n  emits: ['update:modelValue', 'blur'],\n  components: {\n    AllSitesLink,\n  },\n  directives: {\n    FocusAnywhereButHere,\n    FocusIf,\n  },\n  watch: {\n    searchTerm() {\n      this.onSearchTermChanged();\n    },\n  },\n  data(): SiteSelectorState {\n    return {\n      searchTerm: '',\n      activeSiteId: `${Matomo.idSite}`,\n      showSitesList: false,\n      isLoading: false,\n      sites: [],\n      autocompleteMinSites: parseInt(Matomo.config.autocomplete_min_sites as string, 10),\n    };\n  },\n  created() {\n    this.searchSite = debounce(this.searchSite);\n\n    if (!this.modelValue && Matomo.idSite) {\n      this.$emit('update:modelValue', {\n        id: Matomo.idSite,\n        name: Matomo.helper.htmlDecode(Matomo.siteName),\n      });\n    }\n  },\n  mounted() {\n    window.initTopControls();\n\n    this.loadInitialSites().then(() => {\n      if (this.shouldDefaultToFirstSite) {\n        this.$emit('update:modelValue', { id: this.sites[0].idsite, name: this.sites[0].name });\n      }\n    });\n\n    const shortcutTitle = translate('CoreHome_ShortcutWebsiteSelector');\n    Matomo.helper.registerShortcut('w', shortcutTitle, (event: KeyboardEvent) => {\n      if (event.altKey) {\n        return;\n      }\n      if (event.preventDefault) {\n        event.preventDefault();\n      } else {\n        event.returnValue = false; // IE\n      }\n\n      const selectorLink = this.$refs.selectorLink as HTMLElement;\n      if (selectorLink) {\n        selectorLink.click();\n        selectorLink.focus();\n      }\n    });\n  },\n  computed: {\n    shouldFocusOnSearch() {\n      return (this.showSitesList && this.autocompleteMinSites <= this.sites.length)\n        || this.searchTerm;\n    },\n    selectorLinkTitle() {\n      return this.hasMultipleSites\n        ? translate('CoreHome_ChangeCurrentWebsite', this.modelValue?.name || this.firstSiteName)\n        : '';\n    },\n    hasMultipleSites() {\n      const initialSites = SitesStore.initialSitesFiltered.value\n        && SitesStore.initialSitesFiltered.value.length\n        ? SitesStore.initialSitesFiltered.value : SitesStore.initialSites.value;\n      return initialSites && initialSites.length > 1;\n    },\n    firstSiteName() {\n      const initialSites = SitesStore.initialSitesFiltered.value\n        && SitesStore.initialSitesFiltered.value.length\n        ? SitesStore.initialSitesFiltered.value : SitesStore.initialSites.value;\n      return initialSites && initialSites.length > 0 ? initialSites[0].name : '';\n    },\n    urlAllSites() {\n      const newQuery = MatomoUrl.stringify({\n        ...MatomoUrl.urlParsed.value,\n        module: 'MultiSites',\n        action: 'index',\n        date: MatomoUrl.parsed.value.date,\n        period: MatomoUrl.parsed.value.period,\n      });\n      return `?${newQuery}`;\n    },\n    shouldDefaultToFirstSite() {\n      return !this.modelValue?.id\n        && (!this.hasMultipleSites || this.defaultToFirstSite)\n        && this.sites[0];\n    },\n    // using an extra computed property in case SiteSelector is used directly\n    // in a vue-entry, and there is no parent component with state to respond\n    // to update:modelValue events\n    displayedModelValue() {\n      if (this.modelValue) {\n        return this.modelValue;\n      }\n\n      if (Matomo.idSite) {\n        return {\n          id: Matomo.idSite,\n          name: Matomo.helper.htmlDecode(Matomo.siteName),\n        };\n      }\n\n      if (this.shouldDefaultToFirstSite) {\n        return { id: this.sites[0].idsite, name: this.sites[0].name };\n      }\n\n      return null;\n    },\n  },\n  methods: {\n    onSearchTermChanged() {\n      if (!this.searchTerm) {\n        this.isLoading = false;\n        this.loadInitialSites();\n      } else {\n        this.isLoading = true;\n        this.searchSite(this.searchTerm);\n      }\n    },\n    onAllSitesClick(event: MouseEvent) {\n      this.switchSite({ id: 'all', name: this.$props.allSitesText }, event);\n      this.showSitesList = false;\n    },\n    switchSite(site: SiteRef, event: KeyboardEvent|MouseEvent) {\n      // for Mac OS cmd key needs to be pressed, ctrl key on other systems\n      const controlKey = navigator.userAgent.indexOf('Mac OS X') !== -1 ? event.metaKey : event.ctrlKey;\n\n      if (event && controlKey && event.target && (event.target as HTMLLinkElement).href) {\n        window.open((event.target as HTMLLinkElement).href, '_blank');\n        return;\n      }\n\n      this.$emit('update:modelValue', { id: site.id, name: site.name });\n\n      if (!this.switchSiteOnSelect || this.activeSiteId === site.id) {\n        return;\n      }\n\n      SitesStore.loadSite(site.id);\n    },\n    onBlur() {\n      this.showSitesList = false;\n      this.$emit('blur');\n    },\n    onClickSelector() {\n      if (this.hasMultipleSites) {\n        this.showSitesList = !this.showSitesList;\n\n        if (!this.isLoading && !this.searchTerm) {\n          this.loadInitialSites();\n        }\n      }\n    },\n    onPressEnter(event: KeyboardEvent) {\n      if (event.key !== 'Enter') {\n        return;\n      }\n\n      event.preventDefault();\n\n      this.showSitesList = !this.showSitesList;\n      if (this.showSitesList && !this.isLoading) {\n        this.loadInitialSites();\n      }\n    },\n    getMatchedSiteName(siteName: string) {\n      const index = siteName.toUpperCase().indexOf(this.searchTerm.toUpperCase());\n      if (index === -1\n        || this.isLoading // only highlight when we know the displayed results are for a search\n      ) {\n        return Matomo.helper.htmlEntities(siteName);\n      }\n\n      const previousPart = Matomo.helper.htmlEntities(siteName.substring(0, index));\n      const lastPart = Matomo.helper.htmlEntities(\n        siteName.substring(index + this.searchTerm.length),\n      );\n\n      return `${previousPart}<span class=\"autocompleteMatched\">${this.searchTerm}</span>${lastPart}`;\n    },\n    loadInitialSites() {\n      return SitesStore.loadInitialSites(this.onlySitesWithAdminAccess,\n        (this.sitesToExclude ? this.sitesToExclude : []) as number[]).then((sites) => {\n        this.sites = sites || [];\n      });\n    },\n    searchSite(term: string) {\n      this.isLoading = true;\n\n      SitesStore.searchSite(term, this.onlySitesWithAdminAccess,\n        (this.sitesToExclude ? this.sitesToExclude : []) as number[]).then((sites) => {\n        if (term !== this.searchTerm) {\n          return; // search term changed in the meantime\n        }\n\n        if (sites) {\n          this.sites = sites;\n        }\n      }).finally(() => {\n        this.isLoading = false;\n      });\n    },\n    getUrlForSiteId(idSite: string|number) {\n      const newQuery = MatomoUrl.stringify({\n        ...MatomoUrl.urlParsed.value,\n        segment: '',\n        idSite,\n      });\n\n      const newHash = MatomoUrl.stringify({\n        ...MatomoUrl.hashParsed.value,\n        segment: '',\n        idSite,\n      });\n\n      return `?${newQuery}#?${newHash}`;\n    },\n  },\n});\n</script>\n","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    @click=\"this.onClick($event)\"\n    class=\"custom_select_all\"\n  >\n    <a\n      @click=\"$event.preventDefault()\"\n      v-html=\"$sanitize(allSitesText)\"\n      tabindex=\"4\"\n      :href=\"href\"\n    />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  props: {\n    href: String,\n    allSitesText: String,\n  },\n  emits: ['click'],\n  methods: {\n    onClick(event: MouseEvent) {\n      this.$emit('click', event);\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  props: {\n    href: String,\n    allSitesText: String,\n  },\n  emits: ['click'],\n  methods: {\n    onClick(event: MouseEvent) {\n      this.$emit('click', event);\n    },\n  },\n});\n","import { render } from \"./AllSitesLink.vue?vue&type=template&id=45607d28\"\nimport script from \"./AllSitesLink.vue?vue&type=script&lang=ts\"\nexport * from \"./AllSitesLink.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nimport { DeepReadonly, defineComponent } from 'vue';\nimport FocusAnywhereButHere from '../FocusAnywhereButHere/FocusAnywhereButHere';\nimport FocusIf from '../FocusIf/FocusIf';\nimport AllSitesLink from './AllSitesLink.vue';\nimport Matomo from '../Matomo/Matomo';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { translate } from '../translate';\nimport SitesStore from './SitesStore';\nimport debounce from '../debounce';\nimport SiteRef from './SiteRef';\nimport Site from './Site';\n\ninterface SiteSelectorState {\n  searchTerm: string;\n  showSitesList: boolean;\n  activeSiteId: string;\n  isLoading: boolean;\n  sites: DeepReadonly<Site[]>;\n  autocompleteMinSites: number;\n}\n\nexport default defineComponent({\n  props: {\n    modelValue: Object,\n    showSelectedSite: {\n      type: Boolean,\n      default: false,\n    },\n    showAllSitesItem: {\n      type: Boolean,\n      default: true,\n    },\n    switchSiteOnSelect: {\n      type: Boolean,\n      default: true,\n    },\n    onlySitesWithAdminAccess: {\n      type: Boolean,\n      default: false,\n    },\n    name: {\n      type: String,\n      default: '',\n    },\n    allSitesText: {\n      type: String,\n      default: translate('General_MultiSitesSummary'),\n    },\n    allSitesLocation: {\n      type: String,\n      default: 'bottom',\n    },\n    placeholder: String,\n    defaultToFirstSite: Boolean,\n    sitesToExclude: {\n      type: Array,\n      default: () => [] as number[],\n    },\n  },\n  emits: ['update:modelValue', 'blur'],\n  components: {\n    AllSitesLink,\n  },\n  directives: {\n    FocusAnywhereButHere,\n    FocusIf,\n  },\n  watch: {\n    searchTerm() {\n      this.onSearchTermChanged();\n    },\n  },\n  data(): SiteSelectorState {\n    return {\n      searchTerm: '',\n      activeSiteId: `${Matomo.idSite}`,\n      showSitesList: false,\n      isLoading: false,\n      sites: [],\n      autocompleteMinSites: parseInt(Matomo.config.autocomplete_min_sites as string, 10),\n    };\n  },\n  created() {\n    this.searchSite = debounce(this.searchSite);\n\n    if (!this.modelValue && Matomo.idSite) {\n      this.$emit('update:modelValue', {\n        id: Matomo.idSite,\n        name: Matomo.helper.htmlDecode(Matomo.siteName),\n      });\n    }\n  },\n  mounted() {\n    window.initTopControls();\n\n    this.loadInitialSites().then(() => {\n      if (this.shouldDefaultToFirstSite) {\n        this.$emit('update:modelValue', { id: this.sites[0].idsite, name: this.sites[0].name });\n      }\n    });\n\n    const shortcutTitle = translate('CoreHome_ShortcutWebsiteSelector');\n    Matomo.helper.registerShortcut('w', shortcutTitle, (event: KeyboardEvent) => {\n      if (event.altKey) {\n        return;\n      }\n      if (event.preventDefault) {\n        event.preventDefault();\n      } else {\n        event.returnValue = false; // IE\n      }\n\n      const selectorLink = this.$refs.selectorLink as HTMLElement;\n      if (selectorLink) {\n        selectorLink.click();\n        selectorLink.focus();\n      }\n    });\n  },\n  computed: {\n    shouldFocusOnSearch() {\n      return (this.showSitesList && this.autocompleteMinSites <= this.sites.length)\n        || this.searchTerm;\n    },\n    selectorLinkTitle() {\n      return this.hasMultipleSites\n        ? translate('CoreHome_ChangeCurrentWebsite', this.modelValue?.name || this.firstSiteName)\n        : '';\n    },\n    hasMultipleSites() {\n      const initialSites = SitesStore.initialSitesFiltered.value\n        && SitesStore.initialSitesFiltered.value.length\n        ? SitesStore.initialSitesFiltered.value : SitesStore.initialSites.value;\n      return initialSites && initialSites.length > 1;\n    },\n    firstSiteName() {\n      const initialSites = SitesStore.initialSitesFiltered.value\n        && SitesStore.initialSitesFiltered.value.length\n        ? SitesStore.initialSitesFiltered.value : SitesStore.initialSites.value;\n      return initialSites && initialSites.length > 0 ? initialSites[0].name : '';\n    },\n    urlAllSites() {\n      const newQuery = MatomoUrl.stringify({\n        ...MatomoUrl.urlParsed.value,\n        module: 'MultiSites',\n        action: 'index',\n        date: MatomoUrl.parsed.value.date,\n        period: MatomoUrl.parsed.value.period,\n      });\n      return `?${newQuery}`;\n    },\n    shouldDefaultToFirstSite() {\n      return !this.modelValue?.id\n        && (!this.hasMultipleSites || this.defaultToFirstSite)\n        && this.sites[0];\n    },\n    // using an extra computed property in case SiteSelector is used directly\n    // in a vue-entry, and there is no parent component with state to respond\n    // to update:modelValue events\n    displayedModelValue() {\n      if (this.modelValue) {\n        return this.modelValue;\n      }\n\n      if (Matomo.idSite) {\n        return {\n          id: Matomo.idSite,\n          name: Matomo.helper.htmlDecode(Matomo.siteName),\n        };\n      }\n\n      if (this.shouldDefaultToFirstSite) {\n        return { id: this.sites[0].idsite, name: this.sites[0].name };\n      }\n\n      return null;\n    },\n  },\n  methods: {\n    onSearchTermChanged() {\n      if (!this.searchTerm) {\n        this.isLoading = false;\n        this.loadInitialSites();\n      } else {\n        this.isLoading = true;\n        this.searchSite(this.searchTerm);\n      }\n    },\n    onAllSitesClick(event: MouseEvent) {\n      this.switchSite({ id: 'all', name: this.$props.allSitesText }, event);\n      this.showSitesList = false;\n    },\n    switchSite(site: SiteRef, event: KeyboardEvent|MouseEvent) {\n      // for Mac OS cmd key needs to be pressed, ctrl key on other systems\n      const controlKey = navigator.userAgent.indexOf('Mac OS X') !== -1 ? event.metaKey : event.ctrlKey;\n\n      if (event && controlKey && event.target && (event.target as HTMLLinkElement).href) {\n        window.open((event.target as HTMLLinkElement).href, '_blank');\n        return;\n      }\n\n      this.$emit('update:modelValue', { id: site.id, name: site.name });\n\n      if (!this.switchSiteOnSelect || this.activeSiteId === site.id) {\n        return;\n      }\n\n      SitesStore.loadSite(site.id);\n    },\n    onBlur() {\n      this.showSitesList = false;\n      this.$emit('blur');\n    },\n    onClickSelector() {\n      if (this.hasMultipleSites) {\n        this.showSitesList = !this.showSitesList;\n\n        if (!this.isLoading && !this.searchTerm) {\n          this.loadInitialSites();\n        }\n      }\n    },\n    onPressEnter(event: KeyboardEvent) {\n      if (event.key !== 'Enter') {\n        return;\n      }\n\n      event.preventDefault();\n\n      this.showSitesList = !this.showSitesList;\n      if (this.showSitesList && !this.isLoading) {\n        this.loadInitialSites();\n      }\n    },\n    getMatchedSiteName(siteName: string) {\n      const index = siteName.toUpperCase().indexOf(this.searchTerm.toUpperCase());\n      if (index === -1\n        || this.isLoading // only highlight when we know the displayed results are for a search\n      ) {\n        return Matomo.helper.htmlEntities(siteName);\n      }\n\n      const previousPart = Matomo.helper.htmlEntities(siteName.substring(0, index));\n      const lastPart = Matomo.helper.htmlEntities(\n        siteName.substring(index + this.searchTerm.length),\n      );\n\n      return `${previousPart}<span class=\"autocompleteMatched\">${this.searchTerm}</span>${lastPart}`;\n    },\n    loadInitialSites() {\n      return SitesStore.loadInitialSites(this.onlySitesWithAdminAccess,\n        (this.sitesToExclude ? this.sitesToExclude : []) as number[]).then((sites) => {\n        this.sites = sites || [];\n      });\n    },\n    searchSite(term: string) {\n      this.isLoading = true;\n\n      SitesStore.searchSite(term, this.onlySitesWithAdminAccess,\n        (this.sitesToExclude ? this.sitesToExclude : []) as number[]).then((sites) => {\n        if (term !== this.searchTerm) {\n          return; // search term changed in the meantime\n        }\n\n        if (sites) {\n          this.sites = sites;\n        }\n      }).finally(() => {\n        this.isLoading = false;\n      });\n    },\n    getUrlForSiteId(idSite: string|number) {\n      const newQuery = MatomoUrl.stringify({\n        ...MatomoUrl.urlParsed.value,\n        segment: '',\n        idSite,\n      });\n\n      const newHash = MatomoUrl.stringify({\n        ...MatomoUrl.hashParsed.value,\n        segment: '',\n        idSite,\n      });\n\n      return `?${newQuery}#?${newHash}`;\n    },\n  },\n});\n","import { render } from \"./SiteSelector.vue?vue&type=template&id=1dc4e0ef\"\nimport script from \"./SiteSelector.vue?vue&type=script&lang=ts\"\nexport * from \"./SiteSelector.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    ref=\"root\"\n    class=\"quickAccessInside\"\n    v-focus-anywhere-but-here=\"{ blur: onBlur }\"\n  >\n    <span\n      class=\"icon-search\"\n      @mouseenter=\"searchActive = true\"\n    />\n    <input\n      class=\"s\"\n      @keydown=\"onKeypress($event)\"\n      @focus=\"searchActive = true\"\n      v-model=\"searchTerm\"\n      type=\"text\"\n      tabindex=\"2\"\n      v-focus-if=\"{ focused: searchActive }\"\n      :title=\"quickAccessTitle\"\n      :placeholder=\"translate('General_Search')\"\n      ref=\"input\"\n    />\n    <div\n      class=\"dropdown\"\n      v-show=\"searchTerm && searchActive\"\n    >\n      <ul v-show=\"!(numMenuItems > 0 || sites.length)\">\n        <li class=\"no-result\">{{ translate('General_SearchNoResults') }}</li>\n      </ul>\n      <ul v-for=\"subcategory in menuItems\" :key=\"subcategory.title\">\n        <li\n          class=\"quick-access-category\"\n          @click=\"searchTerm = subcategory.title;searchMenu(searchTerm)\"\n        >\n          {{ subcategory.title }}\n        </li>\n        <li\n          class=\"result\"\n          :class=\"{ selected: submenuEntry.menuIndex === searchIndex }\"\n          @mouseenter=\"searchIndex = submenuEntry.menuIndex\"\n          @click=\"selectMenuItem(submenuEntry.index)\"\n          v-for=\"submenuEntry in subcategory.items\"\n          :key=\"submenuEntry.index\"\n        >\n          <a>{{ submenuEntry.name.trim() }}</a>\n        </li>\n      </ul>\n      <ul class=\"quickAccessMatomoSearch\">\n        <li\n          class=\"quick-access-category websiteCategory\"\n          v-show=\"hasSitesSelector && sites.length || isLoading\"\n        >\n          {{ translate('SitesManager_Sites') }}\n        </li>\n        <li\n          class=\"no-result\"\n          v-show=\"hasSitesSelector && isLoading\"\n        >\n          {{ translate('MultiSites_LoadingWebsites') }}\n        </li>\n        <li\n          class=\"result\"\n          v-for=\"(site, index) in sites\"\n          v-show=\"hasSitesSelector && !isLoading\"\n          @mouseenter=\"searchIndex = numMenuItems + index\"\n          :class=\"{ selected: numMenuItems + index === searchIndex }\"\n          @click=\"selectSite(site.idsite)\"\n          :key=\"site.idsite\"\n        >\n          <a v-text=\"site.name\" />\n        </li>\n      </ul>\n      <ul>\n        <li class=\"quick-access-category helpCategory\">{{ translate('General_HelpResources') }}</li>\n        <li\n          :class=\"{ selected: searchIndex === 'help' }\"\n          class=\"quick-access-help\"\n          @mouseenter=\"searchIndex = 'help'\"\n        >\n          <a\n            :href=\"`https://matomo.org?mtm_campaign=App_Help&mtm_source=Matomo_App&mtm_keyword=QuickSearch&s=${encodeURIComponent(searchTerm)}`\"\n            target=\"_blank\"\n          >\n            {{ translate('CoreHome_SearchOnMatomo', searchTerm) }}\n          </a>\n        </li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { DeepReadonly, defineComponent } from 'vue';\nimport FocusAnywhereButHere from '../FocusAnywhereButHere/FocusAnywhereButHere';\nimport FocusIf from '../FocusIf/FocusIf';\nimport { translate } from '../translate';\nimport SitesStore from '../SiteSelector/SitesStore';\nimport Site from '../SiteSelector/Site';\nimport Matomo from '../Matomo/Matomo';\nimport debounce from '../debounce';\n\nconst { ListingFormatter } = window;\n\ninterface SubMenuItem {\n  name: string;\n  index: number;\n  category: string;\n  menuIndex?: number;\n}\n\ninterface MenuItem {\n  title: string;\n  items: SubMenuItem[];\n}\n\ninterface QuickAccessState {\n  menuItems: Array<unknown>;\n  numMenuItems: number;\n  searchActive: boolean;\n  searchTerm: string;\n  searchIndex: number;\n\n  menuIndexCounter: number;\n  topMenuItems: SubMenuItem[]|null;\n  leftMenuItems: SubMenuItem[]|null;\n  segmentItems: SubMenuItem[]|null;\n  hasSegmentSelector: boolean;\n\n  sites: DeepReadonly<Site[]>;\n  isLoading: boolean;\n}\n\nfunction isElementInViewport(element: HTMLElement) {\n  const rect = element.getBoundingClientRect();\n  const $window = window.$(window);\n\n  return rect.top >= 0\n    && rect.left >= 0\n    && rect.bottom <= $window.height()!\n    && rect.right <= $window.width()!;\n}\n\nfunction scrollFirstElementIntoView(element: HTMLElement) {\n  if (element && element.scrollIntoView) {\n    // make sure search is visible\n    element.scrollIntoView();\n  }\n}\n\nexport default defineComponent({\n  directives: {\n    FocusAnywhereButHere,\n    FocusIf,\n  },\n  watch: {\n    searchActive(newValue: boolean) {\n      const root = this.$refs.root as HTMLElement;\n      if (!root || !root.parentElement) {\n        return;\n      }\n\n      const classes = root.parentElement.classList;\n      classes.toggle('active', newValue);\n      classes.toggle('expanded', newValue);\n    },\n  },\n  mounted() {\n    const root = this.$refs.root as HTMLElement;\n\n    // this is currently needed since vue-entry code will render a div, then vue will render a div\n    // within it, but the top controls and CSS expect to have certain CSS classes in the root\n    // element.\n    // same applies to above watch for searchActive()\n    if (root && root.parentElement) {\n      root.parentElement.classList.add('quick-access', 'piwikSelector');\n    }\n\n    if (typeof window.initTopControls !== 'undefined' && window.initTopControls) {\n      window.initTopControls();\n    }\n\n    Matomo.helper.registerShortcut('f', translate('CoreHome_ShortcutSearch'), (event) => {\n      if (event.altKey) {\n        return;\n      }\n\n      event.preventDefault();\n\n      scrollFirstElementIntoView(this.$refs.root as HTMLElement);\n\n      this.activateSearch();\n    });\n  },\n  data(): QuickAccessState {\n    const hasSegmentSelector = !!document.querySelector('.segmentEditorPanel');\n\n    return {\n      menuItems: [],\n      numMenuItems: 0,\n      searchActive: false,\n      searchTerm: '',\n      searchIndex: 0,\n      menuIndexCounter: -1,\n      topMenuItems: null,\n      leftMenuItems: null,\n      segmentItems: null,\n      hasSegmentSelector,\n      sites: [],\n      isLoading: false,\n    };\n  },\n  created() {\n    this.searchMenu = debounce(this.searchMenu.bind(this));\n  },\n  computed: {\n    hasSitesSelector() {\n      return !!document.querySelector(\n        '.top_controls .siteSelector,.top_controls [vue-entry=\"CoreHome.SiteSelector\"]',\n      );\n    },\n    quickAccessTitle() {\n      const searchAreas = [translate('CoreHome_MenuEntries')];\n\n      if (this.hasSegmentSelector) {\n        searchAreas.push(translate('CoreHome_Segments'));\n      }\n\n      if (this.hasSitesSelector) {\n        searchAreas.push(translate('SitesManager_Sites'));\n      }\n\n      return translate('CoreHome_QuickAccessTitle', ListingFormatter.formatAnd(searchAreas));\n    },\n  },\n  emits: ['itemSelected', 'blur'],\n  methods: {\n    onKeypress(event: KeyboardEvent) {\n      const areSearchResultsDisplayed = this.searchTerm && this.searchActive;\n      const isTabKey = event.which === 9;\n      const isEscKey = event.which === 27;\n\n      if (event.which === 38) {\n        this.highlightPreviousItem();\n        event.preventDefault();\n      } else if (event.which === 40) {\n        this.highlightNextItem();\n        event.preventDefault();\n      } else if (event.which === 13) {\n        this.clickQuickAccessMenuItem();\n      } else if (isTabKey && areSearchResultsDisplayed) {\n        this.deactivateSearch();\n      } else if (isEscKey && areSearchResultsDisplayed) {\n        this.deactivateSearch();\n      } else {\n        setTimeout(() => {\n          this.searchActive = true;\n          this.searchMenu(this.searchTerm);\n        });\n      }\n    },\n    highlightPreviousItem() {\n      if ((this.searchIndex - 1) < 0) {\n        this.searchIndex = 0;\n      } else {\n        this.searchIndex -= 1;\n      }\n      this.makeSureSelectedItemIsInViewport();\n    },\n    highlightNextItem() {\n      const numTotal = (this.$refs.root as HTMLElement).querySelectorAll('li.result').length;\n\n      if (numTotal <= (this.searchIndex + 1)) {\n        this.searchIndex = numTotal - 1;\n      } else {\n        this.searchIndex += 1;\n      }\n\n      this.makeSureSelectedItemIsInViewport();\n    },\n    clickQuickAccessMenuItem() {\n      const selectedMenuElement = this.getCurrentlySelectedElement();\n      if (selectedMenuElement) {\n        setTimeout(() => {\n          selectedMenuElement.click();\n          this.$emit('itemSelected', selectedMenuElement);\n        }, 20);\n      }\n    },\n    deactivateSearch() {\n      this.searchTerm = '';\n      this.searchActive = false;\n      if (this.$refs.input) {\n        (this.$refs.input as HTMLElement).blur();\n      }\n    },\n    makeSureSelectedItemIsInViewport() {\n      const element = this.getCurrentlySelectedElement();\n\n      if (element && !isElementInViewport(element)) {\n        scrollFirstElementIntoView(element);\n      }\n    },\n    getCurrentlySelectedElement(): HTMLElement|undefined {\n      const results = (this.$refs.root as HTMLElement).querySelectorAll('li.result');\n      if (results && results.length && results.item(this.searchIndex)) {\n        return results.item(this.searchIndex) as HTMLElement;\n      }\n      return undefined;\n    },\n    searchMenu(unprocessedSearchTerm: string) {\n      const searchTerm = unprocessedSearchTerm.toLowerCase();\n\n      let index = -1;\n      const menuItemsIndex: Record<string, number> = {};\n      const menuItems: MenuItem[] = [];\n\n      const moveToCategory = (theSubmenuItem: SubMenuItem) => {\n        // force rerender of element to prevent weird side effects\n        const submenuItem = { ...theSubmenuItem };\n        // needed for proper highlighting with arrow keys\n        index += 1;\n        submenuItem.menuIndex = index;\n\n        const { category } = submenuItem;\n        if (!(category in menuItemsIndex)) {\n          menuItems.push({ title: category, items: [] });\n          menuItemsIndex[category] = menuItems.length - 1;\n        }\n\n        const indexOfCategory = menuItemsIndex[category];\n        menuItems[indexOfCategory].items.push(submenuItem);\n      };\n\n      this.resetSearchIndex();\n\n      if (this.hasSitesSelector) {\n        this.isLoading = true;\n        SitesStore.searchSite(searchTerm).then((sites) => {\n          if (sites) {\n            this.sites = sites;\n          }\n        }).finally(() => {\n          this.isLoading = false;\n        });\n      }\n\n      const menuItemMatches = (i: SubMenuItem) => i.name.toLowerCase().indexOf(searchTerm) !== -1\n        || i.category.toLowerCase().indexOf(searchTerm) !== -1;\n\n      // get the menu items on first search since this component can be mounted\n      // before the menus are\n      if (this.topMenuItems === null) {\n        this.topMenuItems = this.getTopMenuItems();\n      }\n      if (this.leftMenuItems === null) {\n        this.leftMenuItems = this.getLeftMenuItems();\n      }\n      if (this.segmentItems === null) {\n        this.segmentItems = this.getSegmentItems();\n      }\n\n      const topMenuItems = this.topMenuItems.filter(menuItemMatches);\n      const leftMenuItems = this.leftMenuItems.filter(menuItemMatches);\n      const segmentItems = this.segmentItems.filter(menuItemMatches);\n\n      topMenuItems.forEach(moveToCategory);\n      leftMenuItems.forEach(moveToCategory);\n      segmentItems.forEach(moveToCategory);\n\n      this.numMenuItems = topMenuItems.length + leftMenuItems.length + segmentItems.length;\n      this.menuItems = menuItems;\n    },\n    resetSearchIndex() {\n      this.searchIndex = 0;\n      this.makeSureSelectedItemIsInViewport();\n    },\n    selectSite(idSite: string|number) {\n      SitesStore.loadSite(idSite);\n    },\n    selectMenuItem(index: number) {\n      const target: HTMLElement|null = document.querySelector(`[quick_access='${index}']`);\n      if (target) {\n        this.deactivateSearch();\n\n        const href = target.getAttribute('href');\n        if (href && href.length > 10 && target && target.click) {\n          try {\n            target.click();\n          } catch (e) {\n            window.$(target).click();\n          }\n        } else {\n          // not sure why jquery is used here and above, but only sometimes. keeping for BC.\n          window.$(target).click();\n        }\n      }\n    },\n    onBlur() {\n      this.searchActive = false;\n      this.$emit('blur');\n    },\n    activateSearch() {\n      this.searchActive = true;\n    },\n    getTopMenuItems() {\n      const category = translate('CoreHome_Menu');\n\n      const topMenuItems: SubMenuItem[] = [];\n      document.querySelectorAll('nav .sidenav li > a, nav .sidenav li > div > a').forEach((element) => {\n        let text = element.textContent?.trim();\n\n        if (!text || (element.parentElement != null && element.parentElement.tagName != null\n          && element.parentElement.tagName === 'DIV')) {\n          text = element.getAttribute('title')?.trim(); // possibly a icon, use title instead\n        }\n\n        if (text) {\n          topMenuItems.push({ name: text, index: this.menuIndexCounter += 1, category });\n          element.setAttribute('quick_access', `${this.menuIndexCounter}`);\n        }\n      });\n\n      return topMenuItems;\n    },\n    getLeftMenuItems() {\n      const leftMenuItems: SubMenuItem[] = [];\n\n      document.querySelectorAll('#secondNavBar .menuTab').forEach((element) => {\n        const categoryElement = window.$(element).find('> .item');\n        let category = categoryElement[0]?.innerText.trim() || '';\n\n        if (category && category.lastIndexOf('\\n') !== -1) {\n          // remove \"\\n\\nMenu\"\n          category = category.slice(0, category.lastIndexOf('\\n')).trim();\n        }\n\n        window.$(element).find('li .item').each((i, subElement) => {\n          const text = subElement.textContent?.trim();\n          if (text) {\n            leftMenuItems.push({ name: text, category, index: this.menuIndexCounter += 1 });\n            subElement.setAttribute('quick_access', `${this.menuIndexCounter}`);\n          }\n        });\n      });\n\n      return leftMenuItems;\n    },\n    getSegmentItems() {\n      if (!this.hasSegmentSelector) {\n        return [];\n      }\n\n      const category = translate('CoreHome_Segments');\n\n      const segmentItems: SubMenuItem[] = [];\n      document.querySelectorAll('.segmentList [data-idsegment]').forEach((element) => {\n        const text = element.querySelector('.segname')?.textContent?.trim();\n\n        if (text) {\n          segmentItems.push({ name: text, category, index: this.menuIndexCounter += 1 });\n          element.setAttribute('quick_access', `${this.menuIndexCounter}`);\n        }\n      });\n\n      return segmentItems;\n    },\n  },\n});\n</script>\n","\nimport { DeepReadonly, defineComponent } from 'vue';\nimport FocusAnywhereButHere from '../FocusAnywhereButHere/FocusAnywhereButHere';\nimport FocusIf from '../FocusIf/FocusIf';\nimport { translate } from '../translate';\nimport SitesStore from '../SiteSelector/SitesStore';\nimport Site from '../SiteSelector/Site';\nimport Matomo from '../Matomo/Matomo';\nimport debounce from '../debounce';\n\nconst { ListingFormatter } = window;\n\ninterface SubMenuItem {\n  name: string;\n  index: number;\n  category: string;\n  menuIndex?: number;\n}\n\ninterface MenuItem {\n  title: string;\n  items: SubMenuItem[];\n}\n\ninterface QuickAccessState {\n  menuItems: Array<unknown>;\n  numMenuItems: number;\n  searchActive: boolean;\n  searchTerm: string;\n  searchIndex: number;\n\n  menuIndexCounter: number;\n  topMenuItems: SubMenuItem[]|null;\n  leftMenuItems: SubMenuItem[]|null;\n  segmentItems: SubMenuItem[]|null;\n  hasSegmentSelector: boolean;\n\n  sites: DeepReadonly<Site[]>;\n  isLoading: boolean;\n}\n\nfunction isElementInViewport(element: HTMLElement) {\n  const rect = element.getBoundingClientRect();\n  const $window = window.$(window);\n\n  return rect.top >= 0\n    && rect.left >= 0\n    && rect.bottom <= $window.height()!\n    && rect.right <= $window.width()!;\n}\n\nfunction scrollFirstElementIntoView(element: HTMLElement) {\n  if (element && element.scrollIntoView) {\n    // make sure search is visible\n    element.scrollIntoView();\n  }\n}\n\nexport default defineComponent({\n  directives: {\n    FocusAnywhereButHere,\n    FocusIf,\n  },\n  watch: {\n    searchActive(newValue: boolean) {\n      const root = this.$refs.root as HTMLElement;\n      if (!root || !root.parentElement) {\n        return;\n      }\n\n      const classes = root.parentElement.classList;\n      classes.toggle('active', newValue);\n      classes.toggle('expanded', newValue);\n    },\n  },\n  mounted() {\n    const root = this.$refs.root as HTMLElement;\n\n    // this is currently needed since vue-entry code will render a div, then vue will render a div\n    // within it, but the top controls and CSS expect to have certain CSS classes in the root\n    // element.\n    // same applies to above watch for searchActive()\n    if (root && root.parentElement) {\n      root.parentElement.classList.add('quick-access', 'piwikSelector');\n    }\n\n    if (typeof window.initTopControls !== 'undefined' && window.initTopControls) {\n      window.initTopControls();\n    }\n\n    Matomo.helper.registerShortcut('f', translate('CoreHome_ShortcutSearch'), (event) => {\n      if (event.altKey) {\n        return;\n      }\n\n      event.preventDefault();\n\n      scrollFirstElementIntoView(this.$refs.root as HTMLElement);\n\n      this.activateSearch();\n    });\n  },\n  data(): QuickAccessState {\n    const hasSegmentSelector = !!document.querySelector('.segmentEditorPanel');\n\n    return {\n      menuItems: [],\n      numMenuItems: 0,\n      searchActive: false,\n      searchTerm: '',\n      searchIndex: 0,\n      menuIndexCounter: -1,\n      topMenuItems: null,\n      leftMenuItems: null,\n      segmentItems: null,\n      hasSegmentSelector,\n      sites: [],\n      isLoading: false,\n    };\n  },\n  created() {\n    this.searchMenu = debounce(this.searchMenu.bind(this));\n  },\n  computed: {\n    hasSitesSelector() {\n      return !!document.querySelector(\n        '.top_controls .siteSelector,.top_controls [vue-entry=\"CoreHome.SiteSelector\"]',\n      );\n    },\n    quickAccessTitle() {\n      const searchAreas = [translate('CoreHome_MenuEntries')];\n\n      if (this.hasSegmentSelector) {\n        searchAreas.push(translate('CoreHome_Segments'));\n      }\n\n      if (this.hasSitesSelector) {\n        searchAreas.push(translate('SitesManager_Sites'));\n      }\n\n      return translate('CoreHome_QuickAccessTitle', ListingFormatter.formatAnd(searchAreas));\n    },\n  },\n  emits: ['itemSelected', 'blur'],\n  methods: {\n    onKeypress(event: KeyboardEvent) {\n      const areSearchResultsDisplayed = this.searchTerm && this.searchActive;\n      const isTabKey = event.which === 9;\n      const isEscKey = event.which === 27;\n\n      if (event.which === 38) {\n        this.highlightPreviousItem();\n        event.preventDefault();\n      } else if (event.which === 40) {\n        this.highlightNextItem();\n        event.preventDefault();\n      } else if (event.which === 13) {\n        this.clickQuickAccessMenuItem();\n      } else if (isTabKey && areSearchResultsDisplayed) {\n        this.deactivateSearch();\n      } else if (isEscKey && areSearchResultsDisplayed) {\n        this.deactivateSearch();\n      } else {\n        setTimeout(() => {\n          this.searchActive = true;\n          this.searchMenu(this.searchTerm);\n        });\n      }\n    },\n    highlightPreviousItem() {\n      if ((this.searchIndex - 1) < 0) {\n        this.searchIndex = 0;\n      } else {\n        this.searchIndex -= 1;\n      }\n      this.makeSureSelectedItemIsInViewport();\n    },\n    highlightNextItem() {\n      const numTotal = (this.$refs.root as HTMLElement).querySelectorAll('li.result').length;\n\n      if (numTotal <= (this.searchIndex + 1)) {\n        this.searchIndex = numTotal - 1;\n      } else {\n        this.searchIndex += 1;\n      }\n\n      this.makeSureSelectedItemIsInViewport();\n    },\n    clickQuickAccessMenuItem() {\n      const selectedMenuElement = this.getCurrentlySelectedElement();\n      if (selectedMenuElement) {\n        setTimeout(() => {\n          selectedMenuElement.click();\n          this.$emit('itemSelected', selectedMenuElement);\n        }, 20);\n      }\n    },\n    deactivateSearch() {\n      this.searchTerm = '';\n      this.searchActive = false;\n      if (this.$refs.input) {\n        (this.$refs.input as HTMLElement).blur();\n      }\n    },\n    makeSureSelectedItemIsInViewport() {\n      const element = this.getCurrentlySelectedElement();\n\n      if (element && !isElementInViewport(element)) {\n        scrollFirstElementIntoView(element);\n      }\n    },\n    getCurrentlySelectedElement(): HTMLElement|undefined {\n      const results = (this.$refs.root as HTMLElement).querySelectorAll('li.result');\n      if (results && results.length && results.item(this.searchIndex)) {\n        return results.item(this.searchIndex) as HTMLElement;\n      }\n      return undefined;\n    },\n    searchMenu(unprocessedSearchTerm: string) {\n      const searchTerm = unprocessedSearchTerm.toLowerCase();\n\n      let index = -1;\n      const menuItemsIndex: Record<string, number> = {};\n      const menuItems: MenuItem[] = [];\n\n      const moveToCategory = (theSubmenuItem: SubMenuItem) => {\n        // force rerender of element to prevent weird side effects\n        const submenuItem = { ...theSubmenuItem };\n        // needed for proper highlighting with arrow keys\n        index += 1;\n        submenuItem.menuIndex = index;\n\n        const { category } = submenuItem;\n        if (!(category in menuItemsIndex)) {\n          menuItems.push({ title: category, items: [] });\n          menuItemsIndex[category] = menuItems.length - 1;\n        }\n\n        const indexOfCategory = menuItemsIndex[category];\n        menuItems[indexOfCategory].items.push(submenuItem);\n      };\n\n      this.resetSearchIndex();\n\n      if (this.hasSitesSelector) {\n        this.isLoading = true;\n        SitesStore.searchSite(searchTerm).then((sites) => {\n          if (sites) {\n            this.sites = sites;\n          }\n        }).finally(() => {\n          this.isLoading = false;\n        });\n      }\n\n      const menuItemMatches = (i: SubMenuItem) => i.name.toLowerCase().indexOf(searchTerm) !== -1\n        || i.category.toLowerCase().indexOf(searchTerm) !== -1;\n\n      // get the menu items on first search since this component can be mounted\n      // before the menus are\n      if (this.topMenuItems === null) {\n        this.topMenuItems = this.getTopMenuItems();\n      }\n      if (this.leftMenuItems === null) {\n        this.leftMenuItems = this.getLeftMenuItems();\n      }\n      if (this.segmentItems === null) {\n        this.segmentItems = this.getSegmentItems();\n      }\n\n      const topMenuItems = this.topMenuItems.filter(menuItemMatches);\n      const leftMenuItems = this.leftMenuItems.filter(menuItemMatches);\n      const segmentItems = this.segmentItems.filter(menuItemMatches);\n\n      topMenuItems.forEach(moveToCategory);\n      leftMenuItems.forEach(moveToCategory);\n      segmentItems.forEach(moveToCategory);\n\n      this.numMenuItems = topMenuItems.length + leftMenuItems.length + segmentItems.length;\n      this.menuItems = menuItems;\n    },\n    resetSearchIndex() {\n      this.searchIndex = 0;\n      this.makeSureSelectedItemIsInViewport();\n    },\n    selectSite(idSite: string|number) {\n      SitesStore.loadSite(idSite);\n    },\n    selectMenuItem(index: number) {\n      const target: HTMLElement|null = document.querySelector(`[quick_access='${index}']`);\n      if (target) {\n        this.deactivateSearch();\n\n        const href = target.getAttribute('href');\n        if (href && href.length > 10 && target && target.click) {\n          try {\n            target.click();\n          } catch (e) {\n            window.$(target).click();\n          }\n        } else {\n          // not sure why jquery is used here and above, but only sometimes. keeping for BC.\n          window.$(target).click();\n        }\n      }\n    },\n    onBlur() {\n      this.searchActive = false;\n      this.$emit('blur');\n    },\n    activateSearch() {\n      this.searchActive = true;\n    },\n    getTopMenuItems() {\n      const category = translate('CoreHome_Menu');\n\n      const topMenuItems: SubMenuItem[] = [];\n      document.querySelectorAll('nav .sidenav li > a, nav .sidenav li > div > a').forEach((element) => {\n        let text = element.textContent?.trim();\n\n        if (!text || (element.parentElement != null && element.parentElement.tagName != null\n          && element.parentElement.tagName === 'DIV')) {\n          text = element.getAttribute('title')?.trim(); // possibly a icon, use title instead\n        }\n\n        if (text) {\n          topMenuItems.push({ name: text, index: this.menuIndexCounter += 1, category });\n          element.setAttribute('quick_access', `${this.menuIndexCounter}`);\n        }\n      });\n\n      return topMenuItems;\n    },\n    getLeftMenuItems() {\n      const leftMenuItems: SubMenuItem[] = [];\n\n      document.querySelectorAll('#secondNavBar .menuTab').forEach((element) => {\n        const categoryElement = window.$(element).find('> .item');\n        let category = categoryElement[0]?.innerText.trim() || '';\n\n        if (category && category.lastIndexOf('\\n') !== -1) {\n          // remove \"\\n\\nMenu\"\n          category = category.slice(0, category.lastIndexOf('\\n')).trim();\n        }\n\n        window.$(element).find('li .item').each((i, subElement) => {\n          const text = subElement.textContent?.trim();\n          if (text) {\n            leftMenuItems.push({ name: text, category, index: this.menuIndexCounter += 1 });\n            subElement.setAttribute('quick_access', `${this.menuIndexCounter}`);\n          }\n        });\n      });\n\n      return leftMenuItems;\n    },\n    getSegmentItems() {\n      if (!this.hasSegmentSelector) {\n        return [];\n      }\n\n      const category = translate('CoreHome_Segments');\n\n      const segmentItems: SubMenuItem[] = [];\n      document.querySelectorAll('.segmentList [data-idsegment]').forEach((element) => {\n        const text = element.querySelector('.segname')?.textContent?.trim();\n\n        if (text) {\n          segmentItems.push({ name: text, category, index: this.menuIndexCounter += 1 });\n          element.setAttribute('quick_access', `${this.menuIndexCounter}`);\n        }\n      });\n\n      return segmentItems;\n    },\n  },\n});\n","import { render } from \"./QuickAccess.vue?vue&type=template&id=bd42bc70\"\nimport script from \"./QuickAccess.vue?vue&type=script&lang=ts\"\nexport * from \"./QuickAccess.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"fieldArray form-group\">\n    <div\n      class=\"fieldArrayTable multiple valign-wrapper\"\n      v-for=\"(item, index) in modelValue\"\n      :class=\"{[`fieldArrayTable${index}`]: true}\"\n      :key=\"index\"\n    >\n      <div\n        v-if=\"field.uiControl\"\n        class=\"fieldUiControl\"\n      >\n        <Field\n          :full-width=\"true\"\n          :model-value=\"item\"\n          :options=\"field.availableValues\"\n          @update:modelValue=\"onEntryChange($event, index)\"\n          :model-modifiers=\"field.modelModifiers\"\n          :placeholder=\"' '\"\n          :uicontrol=\"field.uiControl\"\n          :title=\"field.title\"\n          :name=\"`${name}-${index}`\"\n          :template-file=\"field.templateFile\"\n          :component=\"field.component\"\n        >\n        </Field>\n      </div>\n      <span\n        @click=\"removeEntry(index)\"\n        class=\"icon-minus valign\"\n        v-show=\"index + 1 !== modelValue.length\"\n        :title=\"translate('General_Remove')\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\n// async since this is a a recursive component\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nexport default defineComponent({\n  props: {\n    modelValue: Array,\n    name: String,\n    field: Object,\n    rows: String,\n  },\n  components: {\n    Field,\n  },\n  emits: ['update:modelValue'],\n  watch: {\n    modelValue(newValue) {\n      this.checkEmptyModelValue(newValue);\n    },\n  },\n  mounted() {\n    this.checkEmptyModelValue(this.modelValue);\n  },\n  methods: {\n    checkEmptyModelValue(newValue?: unknown[]) {\n      // make sure there is always an empty new value\n      if ((!newValue || !newValue.length || newValue.slice(-1)[0] !== '')\n        && (!this.rows || (this.modelValue || []).length < parseInt(this.rows, 10))) {\n        this.$emit('update:modelValue', [...(newValue || []), '']);\n      }\n    },\n    onEntryChange(newValue: unknown, index: number) {\n      const newArrayValue = [...(this.modelValue || [])];\n      newArrayValue[index] = newValue;\n\n      this.$emit('update:modelValue', newArrayValue);\n    },\n    removeEntry(index: number) {\n      if (index > -1 && this.modelValue) {\n        const newValue = this.modelValue.filter((x, i) => i !== index);\n        this.$emit('update:modelValue', newValue);\n      }\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\n// async since this is a a recursive component\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nexport default defineComponent({\n  props: {\n    modelValue: Array,\n    name: String,\n    field: Object,\n    rows: String,\n  },\n  components: {\n    Field,\n  },\n  emits: ['update:modelValue'],\n  watch: {\n    modelValue(newValue) {\n      this.checkEmptyModelValue(newValue);\n    },\n  },\n  mounted() {\n    this.checkEmptyModelValue(this.modelValue);\n  },\n  methods: {\n    checkEmptyModelValue(newValue?: unknown[]) {\n      // make sure there is always an empty new value\n      if ((!newValue || !newValue.length || newValue.slice(-1)[0] !== '')\n        && (!this.rows || (this.modelValue || []).length < parseInt(this.rows, 10))) {\n        this.$emit('update:modelValue', [...(newValue || []), '']);\n      }\n    },\n    onEntryChange(newValue: unknown, index: number) {\n      const newArrayValue = [...(this.modelValue || [])];\n      newArrayValue[index] = newValue;\n\n      this.$emit('update:modelValue', newArrayValue);\n    },\n    removeEntry(index: number) {\n      if (index > -1 && this.modelValue) {\n        const newValue = this.modelValue.filter((x, i) => i !== index);\n        this.$emit('update:modelValue', newValue);\n      }\n    },\n  },\n});\n","import { render } from \"./FieldArray.vue?vue&type=template&id=7ec28fd8\"\nimport script from \"./FieldArray.vue?vue&type=script&lang=ts\"\nexport * from \"./FieldArray.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"multiPairField form-group\">\n    <div\n      v-for=\"(item, index) in modelValue\"\n      class=\"multiPairFieldTable multiple valign-wrapper\"\n      :class=\"{ [`multiPairFieldTable${index}`]: true, [`has${fieldCount}Fields`]: true }\"\n      :key=\"index\"\n    >\n      <div\n        class=\"fieldUiControl fieldUiControl1\"\n        v-if=\"field1\"\n        :class=\"{ hasMultiFields: field1.type && field2.type }\"\n      >\n        <Field\n          :full-width=\"true\"\n          :model-value=\"item[field1.key]\"\n          :options=\"field1.availableValues\"\n          @update:modelValue=\"onEntryChange(index, field1.key, $event)\"\n          :model-modifiers=\"field1.modelModifiers\"\n          :placeholder=\"' '\"\n          :uicontrol=\"field1.uiControl\"\n          :name=\"`${name}-p1-${index}`\"\n          :title=\"field1.title\"\n          :template-file=\"field1.templateFile\"\n          :component=\"field1.component\"\n        >\n        </Field>\n      </div>\n      <div\n        class=\"fieldUiControl fieldUiControl2\"\n        v-if=\"field2\"\n      >\n        <Field\n          :full-width=\"true\"\n          :options=\"field2.availableValues\"\n          @update:modelValue=\"onEntryChange(index, field2.key, $event)\"\n          :model-value=\"item[field2.key]\"\n          :model-modifiers=\"field2.modelModifiers\"\n          :placeholder=\"' '\"\n          :uicontrol=\"field2.uiControl\"\n          :name=\"`${name}-p2-${index}`\"\n          :title=\"field2.title\"\n          :template-file=\"field2.templateFile\"\n          :component=\"field2.component\"\n        >\n        </Field>\n      </div>\n      <div\n        class=\"fieldUiControl fieldUiControl3\"\n        v-if=\"field3\"\n      >\n        <Field\n          :full-width=\"true\"\n          :options=\"field3.availableValues\"\n          @update:modelValue=\"onEntryChange(index, field3.key, $event)\"\n          :model-value=\"item[field3.key]\"\n          :model-modifiers=\"field3.modelModifiers\"\n          :placeholder=\"' '\"\n          :uicontrol=\"field3.uiControl\"\n          :title=\"field3.title\"\n          :template-file=\"field3.templateFile\"\n          :component=\"field3.component\"\n        >\n        </Field>\n      </div>\n      <div\n        class=\"fieldUiControl fieldUiControl4\"\n        v-if=\"field4\"\n      >\n        <Field\n          :full-width=\"true\"\n          :options=\"field4.availableValues\"\n          @update:modelValue=\"onEntryChange(index, field4.key, $event)\"\n          :model-value=\"item[field4.key]\"\n          :model-modifiers=\"field4.modelModifiers\"\n          :placeholder=\"' '\"\n          :uicontrol=\"field4.uiControl\"\n          :title=\"field4.title\"\n          :template-file=\"field4.templateFile\"\n          :component=\"field4.component\"\n        >\n        </Field>\n      </div>\n      <span\n        @click=\"removeEntry(index)\"\n        class=\"icon-minus valign\"\n        v-show=\"index + 1 !== modelValue.length\"\n        :title=\"translate('General_Remove')\"\n      />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\n// async since this is a recursive component\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nexport default defineComponent({\n  props: {\n    modelValue: Array,\n    name: String,\n    field1: Object,\n    field2: Object,\n    field3: Object,\n    field4: Object,\n    rows: Number,\n  },\n  components: {\n    Field,\n  },\n  computed: {\n    fieldCount() {\n      if (this.field1 && this.field2 && this.field3 && this.field4) {\n        return 4;\n      }\n\n      if (this.field1 && this.field2 && this.field3) {\n        return 3;\n      }\n\n      if (this.field1 && this.field2) {\n        return 2;\n      }\n\n      if (this.field1) {\n        return 1;\n      }\n\n      return 0;\n    },\n  },\n  emits: ['update:modelValue'],\n  watch: {\n    modelValue(newValue?: Record<string, unknown>[]) {\n      this.checkEmptyModelValue(newValue);\n    },\n  },\n  mounted() {\n    this.checkEmptyModelValue(this.modelValue as Record<string, unknown>[]);\n  },\n  methods: {\n    checkEmptyModelValue(newValue?: Record<string, unknown>[]) {\n      // make sure there is always an empty new value\n      if ((!newValue\n        || !newValue.length\n        || this.isEmptyValue(newValue.slice(-1)[0]))\n        && (!this.rows\n          || (this.modelValue as Record<string, unknown>[]).length < this.rows)\n      ) {\n        this.$emit('update:modelValue', [...(newValue || []), this.makeEmptyValue()]);\n      }\n    },\n    onEntryChange(index: number, key: string, newValue: Record<string, unknown>) {\n      const newWholeValue = [...(this.modelValue as Record<string, unknown>[])];\n      newWholeValue[index] = { ...newWholeValue[index], [key]: newValue };\n      this.$emit('update:modelValue', newWholeValue);\n    },\n    removeEntry(index: number) {\n      if (index > -1 && this.modelValue) {\n        const newValue = this.modelValue.filter((x, i) => i !== index);\n        this.$emit('update:modelValue', newValue);\n      }\n    },\n    isEmptyValue(value: Record<string, unknown>) {\n      const { fieldCount } = this;\n\n      if (fieldCount === 4) {\n        if (!value[this.field1!.key]\n          && !value[this.field2!.key]\n          && !value[this.field3!.key]\n          && !value[this.field4!.key]\n        ) {\n          return false;\n        }\n      } else if (fieldCount === 3) {\n        if (!value[this.field1!.key] && !value[this.field2!.key] && !value[this.field3!.key]) {\n          return false;\n        }\n      } else if (fieldCount === 2) {\n        if (!value[this.field1!.key] && !value[this.field2!.key]) {\n          return false;\n        }\n      } else if (fieldCount === 1) {\n        if (!value[this.field1!.key]) {\n          return false;\n        }\n      }\n\n      return true;\n    },\n    makeEmptyValue(): Record<string, unknown> {\n      const result: Record<string, unknown> = {};\n      if (this.field1 && this.field1.key) {\n        result[this.field1.key] = '';\n      }\n      if (this.field2 && this.field2.key) {\n        result[this.field2.key] = '';\n      }\n      if (this.field3 && this.field3.key) {\n        result[this.field3.key] = '';\n      }\n      if (this.field4 && this.field4.key) {\n        result[this.field4.key] = '';\n      }\n      return result;\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\n// async since this is a recursive component\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nexport default defineComponent({\n  props: {\n    modelValue: Array,\n    name: String,\n    field1: Object,\n    field2: Object,\n    field3: Object,\n    field4: Object,\n    rows: Number,\n  },\n  components: {\n    Field,\n  },\n  computed: {\n    fieldCount() {\n      if (this.field1 && this.field2 && this.field3 && this.field4) {\n        return 4;\n      }\n\n      if (this.field1 && this.field2 && this.field3) {\n        return 3;\n      }\n\n      if (this.field1 && this.field2) {\n        return 2;\n      }\n\n      if (this.field1) {\n        return 1;\n      }\n\n      return 0;\n    },\n  },\n  emits: ['update:modelValue'],\n  watch: {\n    modelValue(newValue?: Record<string, unknown>[]) {\n      this.checkEmptyModelValue(newValue);\n    },\n  },\n  mounted() {\n    this.checkEmptyModelValue(this.modelValue as Record<string, unknown>[]);\n  },\n  methods: {\n    checkEmptyModelValue(newValue?: Record<string, unknown>[]) {\n      // make sure there is always an empty new value\n      if ((!newValue\n        || !newValue.length\n        || this.isEmptyValue(newValue.slice(-1)[0]))\n        && (!this.rows\n          || (this.modelValue as Record<string, unknown>[]).length < this.rows)\n      ) {\n        this.$emit('update:modelValue', [...(newValue || []), this.makeEmptyValue()]);\n      }\n    },\n    onEntryChange(index: number, key: string, newValue: Record<string, unknown>) {\n      const newWholeValue = [...(this.modelValue as Record<string, unknown>[])];\n      newWholeValue[index] = { ...newWholeValue[index], [key]: newValue };\n      this.$emit('update:modelValue', newWholeValue);\n    },\n    removeEntry(index: number) {\n      if (index > -1 && this.modelValue) {\n        const newValue = this.modelValue.filter((x, i) => i !== index);\n        this.$emit('update:modelValue', newValue);\n      }\n    },\n    isEmptyValue(value: Record<string, unknown>) {\n      const { fieldCount } = this;\n\n      if (fieldCount === 4) {\n        if (!value[this.field1!.key]\n          && !value[this.field2!.key]\n          && !value[this.field3!.key]\n          && !value[this.field4!.key]\n        ) {\n          return false;\n        }\n      } else if (fieldCount === 3) {\n        if (!value[this.field1!.key] && !value[this.field2!.key] && !value[this.field3!.key]) {\n          return false;\n        }\n      } else if (fieldCount === 2) {\n        if (!value[this.field1!.key] && !value[this.field2!.key]) {\n          return false;\n        }\n      } else if (fieldCount === 1) {\n        if (!value[this.field1!.key]) {\n          return false;\n        }\n      }\n\n      return true;\n    },\n    makeEmptyValue(): Record<string, unknown> {\n      const result: Record<string, unknown> = {};\n      if (this.field1 && this.field1.key) {\n        result[this.field1.key] = '';\n      }\n      if (this.field2 && this.field2.key) {\n        result[this.field2.key] = '';\n      }\n      if (this.field3 && this.field3.key) {\n        result[this.field3.key] = '';\n      }\n      if (this.field4 && this.field4.key) {\n        result[this.field4.key] = '';\n      }\n      return result;\n    },\n  },\n});\n","import { render } from \"./MultiPairField.vue?vue&type=template&id=1599cf40\"\nimport script from \"./MultiPairField.vue?vue&type=script&lang=ts\"\nexport * from \"./MultiPairField.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    ref=\"root\"\n    class=\"periodSelector piwikSelector\"\n    v-expand-on-click=\"{ expander: 'title' }\"\n  >\n    <a\n      ref=\"title\"\n      id=\"date\"\n      class=\"title\"\n      tabindex=\"-1\"\n      :title=\"translate('General_ChooseDate', currentlyViewingText)\"\n    >\n      <span class=\"icon icon-calendar\" />\n      {{ currentlyViewingText }}\n    </a>\n    <div\n      id=\"periodMore\"\n      class=\"dropdown\"\n    >\n      <div class=\"flex\">\n        <div>\n          <DateRangePicker\n            v-show=\"selectedPeriod === 'range'\"\n            class=\"period-range\"\n            :start-date=\"startRangeDate\"\n            :end-date=\"endRangeDate\"\n            @range-change=\"onRangeChange($event.start, $event.end)\"\n            @submit=\"onApplyClicked()\"\n          >\n          </DateRangePicker>\n          <div\n            class=\"period-date\"\n            v-if=\"selectedPeriod !== 'range'\"\n          >\n            <PeriodDatePicker\n              id=\"datepicker\"\n              :period=\"selectedPeriod\"\n              :date=\"periodValue === selectedPeriod ? dateValue : null\"\n              @select=\"setPiwikPeriodAndDate(selectedPeriod, $event.date)\"\n            >\n            </PeriodDatePicker>\n          </div>\n        </div>\n        <div class=\"period-type\">\n          <h6>{{ translate('General_Period') }}</h6>\n          <div id=\"otherPeriods\">\n            <p\n              v-for=\"period in periodsFiltered\"\n              :key=\"period\"\n            >\n              <label\n                :class=\"{ 'selected-period-label': period === selectedPeriod }\"\n                @dblclick=\"changeViewedPeriod(period)\"\n                :title=\"period === periodValue\n                  ? ''\n                  : translate('General_DoubleClickToChangePeriod')\"\n              >\n                <input\n                  type=\"radio\"\n                  name=\"period\"\n                  :id=\"`period_id_${ period }`\"\n                  v-model=\"selectedPeriod\"\n                  :checked=\"selectedPeriod === period\"\n                  @change=\"selectedPeriod = period\"\n                  @dblclick=\"changeViewedPeriod(period)\"\n                />\n                <span>{{ getPeriodDisplayText(period) }}</span>\n              </label>\n            </p>\n          </div>\n        </div>\n      </div>\n      <div\n        class=\"compare-checkbox\"\n        v-if=\"isComparisonEnabled\"\n      >\n        <label>\n          <input\n            id=\"comparePeriodTo\"\n            type=\"checkbox\"\n            v-model=\"isComparing\"\n          />\n          <span>{{ translate('General_CompareTo') }}</span>\n        </label>\n        <div id=\"comparePeriodToDropdown\">\n          <Field\n            v-model=\"comparePeriodType\"\n            :style=\"{'visibility': isComparing ? 'visible' : 'hidden'}\"\n            :name=\"'comparePeriodToDropdown'\"\n            :uicontrol=\"'select'\"\n            :options=\"comparePeriodDropdownOptions\"\n            :full-width=\"true\"\n            :disabled=\"!isComparing\"\n          />\n        </div>\n      </div>\n      <div\n        class=\"compare-date-range\"\n        v-if=\"isComparing && comparePeriodType === 'custom'\"\n      >\n        <div>\n          <div id=\"comparePeriodStartDate\">\n            <div>\n              <Field\n                v-model=\"compareStartDate\"\n                :name=\"'comparePeriodStartDate'\"\n                :uicontrol=\"'text'\"\n                :full-width=\"true\"\n                :title=\"translate('CoreHome_StartDate')\"\n                :placeholder=\"'YYYY-MM-DD'\"\n              />\n            </div>\n          </div>\n          <span class=\"compare-dates-separator\" />\n          <div id=\"comparePeriodEndDate\">\n            <div>\n              <Field\n                v-model=\"compareEndDate\"\n                :name=\"'comparePeriodEndDate'\"\n                :uicontrol=\"'text'\"\n                :full-width=\"true\"\n                :title=\"translate('CoreHome_EndDate')\"\n                :placeholder=\"'YYYY-MM-DD'\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"apply-button-container\">\n        <input\n          type=\"submit\"\n          id=\"calendarApply\"\n          class=\"btn\"\n          @click=\"onApplyClicked()\"\n          :disabled=\"!isApplyEnabled()\"\n          :value=\"translate('General_Apply')\"\n        />\n      </div>\n      <div\n        id=\"ajaxLoadingCalendar\"\n        v-if=\"isLoadingNewPage\"\n      >\n        <ActivityIndicator\n          :loading=\"true\"\n        />\n        <div class=\"loadingSegment\">\n          {{ translate('SegmentEditor_LoadingSegmentedDataMayTakeSomeTime') }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, watch } from 'vue';\nimport ExpandOnClick from '../ExpandOnClick/ExpandOnClick';\nimport DateRangePicker from '../DateRangePicker/DateRangePicker.vue';\nimport PeriodDatePicker from '../PeriodDatePicker/PeriodDatePicker.vue';\nimport ActivityIndicator from '../ActivityIndicator/ActivityIndicator.vue';\nimport Matomo from '../Matomo/Matomo';\nimport { translate } from '../translate';\nimport ComparisonsStore from '../Comparisons/Comparisons.store.instance';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\nimport {\n  Periods,\n  parseDate,\n  Range,\n  format,\n} from '../Periods';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\n\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nconst NBSP = Matomo.helper.htmlDecode('&nbsp;');\n\nconst COMPARE_PERIOD_TYPES = ['custom', 'previousPeriod', 'previousYear'];\n\nconst COMPARE_PERIOD_OPTIONS = [\n  { key: 'custom', value: translate('General_Custom') },\n  {\n    key: 'previousPeriod',\n    value: translate('General_PreviousPeriod').replace(/\\s+/, NBSP),\n  },\n  {\n    key: 'previousYear',\n    value: translate('General_PreviousYear').replace(/\\s+/, NBSP),\n  },\n];\n\nconst piwikMinDate = new Date(Matomo.minDateYear, Matomo.minDateMonth - 1, Matomo.minDateDay);\nconst piwikMaxDate = new Date(Matomo.maxDateYear, Matomo.maxDateMonth - 1, Matomo.maxDateDay);\n\nfunction isValidDate(d: any) { // eslint-disable-line @typescript-eslint/no-explicit-any\n  if (Object.prototype.toString.call(d) !== '[object Date]') {\n    return false;\n  }\n\n  return !Number.isNaN(d.getTime());\n}\n\ninterface PeriodSelectorState {\n  comparePeriodDropdownOptions: typeof COMPARE_PERIOD_OPTIONS;\n  periodValue: string;\n  dateValue: Date|null;\n  selectedPeriod: string;\n  startRangeDate: string|null;\n  endRangeDate: string|null;\n  isRangeValid: boolean|null;\n  isLoadingNewPage: boolean;\n  isComparing: null|boolean;\n  comparePeriodType: string;\n  compareStartDate: string;\n  compareEndDate: string;\n}\n\nexport default defineComponent({\n  props: {\n    periods: Array,\n  },\n  components: {\n    DateRangePicker,\n    PeriodDatePicker,\n    Field,\n    ActivityIndicator,\n  },\n  directives: {\n    ExpandOnClick,\n  },\n  data(): PeriodSelectorState {\n    const selectedPeriod = MatomoUrl.parsed.value.period as string;\n    return {\n      comparePeriodDropdownOptions: COMPARE_PERIOD_OPTIONS,\n      periodValue: selectedPeriod,\n      dateValue: null,\n      selectedPeriod,\n      startRangeDate: null,\n      endRangeDate: null,\n      isRangeValid: null,\n      isLoadingNewPage: false,\n      isComparing: null,\n      comparePeriodType: 'previousPeriod',\n      compareStartDate: '',\n      compareEndDate: '',\n    };\n  },\n  mounted() {\n    Matomo.on('hidePeriodSelector', () => {\n      window.$(this.$refs.root as HTMLElement).parent('#periodString').hide();\n    });\n\n    // some widgets might hide the period selector using the event above, so ensure it's\n    // shown again when switching the page\n    Matomo.on('matomoPageChange', () => {\n      window.$(this.$refs.root as HTMLElement).parent('#periodString').show();\n    });\n\n    this.isComparing = ComparisonsStore.isComparingPeriods();\n    watch(() => ComparisonsStore.isComparingPeriods(), (newVal) => {\n      this.isComparing = newVal;\n    });\n\n    this.updateSelectedValuesFromHash();\n    watch(() => MatomoUrl.parsed.value, this.updateSelectedValuesFromHash);\n\n    this.updateComparisonValuesFromStore();\n    watch(() => ComparisonsStore.getPeriodComparisons(), this.updateComparisonValuesFromStore);\n\n    window.initTopControls(); // must be called when a top control changes width\n\n    this.handleZIndexPositionRelativeCompareDropdownIssue();\n  },\n  computed: {\n    currentlyViewingText() {\n      let date;\n      if (this.periodValue === 'range') {\n        if (!this.startRangeDate || !this.endRangeDate) {\n          return translate('General_Error');\n        }\n\n        date = `${this.startRangeDate},${this.endRangeDate}`;\n      } else {\n        if (!this.dateValue) {\n          return translate('General_Error');\n        }\n\n        date = format(this.dateValue);\n      }\n\n      try {\n        return Periods.parse(this.periodValue!, date).getPrettyString();\n      } catch (e) {\n        return translate('General_Error');\n      }\n    },\n    isComparisonEnabled() {\n      return ComparisonsStore.isComparisonEnabled();\n    },\n    periodsFiltered() {\n      return (this.periods as string[] || []).filter(\n        (periodLabel) => Periods.isRecognizedPeriod(periodLabel),\n      );\n    },\n    selectedComparisonParams() {\n      if (!this.isComparing) {\n        return {};\n      }\n\n      if (this.comparePeriodType === 'custom') {\n        return {\n          comparePeriods: ['range'],\n          comparePeriodType: 'custom',\n          compareDates: [`${this.compareStartDate},${this.compareEndDate}`],\n        };\n      }\n\n      if (this.comparePeriodType === 'previousPeriod') {\n        return {\n          comparePeriods: [this.selectedPeriod],\n          comparePeriodType: 'previousPeriod',\n          compareDates: [this.previousPeriodDateToSelectedPeriod],\n        };\n      }\n\n      if (this.comparePeriodType === 'previousYear') {\n        const dateStr = this.selectedPeriod === 'range'\n          ? `${this.startRangeDate},${this.endRangeDate}`\n          : format(this.dateValue!);\n\n        const currentDateRange = Periods.parse(\n          this.selectedPeriod as string,\n          dateStr,\n        ).getDateRange();\n        currentDateRange[0].setFullYear(currentDateRange[0].getFullYear() - 1);\n        currentDateRange[1].setFullYear(currentDateRange[1].getFullYear() - 1);\n\n        if (this.selectedPeriod === 'range') {\n          return {\n            comparePeriods: ['range'],\n            comparePeriodType: 'previousYear',\n            compareDates: [`${format(currentDateRange[0])},${format(currentDateRange[1])}`],\n          };\n        }\n\n        return {\n          comparePeriods: [this.selectedPeriod],\n          comparePeriodType: 'previousYear',\n          compareDates: [format(currentDateRange[0])],\n        };\n      }\n\n      console.warn(`Unknown compare period type: ${this.comparePeriodType}`);\n      return {};\n    },\n    previousPeriodDateToSelectedPeriod() {\n      if (this.selectedPeriod === 'range') {\n        const currentStartRange = parseDate(this.startRangeDate!);\n        const currentEndRange = parseDate(this.endRangeDate!);\n        const newEndDate = Range.getLastNRange('day', 2, currentStartRange).startDate;\n\n        const rangeSize = Math.floor(\n          (currentEndRange.valueOf() - currentStartRange.valueOf()) / 86400000,\n        );\n        const newRange = Range.getLastNRange('day', 1 + rangeSize, newEndDate);\n\n        return `${format(newRange.startDate)},${format(newRange.endDate)}`;\n      }\n\n      const newStartDate = Range.getLastNRange(this.selectedPeriod, 2, this.dateValue!).startDate;\n      return format(newStartDate);\n    },\n    selectedDateString() {\n      if (this.selectedPeriod === 'range') {\n        const dateFrom = this.startRangeDate!;\n        const dateTo = this.endRangeDate!;\n        const oDateFrom = parseDate(dateFrom);\n        const oDateTo = parseDate(dateTo);\n\n        if (!isValidDate(oDateFrom)\n          || !isValidDate(oDateTo)\n          || oDateFrom > oDateTo\n        ) {\n          // TODO: use a notification instead?\n          window.$('#alert')\n            .find('h2')\n            .text(translate('General_InvalidDateRange'));\n          Matomo.helper.modalConfirm('#alert', {});\n          return null;\n        }\n\n        return `${dateFrom},${dateTo}`;\n      }\n\n      return format(this.dateValue!);\n    },\n  },\n  methods: {\n    handleZIndexPositionRelativeCompareDropdownIssue() {\n      const $element = window.$(this.$refs.root as HTMLElement);\n      $element.on('focus', '#comparePeriodToDropdown .select-dropdown', () => {\n        $element.addClass('compare-dropdown-open');\n      }).on('blur', '#comparePeriodToDropdown .select-dropdown', () => {\n        $element.removeClass('compare-dropdown-open');\n      });\n    },\n    changeViewedPeriod(period: string) {\n      // only change period if it's different from what's being shown currently\n      if (period === this.periodValue) {\n        return;\n      }\n\n      // can't just change to a range period, w/o setting two new dates\n      if (period === 'range') {\n        return;\n      }\n\n      this.setPiwikPeriodAndDate(period, this.dateValue!);\n    },\n    setPiwikPeriodAndDate(period: string, date: Date) {\n      this.periodValue = period;\n      this.selectedPeriod = period;\n      this.dateValue = date;\n\n      const currentDateString = format(date);\n      this.setRangeStartEndFromPeriod(period, currentDateString);\n\n      this.propagateNewUrlParams(currentDateString, this.selectedPeriod);\n\n      window.initTopControls();\n    },\n    propagateNewUrlParams(date: string, period: string) {\n      const compareParams = this.selectedComparisonParams;\n\n      let baseParams: Record<string, unknown>;\n      if (Matomo.helper.isReportingPage()) {\n        this.closePeriodSelector();\n        baseParams = MatomoUrl.hashParsed.value;\n      } else {\n        this.isLoadingNewPage = true;\n        baseParams = MatomoUrl.parsed.value;\n      }\n\n      // get params without comparePeriods/compareSegments/compareDates\n      const paramsWithoutCompare = { ...baseParams };\n      delete paramsWithoutCompare.comparePeriods;\n      delete paramsWithoutCompare.comparePeriodType;\n      delete paramsWithoutCompare.compareDates;\n\n      MatomoUrl.updateLocation({\n        ...paramsWithoutCompare,\n        date,\n        period,\n        ...compareParams,\n      });\n    },\n    onApplyClicked() {\n      if (this.selectedPeriod === 'range') {\n        const dateString = this.selectedDateString;\n        if (!dateString) {\n          return;\n        }\n\n        this.periodValue = 'range';\n\n        this.propagateNewUrlParams(dateString, 'range');\n        return;\n      }\n\n      this.setPiwikPeriodAndDate(this.selectedPeriod, this.dateValue!);\n    },\n    updateComparisonValuesFromStore() {\n      this.comparePeriodType = 'previousPeriod';\n      this.compareStartDate = '';\n      this.compareEndDate = '';\n\n      // first is selected period, second is period to compare to\n      const comparePeriods = ComparisonsStore.getPeriodComparisons();\n\n      if (comparePeriods.length < 2) {\n        return;\n      }\n\n      const comparePeriodType = MatomoUrl.parsed.value.comparePeriodType as string;\n\n      if (!COMPARE_PERIOD_TYPES.includes(comparePeriodType)) {\n        return;\n      }\n\n      this.comparePeriodType = comparePeriodType;\n\n      if (this.comparePeriodType !== 'custom' || comparePeriods[1].params.period !== 'range') {\n        return;\n      }\n\n      let periodObj;\n\n      try {\n        periodObj = Periods.parse(\n          comparePeriods[1].params.period,\n          comparePeriods[1].params.date,\n        ) as Range;\n      } catch {\n        return;\n      }\n\n      const [startDate, endDate] = periodObj.getDateRange();\n\n      this.compareStartDate = format(startDate);\n      this.compareEndDate = format(endDate);\n    },\n    updateSelectedValuesFromHash() {\n      const date = MatomoUrl.parsed.value.date as string;\n      const period = MatomoUrl.parsed.value.period as string;\n\n      this.periodValue = period;\n      this.selectedPeriod = period;\n\n      this.dateValue = null;\n      this.startRangeDate = null;\n      this.endRangeDate = null;\n\n      try {\n        Periods.parse(period, date);\n      } catch (e) {\n        return;\n      }\n\n      if (period === 'range') {\n        const periodObj = Periods.get(period).parse(date) as Range;\n\n        const [startDate, endDate] = periodObj.getDateRange();\n        this.dateValue = startDate;\n        this.startRangeDate = format(startDate);\n        this.endRangeDate = format(endDate);\n      } else {\n        this.dateValue = parseDate(date);\n        this.setRangeStartEndFromPeriod(period, date);\n      }\n    },\n    setRangeStartEndFromPeriod(period: string, dateStr: string) {\n      const dateRange = Periods.parse(period, dateStr).getDateRange();\n      this.startRangeDate = format(dateRange[0] < piwikMinDate ? piwikMinDate : dateRange[0]);\n      this.endRangeDate = format(dateRange[1] > piwikMaxDate ? piwikMaxDate : dateRange[1]);\n    },\n    getPeriodDisplayText(periodLabel: string) {\n      return Periods.get(periodLabel).getDisplayText();\n    },\n    onRangeChange(start: string, end: string) {\n      if (!start || !end) {\n        this.isRangeValid = false;\n        return;\n      }\n\n      this.isRangeValid = true;\n      this.startRangeDate = start;\n      this.endRangeDate = end;\n    },\n    isApplyEnabled() {\n      if (this.selectedPeriod === 'range'\n        && !this.isRangeValid\n      ) {\n        return false;\n      }\n\n      if (this.isComparing\n        && this.comparePeriodType === 'custom'\n        && !this.isCompareRangeValid()\n      ) {\n        return false;\n      }\n\n      return true;\n    },\n    closePeriodSelector() {\n      (this.$refs.root as HTMLElement).classList.remove('expanded');\n    },\n    isCompareRangeValid() {\n      try {\n        parseDate(this.compareStartDate);\n      } catch (e) {\n        return false;\n      }\n\n      try {\n        parseDate(this.compareEndDate);\n      } catch (e) {\n        return false;\n      }\n\n      return true;\n    },\n  },\n});\n</script>\n","\nimport { defineComponent, watch } from 'vue';\nimport ExpandOnClick from '../ExpandOnClick/ExpandOnClick';\nimport DateRangePicker from '../DateRangePicker/DateRangePicker.vue';\nimport PeriodDatePicker from '../PeriodDatePicker/PeriodDatePicker.vue';\nimport ActivityIndicator from '../ActivityIndicator/ActivityIndicator.vue';\nimport Matomo from '../Matomo/Matomo';\nimport { translate } from '../translate';\nimport ComparisonsStore from '../Comparisons/Comparisons.store.instance';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\nimport {\n  Periods,\n  parseDate,\n  Range,\n  format,\n} from '../Periods';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\n\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nconst NBSP = Matomo.helper.htmlDecode('&nbsp;');\n\nconst COMPARE_PERIOD_TYPES = ['custom', 'previousPeriod', 'previousYear'];\n\nconst COMPARE_PERIOD_OPTIONS = [\n  { key: 'custom', value: translate('General_Custom') },\n  {\n    key: 'previousPeriod',\n    value: translate('General_PreviousPeriod').replace(/\\s+/, NBSP),\n  },\n  {\n    key: 'previousYear',\n    value: translate('General_PreviousYear').replace(/\\s+/, NBSP),\n  },\n];\n\nconst piwikMinDate = new Date(Matomo.minDateYear, Matomo.minDateMonth - 1, Matomo.minDateDay);\nconst piwikMaxDate = new Date(Matomo.maxDateYear, Matomo.maxDateMonth - 1, Matomo.maxDateDay);\n\nfunction isValidDate(d: any) { // eslint-disable-line @typescript-eslint/no-explicit-any\n  if (Object.prototype.toString.call(d) !== '[object Date]') {\n    return false;\n  }\n\n  return !Number.isNaN(d.getTime());\n}\n\ninterface PeriodSelectorState {\n  comparePeriodDropdownOptions: typeof COMPARE_PERIOD_OPTIONS;\n  periodValue: string;\n  dateValue: Date|null;\n  selectedPeriod: string;\n  startRangeDate: string|null;\n  endRangeDate: string|null;\n  isRangeValid: boolean|null;\n  isLoadingNewPage: boolean;\n  isComparing: null|boolean;\n  comparePeriodType: string;\n  compareStartDate: string;\n  compareEndDate: string;\n}\n\nexport default defineComponent({\n  props: {\n    periods: Array,\n  },\n  components: {\n    DateRangePicker,\n    PeriodDatePicker,\n    Field,\n    ActivityIndicator,\n  },\n  directives: {\n    ExpandOnClick,\n  },\n  data(): PeriodSelectorState {\n    const selectedPeriod = MatomoUrl.parsed.value.period as string;\n    return {\n      comparePeriodDropdownOptions: COMPARE_PERIOD_OPTIONS,\n      periodValue: selectedPeriod,\n      dateValue: null,\n      selectedPeriod,\n      startRangeDate: null,\n      endRangeDate: null,\n      isRangeValid: null,\n      isLoadingNewPage: false,\n      isComparing: null,\n      comparePeriodType: 'previousPeriod',\n      compareStartDate: '',\n      compareEndDate: '',\n    };\n  },\n  mounted() {\n    Matomo.on('hidePeriodSelector', () => {\n      window.$(this.$refs.root as HTMLElement).parent('#periodString').hide();\n    });\n\n    // some widgets might hide the period selector using the event above, so ensure it's\n    // shown again when switching the page\n    Matomo.on('matomoPageChange', () => {\n      window.$(this.$refs.root as HTMLElement).parent('#periodString').show();\n    });\n\n    this.isComparing = ComparisonsStore.isComparingPeriods();\n    watch(() => ComparisonsStore.isComparingPeriods(), (newVal) => {\n      this.isComparing = newVal;\n    });\n\n    this.updateSelectedValuesFromHash();\n    watch(() => MatomoUrl.parsed.value, this.updateSelectedValuesFromHash);\n\n    this.updateComparisonValuesFromStore();\n    watch(() => ComparisonsStore.getPeriodComparisons(), this.updateComparisonValuesFromStore);\n\n    window.initTopControls(); // must be called when a top control changes width\n\n    this.handleZIndexPositionRelativeCompareDropdownIssue();\n  },\n  computed: {\n    currentlyViewingText() {\n      let date;\n      if (this.periodValue === 'range') {\n        if (!this.startRangeDate || !this.endRangeDate) {\n          return translate('General_Error');\n        }\n\n        date = `${this.startRangeDate},${this.endRangeDate}`;\n      } else {\n        if (!this.dateValue) {\n          return translate('General_Error');\n        }\n\n        date = format(this.dateValue);\n      }\n\n      try {\n        return Periods.parse(this.periodValue!, date).getPrettyString();\n      } catch (e) {\n        return translate('General_Error');\n      }\n    },\n    isComparisonEnabled() {\n      return ComparisonsStore.isComparisonEnabled();\n    },\n    periodsFiltered() {\n      return (this.periods as string[] || []).filter(\n        (periodLabel) => Periods.isRecognizedPeriod(periodLabel),\n      );\n    },\n    selectedComparisonParams() {\n      if (!this.isComparing) {\n        return {};\n      }\n\n      if (this.comparePeriodType === 'custom') {\n        return {\n          comparePeriods: ['range'],\n          comparePeriodType: 'custom',\n          compareDates: [`${this.compareStartDate},${this.compareEndDate}`],\n        };\n      }\n\n      if (this.comparePeriodType === 'previousPeriod') {\n        return {\n          comparePeriods: [this.selectedPeriod],\n          comparePeriodType: 'previousPeriod',\n          compareDates: [this.previousPeriodDateToSelectedPeriod],\n        };\n      }\n\n      if (this.comparePeriodType === 'previousYear') {\n        const dateStr = this.selectedPeriod === 'range'\n          ? `${this.startRangeDate},${this.endRangeDate}`\n          : format(this.dateValue!);\n\n        const currentDateRange = Periods.parse(\n          this.selectedPeriod as string,\n          dateStr,\n        ).getDateRange();\n        currentDateRange[0].setFullYear(currentDateRange[0].getFullYear() - 1);\n        currentDateRange[1].setFullYear(currentDateRange[1].getFullYear() - 1);\n\n        if (this.selectedPeriod === 'range') {\n          return {\n            comparePeriods: ['range'],\n            comparePeriodType: 'previousYear',\n            compareDates: [`${format(currentDateRange[0])},${format(currentDateRange[1])}`],\n          };\n        }\n\n        return {\n          comparePeriods: [this.selectedPeriod],\n          comparePeriodType: 'previousYear',\n          compareDates: [format(currentDateRange[0])],\n        };\n      }\n\n      console.warn(`Unknown compare period type: ${this.comparePeriodType}`);\n      return {};\n    },\n    previousPeriodDateToSelectedPeriod() {\n      if (this.selectedPeriod === 'range') {\n        const currentStartRange = parseDate(this.startRangeDate!);\n        const currentEndRange = parseDate(this.endRangeDate!);\n        const newEndDate = Range.getLastNRange('day', 2, currentStartRange).startDate;\n\n        const rangeSize = Math.floor(\n          (currentEndRange.valueOf() - currentStartRange.valueOf()) / 86400000,\n        );\n        const newRange = Range.getLastNRange('day', 1 + rangeSize, newEndDate);\n\n        return `${format(newRange.startDate)},${format(newRange.endDate)}`;\n      }\n\n      const newStartDate = Range.getLastNRange(this.selectedPeriod, 2, this.dateValue!).startDate;\n      return format(newStartDate);\n    },\n    selectedDateString() {\n      if (this.selectedPeriod === 'range') {\n        const dateFrom = this.startRangeDate!;\n        const dateTo = this.endRangeDate!;\n        const oDateFrom = parseDate(dateFrom);\n        const oDateTo = parseDate(dateTo);\n\n        if (!isValidDate(oDateFrom)\n          || !isValidDate(oDateTo)\n          || oDateFrom > oDateTo\n        ) {\n          // TODO: use a notification instead?\n          window.$('#alert')\n            .find('h2')\n            .text(translate('General_InvalidDateRange'));\n          Matomo.helper.modalConfirm('#alert', {});\n          return null;\n        }\n\n        return `${dateFrom},${dateTo}`;\n      }\n\n      return format(this.dateValue!);\n    },\n  },\n  methods: {\n    handleZIndexPositionRelativeCompareDropdownIssue() {\n      const $element = window.$(this.$refs.root as HTMLElement);\n      $element.on('focus', '#comparePeriodToDropdown .select-dropdown', () => {\n        $element.addClass('compare-dropdown-open');\n      }).on('blur', '#comparePeriodToDropdown .select-dropdown', () => {\n        $element.removeClass('compare-dropdown-open');\n      });\n    },\n    changeViewedPeriod(period: string) {\n      // only change period if it's different from what's being shown currently\n      if (period === this.periodValue) {\n        return;\n      }\n\n      // can't just change to a range period, w/o setting two new dates\n      if (period === 'range') {\n        return;\n      }\n\n      this.setPiwikPeriodAndDate(period, this.dateValue!);\n    },\n    setPiwikPeriodAndDate(period: string, date: Date) {\n      this.periodValue = period;\n      this.selectedPeriod = period;\n      this.dateValue = date;\n\n      const currentDateString = format(date);\n      this.setRangeStartEndFromPeriod(period, currentDateString);\n\n      this.propagateNewUrlParams(currentDateString, this.selectedPeriod);\n\n      window.initTopControls();\n    },\n    propagateNewUrlParams(date: string, period: string) {\n      const compareParams = this.selectedComparisonParams;\n\n      let baseParams: Record<string, unknown>;\n      if (Matomo.helper.isReportingPage()) {\n        this.closePeriodSelector();\n        baseParams = MatomoUrl.hashParsed.value;\n      } else {\n        this.isLoadingNewPage = true;\n        baseParams = MatomoUrl.parsed.value;\n      }\n\n      // get params without comparePeriods/compareSegments/compareDates\n      const paramsWithoutCompare = { ...baseParams };\n      delete paramsWithoutCompare.comparePeriods;\n      delete paramsWithoutCompare.comparePeriodType;\n      delete paramsWithoutCompare.compareDates;\n\n      MatomoUrl.updateLocation({\n        ...paramsWithoutCompare,\n        date,\n        period,\n        ...compareParams,\n      });\n    },\n    onApplyClicked() {\n      if (this.selectedPeriod === 'range') {\n        const dateString = this.selectedDateString;\n        if (!dateString) {\n          return;\n        }\n\n        this.periodValue = 'range';\n\n        this.propagateNewUrlParams(dateString, 'range');\n        return;\n      }\n\n      this.setPiwikPeriodAndDate(this.selectedPeriod, this.dateValue!);\n    },\n    updateComparisonValuesFromStore() {\n      this.comparePeriodType = 'previousPeriod';\n      this.compareStartDate = '';\n      this.compareEndDate = '';\n\n      // first is selected period, second is period to compare to\n      const comparePeriods = ComparisonsStore.getPeriodComparisons();\n\n      if (comparePeriods.length < 2) {\n        return;\n      }\n\n      const comparePeriodType = MatomoUrl.parsed.value.comparePeriodType as string;\n\n      if (!COMPARE_PERIOD_TYPES.includes(comparePeriodType)) {\n        return;\n      }\n\n      this.comparePeriodType = comparePeriodType;\n\n      if (this.comparePeriodType !== 'custom' || comparePeriods[1].params.period !== 'range') {\n        return;\n      }\n\n      let periodObj;\n\n      try {\n        periodObj = Periods.parse(\n          comparePeriods[1].params.period,\n          comparePeriods[1].params.date,\n        ) as Range;\n      } catch {\n        return;\n      }\n\n      const [startDate, endDate] = periodObj.getDateRange();\n\n      this.compareStartDate = format(startDate);\n      this.compareEndDate = format(endDate);\n    },\n    updateSelectedValuesFromHash() {\n      const date = MatomoUrl.parsed.value.date as string;\n      const period = MatomoUrl.parsed.value.period as string;\n\n      this.periodValue = period;\n      this.selectedPeriod = period;\n\n      this.dateValue = null;\n      this.startRangeDate = null;\n      this.endRangeDate = null;\n\n      try {\n        Periods.parse(period, date);\n      } catch (e) {\n        return;\n      }\n\n      if (period === 'range') {\n        const periodObj = Periods.get(period).parse(date) as Range;\n\n        const [startDate, endDate] = periodObj.getDateRange();\n        this.dateValue = startDate;\n        this.startRangeDate = format(startDate);\n        this.endRangeDate = format(endDate);\n      } else {\n        this.dateValue = parseDate(date);\n        this.setRangeStartEndFromPeriod(period, date);\n      }\n    },\n    setRangeStartEndFromPeriod(period: string, dateStr: string) {\n      const dateRange = Periods.parse(period, dateStr).getDateRange();\n      this.startRangeDate = format(dateRange[0] < piwikMinDate ? piwikMinDate : dateRange[0]);\n      this.endRangeDate = format(dateRange[1] > piwikMaxDate ? piwikMaxDate : dateRange[1]);\n    },\n    getPeriodDisplayText(periodLabel: string) {\n      return Periods.get(periodLabel).getDisplayText();\n    },\n    onRangeChange(start: string, end: string) {\n      if (!start || !end) {\n        this.isRangeValid = false;\n        return;\n      }\n\n      this.isRangeValid = true;\n      this.startRangeDate = start;\n      this.endRangeDate = end;\n    },\n    isApplyEnabled() {\n      if (this.selectedPeriod === 'range'\n        && !this.isRangeValid\n      ) {\n        return false;\n      }\n\n      if (this.isComparing\n        && this.comparePeriodType === 'custom'\n        && !this.isCompareRangeValid()\n      ) {\n        return false;\n      }\n\n      return true;\n    },\n    closePeriodSelector() {\n      (this.$refs.root as HTMLElement).classList.remove('expanded');\n    },\n    isCompareRangeValid() {\n      try {\n        parseDate(this.compareStartDate);\n      } catch (e) {\n        return false;\n      }\n\n      try {\n        parseDate(this.compareEndDate);\n      } catch (e) {\n        return false;\n      }\n\n      return true;\n    },\n  },\n});\n","import { render } from \"./PeriodSelector.vue?vue&type=template&id=20c87378\"\nimport script from \"./PeriodSelector.vue?vue&type=script&lang=ts\"\nexport * from \"./PeriodSelector.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"reportingMenu\">\n    <ul\n      class=\"navbar hide-on-med-and-down\"\n      role=\"menu\"\n      :aria-label=\"translate('CoreHome_MainNavigation')\"\n    >\n      <li\n        class=\"menuTab\"\n        role=\"menuitem\"\n        v-for=\"category in menu\"\n        :class=\"{ 'active': category.id === activeCategory }\"\n        :key=\"category.id\"\n        :data-category-id=\"category.id\"\n      >\n        <component\n          v-if=\"category.component\"\n          :is=\"category.component\"\n          @action=\"loadCategory(category)\"\n        ></component>\n        <a\n          v-if=\"!category.component\"\n          class=\"item\"\n          tabindex=\"5\"\n          href=\"\"\n          @click.prevent=\"loadCategory(category)\"\n        >\n          <span\n            :class=\"`menu-icon ${category.icon ? category.icon :\n              (category.subcategories && category.id === activeCategory ?\n                'icon-chevron-down' : 'icon-chevron-right')}`\"\n          />{{ category.name }}\n          <span class=\"hidden\">\n            {{ translate('CoreHome_Menu') }}\n          </span>\n        </a>\n        <ul v-if=\"!category.component\" role=\"menu\">\n          <li\n            role=\"menuitem\"\n            :class=\"{\n              'active': (subcategory.id === displayedSubcategory\n                || (subcategory.isGroup && activeSubsubcategory === displayedSubcategory)\n              ) && category.id === displayedCategory,\n            }\"\n            v-for=\"subcategory in category.subcategories\"\n            :key=\"subcategory.id\"\n          >\n            <MenuItemsDropdown\n              v-if=\"subcategory.isGroup\"\n              :show-search=\"true\"\n              :menu-title=\"htmlEntities(subcategory.name)\"\n            >\n              <a\n                class=\"item\"\n                tabindex=\"5\"\n                :class=\"{\n                  active: subcat.id === activeSubsubcategory\n                    && subcategory.id === displayedSubcategory\n                    && category.id === displayedCategory,\n                }\"\n                :href=\"`#?${makeUrl(category, subcat)}`\"\n                @click=\"loadSubcategory(category, subcat, $event)\"\n                v-for=\"subcat in subcategory.subcategories\"\n                :title=\"subcat.tooltip\"\n                :key=\"subcat.id\"\n              >\n                {{ subcat.name }}\n              </a>\n            </MenuItemsDropdown>\n            <a\n              v-if=\"!subcategory.isGroup\"\n              :href=\"`#?${makeUrl(category, subcategory)}`\"\n              class=\"item\"\n              @click=\"loadSubcategory(category, subcategory, $event)\"\n            >\n              {{ subcategory.name }}\n            </a>\n            <a\n              class=\"item-help-icon\"\n              tabindex=\"5\"\n              href=\"javascript:\"\n              v-if=\"subcategory.help\"\n              @click=\"showHelp(category, subcategory, $event)\"\n              :class=\"{active: helpShownCategory\n                && helpShownCategory.subcategory === subcategory.id\n                && helpShownCategory.category === category.id\n                && subcategory.help}\"\n            >\n              <span class=\"icon-help\" />\n            </a>\n          </li>\n        </ul>\n      </li>\n    </ul>\n    <ul\n      id=\"mobile-left-menu\"\n      class=\"sidenav sidenav--reporting-menu-mobile hide-on-large-only\"\n    >\n      <li\n        class=\"no-padding\"\n        v-for=\"category in menu\"\n        :key=\"category.id\"\n        :data-category-id=\"category.id\"\n      >\n        <component\n          v-if=\"category.component\"\n          :is=\"category.component\"\n          @action=\"loadCategory(category)\"\n        ></component>\n        <ul\n          v-if=\"!category.component\"\n          class=\"collapsible collapsible-accordion\"\n          v-side-nav=\"{ activator: sideNavActivator }\"\n        >\n          <li>\n            <a class=\"collapsible-header\">\n              <i :class=\"category.icon ? category.icon : 'icon-chevron-down'\" />{{ category.name }}\n            </a>\n            <div class=\"collapsible-body\">\n              <ul>\n                <li v-for=\"subcategory in category.subcategories\" :key=\"subcategory.id\">\n                  <template v-if=\"subcategory.isGroup\">\n                    <a\n                      @click=\"loadSubcategory(category, subcat)\"\n                      :href=\"`#?${makeUrl(category, subcat)}`\"\n                      v-for=\"subcat in subcategory.subcategories\"\n                      :key=\"subcat.id\"\n                    >\n                      {{ subcat.name }}\n                    </a>\n                  </template>\n                  <template v-if=\"!subcategory.isGroup\">\n                    <a\n                      @click=\"loadSubcategory(category, subcategory)\"\n                      :href=\"`#?${makeUrl(category, subcategory)}`\"\n                    >\n                      {{ subcategory.name }}\n                    </a>\n                  </template>\n                </li>\n              </ul>\n            </div>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, watch } from 'vue';\nimport MenuItemsDropdown from '../MenuItemsDropdown/MenuItemsDropdown.vue';\nimport SideNav from '../SideNav/SideNav';\nimport { NotificationsStore } from '../Notification';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport ReportingMenuStoreInstance from './ReportingMenu.store';\nimport Matomo from '../Matomo/Matomo';\nimport { translate } from '../translate';\nimport WidgetsStoreInstance from '../Widget/Widgets.store';\nimport { Category, CategoryContainer } from './Category';\nimport { Subcategory, SubcategoryContainer } from './Subcategory';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\nconst REPORTING_HELP_NOTIFICATION_ID = 'reportingmenu-help';\n\ninterface ReportingMenuState {\n  showSubcategoryHelpOnLoad: { category: Category, subcategory: Subcategory } | null;\n  initialLoad: boolean | null;\n  helpShownCategory: { category: string, subcategory: string } | null;\n}\n\nexport default defineComponent({\n  components: {\n    MenuItemsDropdown,\n  },\n  directives: {\n    SideNav,\n  },\n  props: {},\n  data(): ReportingMenuState {\n    return {\n      showSubcategoryHelpOnLoad: null,\n      initialLoad: true,\n      helpShownCategory: null,\n    };\n  },\n  computed: {\n    sideNavActivator() {\n      return document.querySelector('nav .activateLeftMenu');\n    },\n    menu() {\n      const categories = ReportingMenuStoreInstance.menu.value;\n\n      categories.forEach((category) => {\n        if (category.widget && category.widget.indexOf('.') > 0) {\n          const [widgetPlugin, widgetComponent] = category.widget.split('.');\n          category.component = useExternalPluginComponent(widgetPlugin, widgetComponent);\n        }\n      });\n\n      return categories;\n    },\n    activeCategory() {\n      return ReportingMenuStoreInstance.activeCategory.value;\n    },\n    activeSubcategory() {\n      return ReportingMenuStoreInstance.activeSubcategory.value;\n    },\n    activeSubsubcategory() {\n      return ReportingMenuStoreInstance.activeSubsubcategory.value;\n    },\n    displayedCategory() {\n      return MatomoUrl.parsed.value.category;\n    },\n    displayedSubcategory() {\n      return MatomoUrl.parsed.value.subcategory;\n    },\n  },\n  created() {\n    ReportingMenuStoreInstance.fetchMenuItems().then((menu) => {\n      if (!MatomoUrl.parsed.value.subcategory) {\n        const categoryToLoad = menu[0];\n        const subcategoryToLoad = (categoryToLoad as CategoryContainer).subcategories[0];\n\n        // load first, initial page if no subcategory is present\n        ReportingMenuStoreInstance.enterSubcategory(categoryToLoad, subcategoryToLoad);\n        this.propagateUrlChange(categoryToLoad, subcategoryToLoad);\n      }\n    });\n\n    watch(() => MatomoUrl.parsed.value, (query) => {\n      const found = ReportingMenuStoreInstance.findSubcategory(\n        query.category as string,\n        query.subcategory as string,\n      );\n\n      ReportingMenuStoreInstance.enterSubcategory(\n        found.category,\n        found.subcategory,\n        found.subsubcategory,\n      );\n    });\n\n    Matomo.on('matomoPageChange', () => {\n      if (!this.initialLoad) {\n        window.globalAjaxQueue.abort();\n      }\n\n      this.helpShownCategory = null;\n\n      if (this.showSubcategoryHelpOnLoad) {\n        this.showHelp(\n          this.showSubcategoryHelpOnLoad.category,\n          this.showSubcategoryHelpOnLoad.subcategory,\n        );\n        this.showSubcategoryHelpOnLoad = null;\n      }\n\n      window.$('#loadingError,#loadingRateLimitError').hide();\n\n      this.initialLoad = false;\n    });\n\n    Matomo.on('updateReportingMenu', () => {\n      ReportingMenuStoreInstance.reloadMenuItems().then(() => {\n        const category = MatomoUrl.parsed.value.category as string;\n        const subcategory = MatomoUrl.parsed.value.subcategory as string;\n\n        // we need to make sure to select same categories again\n        if (category && subcategory) {\n          const found = ReportingMenuStoreInstance.findSubcategory(category, subcategory);\n          if (found.category) {\n            ReportingMenuStoreInstance.enterSubcategory(\n              found.category,\n              found.subcategory,\n              found.subsubcategory,\n            );\n          }\n        }\n      });\n\n      WidgetsStoreInstance.reloadAvailableWidgets();\n    });\n  },\n  methods: {\n    propagateUrlChange(category: Category, subcategory: Subcategory) {\n      const queryParams = MatomoUrl.parsed.value;\n      if (queryParams.category === category.id && queryParams.subcategory === subcategory.id) {\n        // we need to manually trigger change as URL would not change and therefore page would not\n        // be reloaded\n        this.loadSubcategory(category, subcategory);\n      } else {\n        MatomoUrl.updateHash({\n          ...MatomoUrl.hashParsed.value,\n          category: category.id,\n          subcategory: subcategory.id,\n        });\n      }\n    },\n    loadCategory(category: Category) {\n      NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n\n      const isActive = ReportingMenuStoreInstance.toggleCategory(category);\n\n      // one subcategory or a widget and some subcategories to allow to load the category\n      const { subcategories } = category as SubcategoryContainer;\n      const categoryCanLoad = (subcategories && subcategories.length === 1)\n        || (category.widget && subcategories && subcategories.length);\n\n      if (isActive && categoryCanLoad) {\n        this.helpShownCategory = null;\n\n        const subcategory = (category as SubcategoryContainer).subcategories[0];\n        this.propagateUrlChange(category, subcategory);\n      }\n    },\n    loadSubcategory(category: Category, subcategory: Subcategory, event?: MouseEvent) {\n      if (event\n        && (event.shiftKey || event.ctrlKey || event.metaKey)\n      ) {\n        return;\n      }\n\n      NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n\n      if (subcategory\n        && subcategory.id === MatomoUrl.parsed.value.subcategory\n        && category.id === MatomoUrl.parsed.value.category\n      ) {\n        this.helpShownCategory = null;\n\n        // this menu item is already active, a location change success would not be triggered,\n        // instead trigger an event (after the URL changes)\n        setTimeout(() => {\n          Matomo.postEvent('loadPage', category.id, subcategory.id);\n        });\n      }\n    },\n    makeUrl(category: Category, subcategory: Subcategory) {\n      const {\n        idSite,\n        period,\n        date,\n        segment,\n        comparePeriods,\n        compareDates,\n        compareSegments,\n      } = MatomoUrl.parsed.value;\n\n      return MatomoUrl.stringify({\n        idSite,\n        period,\n        date,\n        segment,\n        comparePeriods,\n        compareDates,\n        compareSegments,\n        category: category.id,\n        subcategory: subcategory.id,\n      });\n    },\n    htmlEntities(v: string) {\n      return Matomo.helper.htmlEntities(v);\n    },\n    showHelp(category: Category, subcategory: Subcategory, event?: Event) {\n      const parsedUrl = MatomoUrl.parsed.value;\n      const currentCategory = parsedUrl.category;\n      const currentSubcategory = parsedUrl.subcategory;\n\n      if ((currentCategory !== category.id\n        || currentSubcategory !== subcategory.id)\n        && event\n      ) {\n        this.showSubcategoryHelpOnLoad = { category, subcategory };\n        MatomoUrl.updateHash({\n          ...MatomoUrl.hashParsed.value,\n          category: category.id,\n          subcategory: subcategory.id,\n        });\n        return;\n      }\n\n      if (this.helpShownCategory\n        && category.id === this.helpShownCategory.category\n        && subcategory.id === this.helpShownCategory.subcategory\n      ) {\n        NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n        this.helpShownCategory = null;\n        return;\n      }\n\n      const prefixText = translate('CoreHome_ReportingCategoryHelpPrefix',\n        category.name, subcategory.name);\n      const prefix = `<strong>${prefixText}</strong><br/>`;\n\n      NotificationsStore.show({\n        context: 'info',\n        id: REPORTING_HELP_NOTIFICATION_ID,\n        type: 'help',\n        noclear: true,\n        class: 'help-notification',\n        message: prefix + subcategory.help,\n        placeat: '#notificationContainer',\n        prepend: true,\n      });\n\n      this.helpShownCategory = {\n        category: category.id,\n        subcategory: subcategory.id,\n      };\n    },\n  },\n});\n</script>\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport {\n  reactive,\n  computed, readonly, DeepReadonly,\n} from 'vue';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport { Widget } from '../Widget/types';\n\ninterface CategoryRef {\n  id: string;\n  name: string;\n}\n\ninterface SubcategoryRef {\n  id: string;\n  name: string;\n}\n\nexport interface Page {\n  category: CategoryRef;\n  subcategory: SubcategoryRef;\n  widgets: Widget[];\n}\n\ninterface ReportingPagesStoreState {\n  pages: Page[];\n}\n\nexport class ReportingPagesStore {\n  private privateState = reactive<ReportingPagesStoreState>({\n    pages: [],\n  });\n\n  private state = computed(() => readonly(this.privateState));\n\n  private fetchAllPagesPromise?: Promise<DeepReadonly<Page[]>>;\n\n  readonly pages = computed(() => this.state.value.pages);\n\n  findPageInCategory(categoryId: string): DeepReadonly<Page>|undefined {\n    // happens when user switches between sites, in this case check if the same category exists and\n    // if so, select first entry from that category\n    return this.pages.value.find((p) => p\n      && p.category && p.category.id === categoryId && p.subcategory && p.subcategory.id);\n  }\n\n  findPage(categoryId: string, subcategoryId: string): DeepReadonly<Page>|undefined {\n    return this.pages.value.find((p) => p\n      && p.category && p.subcategory && p.category.id === categoryId\n      && `${p.subcategory.id}` === subcategoryId);\n  }\n\n  reloadAllPages(): Promise<ReportingPagesStore['pages']['value']> {\n    delete this.fetchAllPagesPromise;\n    return this.getAllPages();\n  }\n\n  getAllPages(): Promise<ReportingPagesStore['pages']['value']> {\n    if (!this.fetchAllPagesPromise) {\n      this.fetchAllPagesPromise = AjaxHelper.fetch({\n        method: 'API.getReportPagesMetadata',\n        filter_limit: '-1',\n      }).then((response) => {\n        this.privateState.pages = response;\n        return this.pages.value;\n      });\n    }\n\n    return this.fetchAllPagesPromise.then(() => this.pages.value);\n  }\n}\n\nexport default new ReportingPagesStore();\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nexport interface Orderable {\n  order: number;\n}\n\nexport function sortOrderables<T extends Orderable>(menu?: ReadonlyArray<T>): T[] {\n  const result = [...(menu || [])];\n  result.sort((lhs, rhs) => {\n    if (lhs.order < rhs.order) {\n      return -1;\n    }\n\n    if (lhs.order > rhs.order) {\n      return 1;\n    }\n\n    return 0;\n  });\n  return result;\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { defineAsyncComponent } from 'vue';\nimport { Orderable } from '../Orderable';\nimport { Subcategory } from './Subcategory';\n\nexport interface Category extends Orderable {\n  id: string;\n  name: string;\n  icon?: string;\n  tooltip?: string;\n  widget?: string;\n  component?: typeof defineAsyncComponent;\n\n  /**\n   * @deprecated exists for BC, should be removed in Matomo 5\n   */\n  active?: boolean;\n}\n\nexport interface CategoryContainer extends Category {\n  subcategories: Subcategory[];\n}\n\nexport function getCategoryChildren(category: Category): Subcategory[] {\n  const container = category as CategoryContainer;\n  if (container.subcategories) {\n    return container.subcategories;\n  }\n  return [];\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { Orderable } from '../Orderable';\n\nexport interface Subcategory extends Orderable {\n  id: string;\n  name: string;\n  isGroup: boolean;\n  icon?: string;\n  tooltip?: string;\n  help?: string;\n\n  /**\n   * @deprecated exists for BC, should be removed in Matomo 5\n   */\n  active?: boolean;\n}\n\nexport interface SubcategoryContainer extends Subcategory {\n  subcategories: Subcategory[];\n}\n\nexport function getSubcategoryChildren(subcategory: Subcategory): Subcategory[] {\n  const container = subcategory as SubcategoryContainer;\n  if (container.subcategories) {\n    return container.subcategories;\n  }\n  return [];\n}\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { computed, reactive, readonly } from 'vue';\nimport ReportingPagesStoreInstance from '../ReportingPages/ReportingPages.store';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { translate } from '../translate';\nimport { sortOrderables } from '../Orderable';\nimport { Category, CategoryContainer, getCategoryChildren } from './Category';\nimport { getSubcategoryChildren, Subcategory, SubcategoryContainer } from './Subcategory';\n\ninterface ReportingMenuStoreState {\n  activeCategoryId?: string|null;\n  activeSubcategoryId: string|null;\n  activeSubsubcategoryId: string|null;\n}\n\ninterface SubcategoryFindResult {\n  category?: Category;\n  subcategory?: Subcategory;\n  subsubcategory?: Subcategory;\n}\n\nfunction isNumeric(text: string) {\n  const n = parseFloat(text);\n  return !Number.isNaN(n) && Number.isFinite(n);\n}\n\nexport class ReportingMenuStore {\n  private privateState = reactive<ReportingMenuStoreState>({\n    activeSubcategoryId: null,\n    activeSubsubcategoryId: null,\n  });\n\n  private state = computed(() => readonly(this.privateState));\n\n  readonly activeCategory = computed(\n    () => (typeof this.state.value.activeCategoryId !== 'undefined'\n      ? this.state.value.activeCategoryId\n      : MatomoUrl.parsed.value.category as string),\n  );\n\n  readonly activeSubcategory = computed(\n    () => this.state.value.activeSubcategoryId || MatomoUrl.parsed.value.subcategory as string,\n  );\n\n  readonly activeSubsubcategory = computed(() => {\n    const manuallySetId = this.state.value.activeSubsubcategoryId;\n    if (manuallySetId) {\n      return manuallySetId;\n    }\n\n    // default to activeSubcategory if the activeSubcategory is part of a group\n    const foundCategory = this.findSubcategory(\n      this.activeCategory.value,\n      this.activeSubcategory.value,\n    );\n\n    if (foundCategory.subsubcategory\n      && foundCategory.subsubcategory.id === this.activeSubcategory.value\n    ) {\n      return foundCategory.subsubcategory.id;\n    }\n\n    return null;\n  });\n\n  readonly menu = computed(() => this.buildMenuFromPages());\n\n  fetchMenuItems(): Promise<ReportingMenuStore['menu']['value']> {\n    return ReportingPagesStoreInstance.getAllPages().then(() => this.menu.value);\n  }\n\n  reloadMenuItems(): Promise<ReportingMenuStore['menu']['value']> {\n    return ReportingPagesStoreInstance.reloadAllPages().then(() => this.menu.value);\n  }\n\n  findSubcategory(categoryId: string|null, subcategoryId: string): SubcategoryFindResult {\n    let foundCategory: Category|undefined = undefined;\n    let foundSubcategory: Subcategory|undefined = undefined;\n    let foundSubSubcategory: Subcategory|undefined = undefined;\n\n    this.menu.value.forEach((category) => {\n      if (category.id !== categoryId) {\n        return;\n      }\n\n      (getCategoryChildren(category) || []).forEach((subcategory) => {\n        if (subcategory.id === subcategoryId) {\n          foundCategory = category;\n          foundSubcategory = subcategory;\n        }\n\n        if (subcategory.isGroup) {\n          (getSubcategoryChildren(subcategory) || []).forEach((subcat) => {\n            if (subcat.id === subcategoryId) {\n              foundCategory = category;\n              foundSubcategory = subcategory;\n              foundSubSubcategory = subcat;\n            }\n          });\n        }\n      });\n    });\n\n    return {\n      category: foundCategory,\n      subcategory: foundSubcategory,\n      subsubcategory: foundSubSubcategory,\n    };\n  }\n\n  private buildMenuFromPages() {\n    const menu: Category[] = [];\n\n    const displayedCategory = MatomoUrl.parsed.value.category as string;\n    const displayedSubcategory = MatomoUrl.parsed.value.subcategory as string;\n\n    const pages = ReportingPagesStoreInstance.pages.value;\n\n    const categoriesHandled: Record<string, boolean> = {};\n    pages.forEach((page) => {\n      const category = { ...page.category } as Category;\n      const categoryId = category.id;\n      const isCategoryDisplayed = categoryId === displayedCategory;\n\n      if (categoriesHandled[categoryId]) {\n        return;\n      }\n\n      categoriesHandled[categoryId] = true;\n\n      (category as CategoryContainer).subcategories = [];\n\n      let categoryGroups: Subcategory|null = null;\n\n      const pagesWithCategory = pages.filter((p) => p.category.id === categoryId);\n      pagesWithCategory.forEach((p) => {\n        const subcategory = { ...p.subcategory } as Subcategory;\n        const isSubcategoryDisplayed = subcategory.id === displayedSubcategory\n          && isCategoryDisplayed;\n\n        if (p.widgets && p.widgets[0] && isNumeric(p.subcategory.id)) {\n          // we handle a goal or something like it\n          if (!categoryGroups) {\n            categoryGroups = { ...subcategory } as Subcategory;\n            categoryGroups.name = translate('CoreHome_ChooseX', [category.name]);\n            categoryGroups.isGroup = true;\n            (categoryGroups as SubcategoryContainer).subcategories = [];\n            categoryGroups.order = 10;\n          }\n\n          if (isSubcategoryDisplayed) {\n            categoryGroups.name = subcategory.name;\n          }\n\n          const entityId = subcategory.id;\n          subcategory.tooltip = `${subcategory.name} (id = ${entityId})`;\n\n          (categoryGroups as SubcategoryContainer).subcategories.push(subcategory);\n          return;\n        }\n\n        (category as CategoryContainer).subcategories.push(subcategory);\n      });\n\n      if (categoryGroups\n        && (categoryGroups as SubcategoryContainer).subcategories\n        && (categoryGroups as SubcategoryContainer).subcategories.length <= 5\n      ) {\n        (categoryGroups as SubcategoryContainer).subcategories.forEach(\n          (sub) => (category as CategoryContainer).subcategories.push(sub),\n        );\n      } else if (categoryGroups) {\n        (category as CategoryContainer).subcategories.push(categoryGroups);\n      }\n\n      (category as CategoryContainer).subcategories = sortOrderables(getCategoryChildren(category));\n\n      menu.push(category);\n    });\n\n    return sortOrderables(menu);\n  }\n\n  toggleCategory(category: Category): boolean {\n    this.privateState.activeSubcategoryId = null;\n    this.privateState.activeSubsubcategoryId = null;\n\n    if (this.activeCategory.value === category.id) {\n      this.privateState.activeCategoryId = null;\n      return false;\n    }\n\n    this.privateState.activeCategoryId = category.id;\n    return true;\n  }\n\n  enterSubcategory(\n    category?: Category,\n    subcategory?: Subcategory,\n    subsubcategory?: Subcategory,\n  ): void {\n    if (!category || !subcategory) {\n      return;\n    }\n\n    this.privateState.activeCategoryId = category.id;\n    this.privateState.activeSubcategoryId = subcategory.id;\n\n    if (subsubcategory) {\n      this.privateState.activeSubsubcategoryId = subsubcategory.id;\n    }\n  }\n}\n\nexport default new ReportingMenuStore();\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport {\n  reactive,\n  readonly,\n  computed,\n  DeepReadonly,\n} from 'vue';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { Widget, WidgetContainer } from './types';\n\ninterface WidgetsStoreState {\n  isFetchedFirstTime: boolean;\n  categorizedWidgets: Record<string, Widget[]>;\n}\n\nexport function getWidgetChildren(widget: Widget): Widget[] {\n  const container = widget as WidgetContainer;\n  if (container.widgets) {\n    return container.widgets;\n  }\n  return [];\n}\n\nclass WidgetsStore {\n  private privateState = reactive<WidgetsStoreState>({\n    isFetchedFirstTime: false,\n    categorizedWidgets: {},\n  });\n\n  private state = computed((): DeepReadonly<WidgetsStoreState> => {\n    if (!this.privateState.isFetchedFirstTime) {\n      // initiating a side effect in a computed property seems wrong, but it needs to be\n      // executed after knowing a user's logged in and it will succeed.\n      this.fetchAvailableWidgets();\n    }\n\n    return readonly(this.privateState);\n  });\n\n  readonly widgets = computed(() => this.state.value.categorizedWidgets);\n\n  private fetchAvailableWidgets(): Promise<WidgetsStore['widgets']['value']> {\n    // if there's no idSite, don't make the request since it will just fail\n    if (!MatomoUrl.parsed.value.idSite) {\n      return Promise.resolve(this.widgets.value);\n    }\n\n    this.privateState.isFetchedFirstTime = true;\n    return new Promise((resolve, reject) => {\n      try {\n        window.widgetsHelper.getAvailableWidgets((widgets: Record<string, unknown[]>) => {\n          const casted = widgets as unknown as Record<string, Widget[]>;\n          this.privateState.categorizedWidgets = casted;\n          resolve(this.widgets.value);\n        });\n      } catch (e) {\n        reject(e);\n      }\n    });\n  }\n\n  reloadAvailableWidgets(): Promise<WidgetsStore['widgets']['value']> {\n    if (typeof window.widgetsHelper === 'object' && window.widgetsHelper.availableWidgets) {\n      // lets also update widgetslist so will be easier to update list of available widgets in\n      // dashboard selector immediately\n      delete window.widgetsHelper.availableWidgets;\n    }\n\n    return this.fetchAvailableWidgets();\n  }\n}\n\nexport default new WidgetsStore();\n","\nimport { defineComponent, watch } from 'vue';\nimport MenuItemsDropdown from '../MenuItemsDropdown/MenuItemsDropdown.vue';\nimport SideNav from '../SideNav/SideNav';\nimport { NotificationsStore } from '../Notification';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport ReportingMenuStoreInstance from './ReportingMenu.store';\nimport Matomo from '../Matomo/Matomo';\nimport { translate } from '../translate';\nimport WidgetsStoreInstance from '../Widget/Widgets.store';\nimport { Category, CategoryContainer } from './Category';\nimport { Subcategory, SubcategoryContainer } from './Subcategory';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\n\nconst REPORTING_HELP_NOTIFICATION_ID = 'reportingmenu-help';\n\ninterface ReportingMenuState {\n  showSubcategoryHelpOnLoad: { category: Category, subcategory: Subcategory } | null;\n  initialLoad: boolean | null;\n  helpShownCategory: { category: string, subcategory: string } | null;\n}\n\nexport default defineComponent({\n  components: {\n    MenuItemsDropdown,\n  },\n  directives: {\n    SideNav,\n  },\n  props: {},\n  data(): ReportingMenuState {\n    return {\n      showSubcategoryHelpOnLoad: null,\n      initialLoad: true,\n      helpShownCategory: null,\n    };\n  },\n  computed: {\n    sideNavActivator() {\n      return document.querySelector('nav .activateLeftMenu');\n    },\n    menu() {\n      const categories = ReportingMenuStoreInstance.menu.value;\n\n      categories.forEach((category) => {\n        if (category.widget && category.widget.indexOf('.') > 0) {\n          const [widgetPlugin, widgetComponent] = category.widget.split('.');\n          category.component = useExternalPluginComponent(widgetPlugin, widgetComponent);\n        }\n      });\n\n      return categories;\n    },\n    activeCategory() {\n      return ReportingMenuStoreInstance.activeCategory.value;\n    },\n    activeSubcategory() {\n      return ReportingMenuStoreInstance.activeSubcategory.value;\n    },\n    activeSubsubcategory() {\n      return ReportingMenuStoreInstance.activeSubsubcategory.value;\n    },\n    displayedCategory() {\n      return MatomoUrl.parsed.value.category;\n    },\n    displayedSubcategory() {\n      return MatomoUrl.parsed.value.subcategory;\n    },\n  },\n  created() {\n    ReportingMenuStoreInstance.fetchMenuItems().then((menu) => {\n      if (!MatomoUrl.parsed.value.subcategory) {\n        const categoryToLoad = menu[0];\n        const subcategoryToLoad = (categoryToLoad as CategoryContainer).subcategories[0];\n\n        // load first, initial page if no subcategory is present\n        ReportingMenuStoreInstance.enterSubcategory(categoryToLoad, subcategoryToLoad);\n        this.propagateUrlChange(categoryToLoad, subcategoryToLoad);\n      }\n    });\n\n    watch(() => MatomoUrl.parsed.value, (query) => {\n      const found = ReportingMenuStoreInstance.findSubcategory(\n        query.category as string,\n        query.subcategory as string,\n      );\n\n      ReportingMenuStoreInstance.enterSubcategory(\n        found.category,\n        found.subcategory,\n        found.subsubcategory,\n      );\n    });\n\n    Matomo.on('matomoPageChange', () => {\n      if (!this.initialLoad) {\n        window.globalAjaxQueue.abort();\n      }\n\n      this.helpShownCategory = null;\n\n      if (this.showSubcategoryHelpOnLoad) {\n        this.showHelp(\n          this.showSubcategoryHelpOnLoad.category,\n          this.showSubcategoryHelpOnLoad.subcategory,\n        );\n        this.showSubcategoryHelpOnLoad = null;\n      }\n\n      window.$('#loadingError,#loadingRateLimitError').hide();\n\n      this.initialLoad = false;\n    });\n\n    Matomo.on('updateReportingMenu', () => {\n      ReportingMenuStoreInstance.reloadMenuItems().then(() => {\n        const category = MatomoUrl.parsed.value.category as string;\n        const subcategory = MatomoUrl.parsed.value.subcategory as string;\n\n        // we need to make sure to select same categories again\n        if (category && subcategory) {\n          const found = ReportingMenuStoreInstance.findSubcategory(category, subcategory);\n          if (found.category) {\n            ReportingMenuStoreInstance.enterSubcategory(\n              found.category,\n              found.subcategory,\n              found.subsubcategory,\n            );\n          }\n        }\n      });\n\n      WidgetsStoreInstance.reloadAvailableWidgets();\n    });\n  },\n  methods: {\n    propagateUrlChange(category: Category, subcategory: Subcategory) {\n      const queryParams = MatomoUrl.parsed.value;\n      if (queryParams.category === category.id && queryParams.subcategory === subcategory.id) {\n        // we need to manually trigger change as URL would not change and therefore page would not\n        // be reloaded\n        this.loadSubcategory(category, subcategory);\n      } else {\n        MatomoUrl.updateHash({\n          ...MatomoUrl.hashParsed.value,\n          category: category.id,\n          subcategory: subcategory.id,\n        });\n      }\n    },\n    loadCategory(category: Category) {\n      NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n\n      const isActive = ReportingMenuStoreInstance.toggleCategory(category);\n\n      // one subcategory or a widget and some subcategories to allow to load the category\n      const { subcategories } = category as SubcategoryContainer;\n      const categoryCanLoad = (subcategories && subcategories.length === 1)\n        || (category.widget && subcategories && subcategories.length);\n\n      if (isActive && categoryCanLoad) {\n        this.helpShownCategory = null;\n\n        const subcategory = (category as SubcategoryContainer).subcategories[0];\n        this.propagateUrlChange(category, subcategory);\n      }\n    },\n    loadSubcategory(category: Category, subcategory: Subcategory, event?: MouseEvent) {\n      if (event\n        && (event.shiftKey || event.ctrlKey || event.metaKey)\n      ) {\n        return;\n      }\n\n      NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n\n      if (subcategory\n        && subcategory.id === MatomoUrl.parsed.value.subcategory\n        && category.id === MatomoUrl.parsed.value.category\n      ) {\n        this.helpShownCategory = null;\n\n        // this menu item is already active, a location change success would not be triggered,\n        // instead trigger an event (after the URL changes)\n        setTimeout(() => {\n          Matomo.postEvent('loadPage', category.id, subcategory.id);\n        });\n      }\n    },\n    makeUrl(category: Category, subcategory: Subcategory) {\n      const {\n        idSite,\n        period,\n        date,\n        segment,\n        comparePeriods,\n        compareDates,\n        compareSegments,\n      } = MatomoUrl.parsed.value;\n\n      return MatomoUrl.stringify({\n        idSite,\n        period,\n        date,\n        segment,\n        comparePeriods,\n        compareDates,\n        compareSegments,\n        category: category.id,\n        subcategory: subcategory.id,\n      });\n    },\n    htmlEntities(v: string) {\n      return Matomo.helper.htmlEntities(v);\n    },\n    showHelp(category: Category, subcategory: Subcategory, event?: Event) {\n      const parsedUrl = MatomoUrl.parsed.value;\n      const currentCategory = parsedUrl.category;\n      const currentSubcategory = parsedUrl.subcategory;\n\n      if ((currentCategory !== category.id\n        || currentSubcategory !== subcategory.id)\n        && event\n      ) {\n        this.showSubcategoryHelpOnLoad = { category, subcategory };\n        MatomoUrl.updateHash({\n          ...MatomoUrl.hashParsed.value,\n          category: category.id,\n          subcategory: subcategory.id,\n        });\n        return;\n      }\n\n      if (this.helpShownCategory\n        && category.id === this.helpShownCategory.category\n        && subcategory.id === this.helpShownCategory.subcategory\n      ) {\n        NotificationsStore.remove(REPORTING_HELP_NOTIFICATION_ID);\n        this.helpShownCategory = null;\n        return;\n      }\n\n      const prefixText = translate('CoreHome_ReportingCategoryHelpPrefix',\n        category.name, subcategory.name);\n      const prefix = `<strong>${prefixText}</strong><br/>`;\n\n      NotificationsStore.show({\n        context: 'info',\n        id: REPORTING_HELP_NOTIFICATION_ID,\n        type: 'help',\n        noclear: true,\n        class: 'help-notification',\n        message: prefix + subcategory.help,\n        placeat: '#notificationContainer',\n        prepend: true,\n      });\n\n      this.helpShownCategory = {\n        category: category.id,\n        subcategory: subcategory.id,\n      };\n    },\n  },\n});\n","import { render } from \"./ReportingMenu.vue?vue&type=template&id=1107cb5a\"\nimport script from \"./ReportingMenu.vue?vue&type=script&lang=ts\"\nexport * from \"./ReportingMenu.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport {\n  reactive,\n  computed,\n  readonly,\n  DeepReadonly,\n} from 'vue';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport Matomo from '../Matomo/Matomo';\n\ninterface ReportRef {\n  module: string;\n  action: string;\n}\n\ninterface Report {\n  relatedReports: ReportRef[];\n  module: string;\n  action: string;\n  documentation?: string;\n}\n\ninterface ReportMetadataStoreState {\n  reports: Report[];\n}\n\nexport class ReportMetadataStore {\n  private privateState = reactive<ReportMetadataStoreState>({\n    reports: [],\n  });\n\n  private state = readonly(this.privateState);\n\n  readonly reports = computed(() => this.state.reports);\n\n  private reportsPromise?: Promise<Report[]>;\n\n  // TODO: it used to return an empty array when nothing was found, will that be an issue?\n  findReport(reportModule?: string, reportAction?: string): DeepReadonly<Report>|undefined {\n    return this.reports.value.find((r) => r.module === reportModule && r.action === reportAction);\n  }\n\n  fetchReportMetadata(): Promise<ReportMetadataStore['reports']['value']> {\n    if (!this.reportsPromise) {\n      this.reportsPromise = AjaxHelper.fetch({\n        method: 'API.getReportMetadata',\n        filter_limit: '-1',\n        idSite: Matomo.idSite || MatomoUrl.parsed.value.idSite,\n      }).then((response) => {\n        this.privateState.reports = response;\n        return response;\n      });\n    }\n\n    return this.reportsPromise.then(() => this.reports.value);\n  }\n}\n\nexport default new ReportMetadataStore();\n","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"widgetLoader\">\n    <ActivityIndicator\n      :loading-message=\"finalLoadingMessage\"\n      :loading=\"loading\"\n    />\n    <div v-show=\"loadingFailed\">\n      <h2 v-if=\"widgetName\">{{ widgetName }}</h2>\n      <div v-if=\"!loadingFailedRateLimit\" class=\"notification system notification-error\">\n        {{ translate('General_ErrorRequest', '', '') }}\n        <a\n          rel=\"noreferrer noopener\"\n          target=\"_blank\"\n          :href=\"externalRawLink('https://matomo.org/faq/troubleshooting/faq_19489/')\"\n          v-if=\"hasErrorFaqLink\"\n        >\n          {{ translate('General_ErrorRequestFaqLink') }}\n        </a>\n      </div>\n      <div v-else class=\"notification system notification-error\">\n        {{ translate('General_ErrorRateLimit') }}\n      </div>\n    </div>\n    <div class=\"theWidgetContent\" ref=\"widgetContent\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport ActivityIndicator from '../ActivityIndicator/ActivityIndicator.vue';\nimport { translate } from '../translate';\nimport Matomo from '../Matomo/Matomo';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport { NotificationsStore } from '../Notification';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport ComparisonsStoreInstance from '../Comparisons/Comparisons.store.instance';\n\ninterface WidgetLoaderState {\n  loading: boolean;\n  loadingFailed: boolean;\n  loadingFailedRateLimit: boolean;\n  changeCounter: number;\n  lastWidgetAbortController: null|AbortController;\n}\n\n/**\n * Loads any custom widget or URL based on the given parameters.\n *\n * The currently active idSite, period, date and segment (if needed) is automatically\n * appended to the parameters. If this widget is removed from the DOM and requests are in\n * progress, these requests will be aborted. A loading message or an error message on failure\n * is shown as well. It's kinda similar to ng-include but there it is not possible to\n * listen to HTTP errors etc.\n *\n * Example:\n * <WidgetLoader :widget-params=\"{module: '', action: '', ...}\"/>\n */\nexport default defineComponent({\n  props: {\n    widgetParams: Object,\n    widgetName: String,\n    loadingMessage: String,\n  },\n  components: {\n    ActivityIndicator,\n  },\n  data(): WidgetLoaderState {\n    return {\n      loading: false,\n      loadingFailed: false,\n      loadingFailedRateLimit: false,\n      changeCounter: 0,\n      lastWidgetAbortController: null,\n    };\n  },\n  watch: {\n    widgetParams(parameters: QueryParameters) {\n      if (parameters) {\n        this.loadWidgetUrl(parameters, this.changeCounter += 1);\n      }\n    },\n  },\n  computed: {\n    finalLoadingMessage() {\n      if (this.loadingMessage) {\n        return this.loadingMessage;\n      }\n\n      if (!this.widgetName) {\n        return translate('General_LoadingData');\n      }\n\n      return translate('General_LoadingPopover', this.widgetName);\n    },\n    hasErrorFaqLink() {\n      const isGeneralSettingsAdminEnabled = Matomo.config.enable_general_settings_admin;\n      const isPluginsAdminEnabled = Matomo.config.enable_plugins_admin;\n\n      return Matomo.hasSuperUserAccess\n        && (isGeneralSettingsAdminEnabled\n          || isPluginsAdminEnabled);\n    },\n  },\n  mounted() {\n    if (this.widgetParams) {\n      this.loadWidgetUrl(this.widgetParams as QueryParameters, this.changeCounter += 1);\n    }\n  },\n  beforeUnmount() {\n    this.cleanupLastWidgetContent();\n  },\n  methods: {\n    abortHttpRequestIfNeeded() {\n      if (this.lastWidgetAbortController) {\n        this.lastWidgetAbortController.abort();\n        this.lastWidgetAbortController = null;\n      }\n    },\n    cleanupLastWidgetContent() {\n      const widgetContent = this.$refs.widgetContent as HTMLElement;\n      Matomo.helper.destroyVueComponent(widgetContent);\n      if (widgetContent) {\n        widgetContent.innerHTML = '';\n      }\n    },\n    getWidgetUrl(parameters?: QueryParameters): QueryParameters {\n      const urlParams = MatomoUrl.parsed.value;\n\n      let fullParameters: QueryParameters = { ...(parameters || {}) };\n\n      const paramsToForward = Object.keys({\n        ...MatomoUrl.hashParsed.value,\n        idSite: '',\n        period: '',\n        date: '',\n        segment: '',\n        widget: '',\n      });\n\n      paramsToForward.forEach((key) => {\n        if (key === 'category' || key === 'subcategory') {\n          return;\n        }\n\n        if (!(key in fullParameters)) {\n          fullParameters[key] = urlParams[key];\n        }\n      });\n\n      if (ComparisonsStoreInstance.isComparisonEnabled()) {\n        fullParameters = {\n          ...fullParameters,\n          comparePeriods: urlParams.comparePeriods,\n          compareDates: urlParams.compareDates,\n          compareSegments: urlParams.compareSegments,\n        };\n      }\n\n      if (!parameters || !('showtitle' in parameters)) {\n        fullParameters.showtitle = '1';\n      }\n\n      if (Matomo.shouldPropagateTokenAuth\n        && urlParams.token_auth\n      ) {\n        if (!Matomo.broadcast.isWidgetizeRequestWithoutSession()) {\n          fullParameters.force_api_session = '1';\n        }\n        fullParameters.token_auth = urlParams.token_auth;\n      }\n\n      fullParameters.random = Math.floor(Math.random() * 10000);\n\n      return fullParameters;\n    },\n    loadWidgetUrl(parameters: QueryParameters, thisChangeId: number) {\n      this.loading = true;\n\n      this.abortHttpRequestIfNeeded();\n      this.cleanupLastWidgetContent();\n\n      this.lastWidgetAbortController = new AbortController();\n\n      AjaxHelper.fetch(this.getWidgetUrl(parameters), {\n        format: 'html',\n        abortController: this.lastWidgetAbortController,\n      }).then((response) => {\n        if (thisChangeId !== this.changeCounter || typeof response !== 'string') {\n          // another widget was requested meanwhile, ignore this response\n          return;\n        }\n\n        this.lastWidgetAbortController = null;\n        this.loading = false;\n        this.loadingFailed = false;\n\n        const widgetContent = this.$refs.widgetContent as HTMLElement;\n        window.$(widgetContent).html(response);\n        const $content = window.$(widgetContent).children();\n\n        if (this.widgetName) {\n          // we need to respect the widget title, which overwrites a possibly set report title\n          let $title = $content.find('> .card-content .card-title');\n          if (!$title.length) {\n            $title = $content.find('> h2');\n          }\n\n          if ($title.length) {\n            // required to use htmlEntities since it also escapes '{{' format items\n            $title.html(Matomo.helper.htmlEntities(this.widgetName));\n          }\n        }\n\n        Matomo.helper.compileVueEntryComponents($content);\n\n        NotificationsStore.parseNotificationDivs();\n\n        setTimeout(() => {\n          Matomo.postEvent('widget:loaded', {\n            parameters,\n            element: $content,\n          });\n        });\n      }).catch((response) => {\n        if (thisChangeId !== this.changeCounter) {\n          // another widget was requested meanwhile, ignore this response\n          return;\n        }\n\n        this.lastWidgetAbortController = null;\n        this.cleanupLastWidgetContent();\n\n        this.loading = false;\n\n        if (response.xhrStatus === 'abort') {\n          return;\n        }\n\n        if (response.status === 429) {\n          this.loadingFailedRateLimit = true;\n        }\n\n        this.loadingFailed = true;\n      });\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport ActivityIndicator from '../ActivityIndicator/ActivityIndicator.vue';\nimport { translate } from '../translate';\nimport Matomo from '../Matomo/Matomo';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport { NotificationsStore } from '../Notification';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport ComparisonsStoreInstance from '../Comparisons/Comparisons.store.instance';\n\ninterface WidgetLoaderState {\n  loading: boolean;\n  loadingFailed: boolean;\n  loadingFailedRateLimit: boolean;\n  changeCounter: number;\n  lastWidgetAbortController: null|AbortController;\n}\n\n/**\n * Loads any custom widget or URL based on the given parameters.\n *\n * The currently active idSite, period, date and segment (if needed) is automatically\n * appended to the parameters. If this widget is removed from the DOM and requests are in\n * progress, these requests will be aborted. A loading message or an error message on failure\n * is shown as well. It's kinda similar to ng-include but there it is not possible to\n * listen to HTTP errors etc.\n *\n * Example:\n * <WidgetLoader :widget-params=\"{module: '', action: '', ...}\"/>\n */\nexport default defineComponent({\n  props: {\n    widgetParams: Object,\n    widgetName: String,\n    loadingMessage: String,\n  },\n  components: {\n    ActivityIndicator,\n  },\n  data(): WidgetLoaderState {\n    return {\n      loading: false,\n      loadingFailed: false,\n      loadingFailedRateLimit: false,\n      changeCounter: 0,\n      lastWidgetAbortController: null,\n    };\n  },\n  watch: {\n    widgetParams(parameters: QueryParameters) {\n      if (parameters) {\n        this.loadWidgetUrl(parameters, this.changeCounter += 1);\n      }\n    },\n  },\n  computed: {\n    finalLoadingMessage() {\n      if (this.loadingMessage) {\n        return this.loadingMessage;\n      }\n\n      if (!this.widgetName) {\n        return translate('General_LoadingData');\n      }\n\n      return translate('General_LoadingPopover', this.widgetName);\n    },\n    hasErrorFaqLink() {\n      const isGeneralSettingsAdminEnabled = Matomo.config.enable_general_settings_admin;\n      const isPluginsAdminEnabled = Matomo.config.enable_plugins_admin;\n\n      return Matomo.hasSuperUserAccess\n        && (isGeneralSettingsAdminEnabled\n          || isPluginsAdminEnabled);\n    },\n  },\n  mounted() {\n    if (this.widgetParams) {\n      this.loadWidgetUrl(this.widgetParams as QueryParameters, this.changeCounter += 1);\n    }\n  },\n  beforeUnmount() {\n    this.cleanupLastWidgetContent();\n  },\n  methods: {\n    abortHttpRequestIfNeeded() {\n      if (this.lastWidgetAbortController) {\n        this.lastWidgetAbortController.abort();\n        this.lastWidgetAbortController = null;\n      }\n    },\n    cleanupLastWidgetContent() {\n      const widgetContent = this.$refs.widgetContent as HTMLElement;\n      Matomo.helper.destroyVueComponent(widgetContent);\n      if (widgetContent) {\n        widgetContent.innerHTML = '';\n      }\n    },\n    getWidgetUrl(parameters?: QueryParameters): QueryParameters {\n      const urlParams = MatomoUrl.parsed.value;\n\n      let fullParameters: QueryParameters = { ...(parameters || {}) };\n\n      const paramsToForward = Object.keys({\n        ...MatomoUrl.hashParsed.value,\n        idSite: '',\n        period: '',\n        date: '',\n        segment: '',\n        widget: '',\n      });\n\n      paramsToForward.forEach((key) => {\n        if (key === 'category' || key === 'subcategory') {\n          return;\n        }\n\n        if (!(key in fullParameters)) {\n          fullParameters[key] = urlParams[key];\n        }\n      });\n\n      if (ComparisonsStoreInstance.isComparisonEnabled()) {\n        fullParameters = {\n          ...fullParameters,\n          comparePeriods: urlParams.comparePeriods,\n          compareDates: urlParams.compareDates,\n          compareSegments: urlParams.compareSegments,\n        };\n      }\n\n      if (!parameters || !('showtitle' in parameters)) {\n        fullParameters.showtitle = '1';\n      }\n\n      if (Matomo.shouldPropagateTokenAuth\n        && urlParams.token_auth\n      ) {\n        if (!Matomo.broadcast.isWidgetizeRequestWithoutSession()) {\n          fullParameters.force_api_session = '1';\n        }\n        fullParameters.token_auth = urlParams.token_auth;\n      }\n\n      fullParameters.random = Math.floor(Math.random() * 10000);\n\n      return fullParameters;\n    },\n    loadWidgetUrl(parameters: QueryParameters, thisChangeId: number) {\n      this.loading = true;\n\n      this.abortHttpRequestIfNeeded();\n      this.cleanupLastWidgetContent();\n\n      this.lastWidgetAbortController = new AbortController();\n\n      AjaxHelper.fetch(this.getWidgetUrl(parameters), {\n        format: 'html',\n        abortController: this.lastWidgetAbortController,\n      }).then((response) => {\n        if (thisChangeId !== this.changeCounter || typeof response !== 'string') {\n          // another widget was requested meanwhile, ignore this response\n          return;\n        }\n\n        this.lastWidgetAbortController = null;\n        this.loading = false;\n        this.loadingFailed = false;\n\n        const widgetContent = this.$refs.widgetContent as HTMLElement;\n        window.$(widgetContent).html(response);\n        const $content = window.$(widgetContent).children();\n\n        if (this.widgetName) {\n          // we need to respect the widget title, which overwrites a possibly set report title\n          let $title = $content.find('> .card-content .card-title');\n          if (!$title.length) {\n            $title = $content.find('> h2');\n          }\n\n          if ($title.length) {\n            // required to use htmlEntities since it also escapes '{{' format items\n            $title.html(Matomo.helper.htmlEntities(this.widgetName));\n          }\n        }\n\n        Matomo.helper.compileVueEntryComponents($content);\n\n        NotificationsStore.parseNotificationDivs();\n\n        setTimeout(() => {\n          Matomo.postEvent('widget:loaded', {\n            parameters,\n            element: $content,\n          });\n        });\n      }).catch((response) => {\n        if (thisChangeId !== this.changeCounter) {\n          // another widget was requested meanwhile, ignore this response\n          return;\n        }\n\n        this.lastWidgetAbortController = null;\n        this.cleanupLastWidgetContent();\n\n        this.loading = false;\n\n        if (response.xhrStatus === 'abort') {\n          return;\n        }\n\n        if (response.status === 429) {\n          this.loadingFailedRateLimit = true;\n        }\n\n        this.loadingFailed = true;\n      });\n    },\n  },\n});\n","import { render } from \"./WidgetLoader.vue?vue&type=template&id=57210b14\"\nimport script from \"./WidgetLoader.vue?vue&type=script&lang=ts\"\nexport * from \"./WidgetLoader.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"widget-container\">\n    <div\n      v-for=\"(widget, index) in actualContainer\"\n      :key=\"index\"\n    >\n      <div>\n        <Widget\n          :widget=\"widget\"\n          :prevent-recursion=\"true\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\nimport { Widget as WidgetData } from '../Widget/types';\n\n// since we're recursing, don't import the plugin directly\nconst Widget = useExternalPluginComponent('CoreHome', 'Widget');\n\nexport default defineComponent({\n  props: {\n    container: {\n      type: Array,\n      required: true,\n    },\n  },\n  components: {\n    Widget,\n  },\n  computed: {\n    actualContainer() {\n      const container = this.container as WidgetData[];\n\n      if (!container?.[0]?.parameters) {\n        return container;\n      }\n\n      const [widget] = container;\n      const isWidgetized = widget.parameters?.widget === '1' || widget.parameters?.widget === 1;\n\n      const isGraphEvolution = isWidgetized && widget.viewDataTable === 'graphEvolution';\n\n      // we hide the first title for Visits Overview with Graph and Goal Overview\n      const firstWidget = isGraphEvolution\n        ? { ...widget, parameters: { ...widget.parameters, showtitle: '0' } }\n        : widget;\n\n      return [\n        firstWidget,\n        ...container.slice(1),\n      ];\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\nimport { Widget as WidgetData } from '../Widget/types';\n\n// since we're recursing, don't import the plugin directly\nconst Widget = useExternalPluginComponent('CoreHome', 'Widget');\n\nexport default defineComponent({\n  props: {\n    container: {\n      type: Array,\n      required: true,\n    },\n  },\n  components: {\n    Widget,\n  },\n  computed: {\n    actualContainer() {\n      const container = this.container as WidgetData[];\n\n      if (!container?.[0]?.parameters) {\n        return container;\n      }\n\n      const [widget] = container;\n      const isWidgetized = widget.parameters?.widget === '1' || widget.parameters?.widget === 1;\n\n      const isGraphEvolution = isWidgetized && widget.viewDataTable === 'graphEvolution';\n\n      // we hide the first title for Visits Overview with Graph and Goal Overview\n      const firstWidget = isGraphEvolution\n        ? { ...widget, parameters: { ...widget.parameters, showtitle: '0' } }\n        : widget;\n\n      return [\n        firstWidget,\n        ...container.slice(1),\n      ];\n    },\n  },\n});\n","import { render } from \"./WidgetContainer.vue?vue&type=template&id=24121adc\"\nimport script from \"./WidgetContainer.vue?vue&type=script&lang=ts\"\nexport * from \"./WidgetContainer.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"reportsByDimensionView\">\n    <div class=\"entityList\">\n      <div\n        class=\"dimensionCategory\"\n        v-for=\"category in widgetsByCategory\"\n        :key=\"category.name\"\n      >\n        {{ category.name }}\n        <ul class=\"listCircle\">\n          <li\n            class=\"reportDimension\"\n            v-for=\"widget in category.widgets\"\n            :key=\"widget.uniqueId\"\n            :class=\"{ activeDimension: selectedWidget.uniqueId === widget.uniqueId }\"\n            @click=\"selectWidget(widget)\"\n          >\n            <span class=\"dimension\">{{ widget.name }}</span>\n          </li>\n        </ul>\n      </div>\n    </div>\n    <div class=\"reportContainer\">\n      <WidgetLoader\n        v-if=\"selectedWidget.parameters\"\n        :widget-params=\"selectedWidget.parameters\"\n        class=\"dimensionReport\"\n      />\n    </div>\n    <div class=\"clear\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport WidgetLoader from '../WidgetLoader/WidgetLoader.vue';\nimport { Widget } from '../Widget/types';\nimport { sortOrderables } from '../Orderable';\n\ninterface WidgetByDimensionContainerState {\n  selectedWidget: Widget|null;\n}\n\ninterface WidgetCategory {\n  name: string;\n  order: number;\n  widgets: Widget[];\n}\n\nexport default defineComponent({\n  props: {\n    widgets: Array,\n  },\n  components: {\n    WidgetLoader,\n  },\n  data(): WidgetByDimensionContainerState {\n    return {\n      selectedWidget: null,\n    };\n  },\n  created() {\n    [this.selectedWidget] = this.widgetsSorted;\n  },\n  computed: {\n    widgetsSorted(): Widget[] {\n      return sortOrderables(this.widgets as Widget[]);\n    },\n    widgetsByCategory() {\n      const byCategory: Record<string, WidgetCategory> = {};\n\n      this.widgetsSorted.forEach((widget) => {\n        const category = widget.subcategory?.name;\n        if (!category) {\n          return;\n        }\n\n        if (!byCategory[category]) {\n          byCategory[category] = { name: category, order: widget.order, widgets: [] };\n        }\n\n        byCategory[category].widgets!.push(widget);\n      });\n\n      return sortOrderables(Object.values(byCategory));\n    },\n  },\n  methods: {\n    selectWidget(widget: Widget) {\n      // we copy to force rerender if selecting same widget\n      this.selectedWidget = { ...widget };\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport WidgetLoader from '../WidgetLoader/WidgetLoader.vue';\nimport { Widget } from '../Widget/types';\nimport { sortOrderables } from '../Orderable';\n\ninterface WidgetByDimensionContainerState {\n  selectedWidget: Widget|null;\n}\n\ninterface WidgetCategory {\n  name: string;\n  order: number;\n  widgets: Widget[];\n}\n\nexport default defineComponent({\n  props: {\n    widgets: Array,\n  },\n  components: {\n    WidgetLoader,\n  },\n  data(): WidgetByDimensionContainerState {\n    return {\n      selectedWidget: null,\n    };\n  },\n  created() {\n    [this.selectedWidget] = this.widgetsSorted;\n  },\n  computed: {\n    widgetsSorted(): Widget[] {\n      return sortOrderables(this.widgets as Widget[]);\n    },\n    widgetsByCategory() {\n      const byCategory: Record<string, WidgetCategory> = {};\n\n      this.widgetsSorted.forEach((widget) => {\n        const category = widget.subcategory?.name;\n        if (!category) {\n          return;\n        }\n\n        if (!byCategory[category]) {\n          byCategory[category] = { name: category, order: widget.order, widgets: [] };\n        }\n\n        byCategory[category].widgets!.push(widget);\n      });\n\n      return sortOrderables(Object.values(byCategory));\n    },\n  },\n  methods: {\n    selectWidget(widget: Widget) {\n      // we copy to force rerender if selecting same widget\n      this.selectedWidget = { ...widget };\n    },\n  },\n});\n","import { render } from \"./WidgetByDimensionContainer.vue?vue&type=template&id=3681f928\"\nimport script from \"./WidgetByDimensionContainer.vue?vue&type=script&lang=ts\"\nexport * from \"./WidgetByDimensionContainer.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div\n    v-if=\"actualWidget && showWidget\"\n    class=\"matomo-widget\"\n    :class=\"{'isFirstWidgetInPage': actualWidget.isFirstInPage}\"\n    :id=\"actualWidget.uniqueId\"\n    v-tooltips=\"{ content: tooltipContent }\"\n  >\n    <WidgetLoader\n      v-if=\"!actualWidget.isContainer && actualWidget.parameters\"\n      :widget-params=\"actualWidget.parameters\"\n      :widget-name=\"actualWidget.name\"\n    />\n    <div v-if=\"actualWidget.isContainer\n      && actualWidget.layout !== 'ByDimension'\n      && !this.preventRecursion\"\n    >\n      <div>\n        <WidgetContainer :container=\"actualWidget.widgets\" />\n      </div>\n    </div>\n    <div v-if=\"actualWidget.isContainer && actualWidget.layout === 'ByDimension'\">\n      <div>\n        <WidgetByDimensionContainer :widgets=\"actualWidget.widgets\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { DeepReadonly, defineComponent } from 'vue';\nimport WidgetLoader from '../WidgetLoader/WidgetLoader.vue';\nimport WidgetContainer from '../WidgetContainer/WidgetContainer.vue';\nimport WidgetByDimensionContainer from '../WidgetByDimensionContainer/WidgetByDimensionContainer.vue';\nimport WidgetsStoreInstance, { getWidgetChildren } from './Widgets.store';\nimport {\n  Widget as WidgetData,\n  WidgetContainer as WidgetDataContainer,\n} from './types';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport ReportMetadataStoreInstance from '../ReportMetadata/ReportMetadata.store';\nimport Tooltips from '../Tooltips/Tooltips';\n\nfunction findContainer(\n  widgetsByCategory: typeof WidgetsStoreInstance.widgets.value,\n  containerId: string,\n): DeepReadonly<WidgetData>|undefined {\n  let widget: DeepReadonly<WidgetData>|undefined = undefined;\n  Object.values(widgetsByCategory || {}).some((widgets: DeepReadonly<WidgetData[]>) => {\n    widget = widgets.find((w) => w && w.isContainer && w.parameters?.containerId === containerId);\n    return widget;\n  });\n  return widget;\n}\n\n/**\n * Renders any kind of widget. If you have a widget and you want to have it rendered, use this\n * directive. It will display a name on top and the actual widget below. It can handle any kind\n * of widget, no matter whether it is a regular widget or a container.\n *\n * @param {Object} piwikWidget  A widget object as returned by the WidgetMetadata API.\n * @param {Object} piwikWidget.middlewareParameters   If present, we will request a URL using the\n *                                                    given parameters and only if this URL\n *                                                    returns a JSON `true` the widget will be\n *                                                    shown. Otherwise the widget won't be shown.\n * @param {String} containerId  If you do not have a widget object but a containerId we will find\n *                              the correct widget object based on the given containerId. Be aware\n *                              that we might not find the widget if it is for example not\n *                              available for the current user or period/date.\n * @param {Boolean} widgetized  true if the widget is widgetized (eg in Dashboard or exported).\n *                              In this case we will add a URL parameter widget=1 to all widgets.\n *                              Eg sparklines will be then displayed one after another\n *                              (vertically aligned) instead of two next to each other.\n *\n * Example:\n * <Widget :widget=\"widget\"></Widget>\n * // in this case we will find the correct widget automatically\n * <Widget :containerid=\"widgetGoalsOverview\"></Widget>\n * // disables rating feature, no initial headline\n * <Widget :widget=\"widget\" :widetized=\"true\"></Widget>\n */\nexport default defineComponent({\n  props: {\n    widget: Object,\n    widgetized: Boolean,\n    containerid: String,\n    preventRecursion: Boolean,\n  },\n  components: {\n    WidgetLoader,\n    WidgetContainer,\n    WidgetByDimensionContainer,\n  },\n  directives: {\n    Tooltips,\n  },\n  data() {\n    return {\n      showWidget: false,\n    };\n  },\n  setup() {\n    function tooltipContent(this: HTMLElement) {\n      const $this = window.$(this) as JQuery;\n      if ($this.hasClass('matomo-form-field')) {\n        // do not show it for form fields\n        return '';\n      }\n\n      const title = window.$(this).attr('title') || '';\n      return window.vueSanitize(title.replace(/\\n/g, '<br />'));\n    }\n\n    return {\n      tooltipContent,\n    };\n  },\n  created() {\n    const { actualWidget } = this;\n\n    if (actualWidget && actualWidget.middlewareParameters) {\n      const params = actualWidget.middlewareParameters as unknown as QueryParameters;\n      AjaxHelper.fetch(params).then((response) => {\n        this.showWidget = !!response;\n      });\n    } else {\n      this.showWidget = true;\n    }\n  },\n  computed: {\n    allWidgets() {\n      return WidgetsStoreInstance.widgets.value;\n    },\n    actualWidget() {\n      const widget = this.widget as WidgetData;\n\n      if (widget) {\n        const result = { ...widget };\n\n        if (widget && widget.isReport && !widget.documentation) {\n          const report = ReportMetadataStoreInstance.findReport(widget.module, widget.action);\n          if (report && report.documentation) {\n            result.documentation = report.documentation;\n          }\n        }\n\n        return widget;\n      }\n\n      if (this.containerid) {\n        const containerWidget = findContainer(this.allWidgets, this.containerid);\n        if (containerWidget) {\n          const result = { ...containerWidget };\n\n          if (this.widgetized) {\n            result.isFirstInPage = true;\n            result.parameters = { ...result.parameters, widget: '1' };\n\n            const widgets = getWidgetChildren(result);\n            if (widgets) {\n              (result as WidgetDataContainer).widgets = widgets.map((w) => ({\n                ...w,\n                parameters: {\n                  ...w.parameters,\n                  widget: '1',\n                  containerId: this.containerid!,\n                },\n              }));\n            }\n          }\n\n          return result;\n        }\n      }\n\n      return null;\n    },\n  },\n});\n</script>\n","\nimport { DeepReadonly, defineComponent } from 'vue';\nimport WidgetLoader from '../WidgetLoader/WidgetLoader.vue';\nimport WidgetContainer from '../WidgetContainer/WidgetContainer.vue';\nimport WidgetByDimensionContainer from '../WidgetByDimensionContainer/WidgetByDimensionContainer.vue';\nimport WidgetsStoreInstance, { getWidgetChildren } from './Widgets.store';\nimport {\n  Widget as WidgetData,\n  WidgetContainer as WidgetDataContainer,\n} from './types';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport ReportMetadataStoreInstance from '../ReportMetadata/ReportMetadata.store';\nimport Tooltips from '../Tooltips/Tooltips';\n\nfunction findContainer(\n  widgetsByCategory: typeof WidgetsStoreInstance.widgets.value,\n  containerId: string,\n): DeepReadonly<WidgetData>|undefined {\n  let widget: DeepReadonly<WidgetData>|undefined = undefined;\n  Object.values(widgetsByCategory || {}).some((widgets: DeepReadonly<WidgetData[]>) => {\n    widget = widgets.find((w) => w && w.isContainer && w.parameters?.containerId === containerId);\n    return widget;\n  });\n  return widget;\n}\n\n/**\n * Renders any kind of widget. If you have a widget and you want to have it rendered, use this\n * directive. It will display a name on top and the actual widget below. It can handle any kind\n * of widget, no matter whether it is a regular widget or a container.\n *\n * @param {Object} piwikWidget  A widget object as returned by the WidgetMetadata API.\n * @param {Object} piwikWidget.middlewareParameters   If present, we will request a URL using the\n *                                                    given parameters and only if this URL\n *                                                    returns a JSON `true` the widget will be\n *                                                    shown. Otherwise the widget won't be shown.\n * @param {String} containerId  If you do not have a widget object but a containerId we will find\n *                              the correct widget object based on the given containerId. Be aware\n *                              that we might not find the widget if it is for example not\n *                              available for the current user or period/date.\n * @param {Boolean} widgetized  true if the widget is widgetized (eg in Dashboard or exported).\n *                              In this case we will add a URL parameter widget=1 to all widgets.\n *                              Eg sparklines will be then displayed one after another\n *                              (vertically aligned) instead of two next to each other.\n *\n * Example:\n * <Widget :widget=\"widget\"></Widget>\n * // in this case we will find the correct widget automatically\n * <Widget :containerid=\"widgetGoalsOverview\"></Widget>\n * // disables rating feature, no initial headline\n * <Widget :widget=\"widget\" :widetized=\"true\"></Widget>\n */\nexport default defineComponent({\n  props: {\n    widget: Object,\n    widgetized: Boolean,\n    containerid: String,\n    preventRecursion: Boolean,\n  },\n  components: {\n    WidgetLoader,\n    WidgetContainer,\n    WidgetByDimensionContainer,\n  },\n  directives: {\n    Tooltips,\n  },\n  data() {\n    return {\n      showWidget: false,\n    };\n  },\n  setup() {\n    function tooltipContent(this: HTMLElement) {\n      const $this = window.$(this) as JQuery;\n      if ($this.hasClass('matomo-form-field')) {\n        // do not show it for form fields\n        return '';\n      }\n\n      const title = window.$(this).attr('title') || '';\n      return window.vueSanitize(title.replace(/\\n/g, '<br />'));\n    }\n\n    return {\n      tooltipContent,\n    };\n  },\n  created() {\n    const { actualWidget } = this;\n\n    if (actualWidget && actualWidget.middlewareParameters) {\n      const params = actualWidget.middlewareParameters as unknown as QueryParameters;\n      AjaxHelper.fetch(params).then((response) => {\n        this.showWidget = !!response;\n      });\n    } else {\n      this.showWidget = true;\n    }\n  },\n  computed: {\n    allWidgets() {\n      return WidgetsStoreInstance.widgets.value;\n    },\n    actualWidget() {\n      const widget = this.widget as WidgetData;\n\n      if (widget) {\n        const result = { ...widget };\n\n        if (widget && widget.isReport && !widget.documentation) {\n          const report = ReportMetadataStoreInstance.findReport(widget.module, widget.action);\n          if (report && report.documentation) {\n            result.documentation = report.documentation;\n          }\n        }\n\n        return widget;\n      }\n\n      if (this.containerid) {\n        const containerWidget = findContainer(this.allWidgets, this.containerid);\n        if (containerWidget) {\n          const result = { ...containerWidget };\n\n          if (this.widgetized) {\n            result.isFirstInPage = true;\n            result.parameters = { ...result.parameters, widget: '1' };\n\n            const widgets = getWidgetChildren(result);\n            if (widgets) {\n              (result as WidgetDataContainer).widgets = widgets.map((w) => ({\n                ...w,\n                parameters: {\n                  ...w.parameters,\n                  widget: '1',\n                  containerId: this.containerid!,\n                },\n              }));\n            }\n          }\n\n          return result;\n        }\n      }\n\n      return null;\n    },\n  },\n});\n","import { render } from \"./Widget.vue?vue&type=template&id=adfeebbe\"\nimport script from \"./Widget.vue?vue&type=script&lang=ts\"\nexport * from \"./Widget.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"reporting-page\">\n    <ActivityIndicator\n      :loading=\"loading\"\n    />\n    <div v-show=\"hasNoPage\">{{ translate('CoreHome_NoSuchPage') }}</div>\n    <div\n      class=\"row\"\n      v-for=\"widget in widgets\"\n      :key=\"widget.uniqueId\"\n    >\n      <Widget\n        class=\"col s12 fullWidgetColumn\"\n        v-if=\"!widget.group\"\n        :widget=\"widget\"\n      />\n      <div\n        v-if=\"widget.group\"\n        class=\"col s12 l6 leftWidgetColumn\"\n      >\n        <Widget\n          v-for=\"widgetInGroup in widget.left\"\n          :widget=\"widgetInGroup\"\n          :key=\"widgetInGroup.uniqueId\"\n        />\n      </div>\n      <div\n        v-if=\"widget.group\"\n        class=\"col s12 l6 rightWidgetColumn\"\n      >\n        <Widget\n          v-for=\"widgetInGroup in widget.right\"\n          :widget=\"widgetInGroup\"\n          :key=\"widgetInGroup.uniqueId\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, watch } from 'vue';\nimport ActivityIndicator from '../ActivityIndicator/ActivityIndicator.vue';\nimport Widget from '../Widget/Widget.vue';\nimport ReportingPageStoreInstance from './ReportingPage.store';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { Periods } from '../Periods';\nimport { NotificationsStore } from '../Notification';\nimport { translate } from '../translate';\nimport Matomo from '../Matomo/Matomo';\nimport ReportingPagesStoreInstance from '../ReportingPages/ReportingPages.store';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\n\nfunction showOnlyRawDataNotification() {\n  const params = 'category=General_Visitors&subcategory=Live_VisitorLog';\n  const url = window.broadcast.buildReportingUrl(params);\n  NotificationsStore.show({\n    id: 'onlyRawData',\n    animate: false,\n    context: 'info',\n    message: translate('CoreHome_PeriodHasOnlyRawData', `<a href=\"${url}\">`, '</a>'),\n    type: 'transient',\n  });\n}\n\nfunction hideOnlyRawDataNoticifation() {\n  NotificationsStore.remove('onlyRawData');\n}\n\ninterface ReportingPageState {\n  loading: boolean;\n  hasRawData: boolean;\n  hasNoVisits: boolean;\n  dateLastChecked: Date|null;\n  hasNoPage: boolean;\n}\n\ninterface LoadPageArgs {\n  category: string;\n  subcategory: string;\n  promise?: Promise<void>;\n}\n\nexport default defineComponent({\n  components: {\n    ActivityIndicator,\n    Widget,\n  },\n  data(): ReportingPageState {\n    return {\n      loading: false,\n      hasRawData: false,\n      hasNoVisits: false,\n      dateLastChecked: null,\n      hasNoPage: false,\n    };\n  },\n  created() {\n    ReportingPageStoreInstance.resetPage();\n\n    this.loading = true; // we only set loading on initial load\n    this.renderInitialPage();\n\n    watch(() => MatomoUrl.parsed.value, (newValue, oldValue) => {\n      if (newValue.category === oldValue.category\n        && newValue.subcategory === oldValue.subcategory\n        && newValue.period === oldValue.period\n        && newValue.date === oldValue.date\n        && newValue.segment === oldValue.segment\n        && JSON.stringify(newValue.compareDates) === JSON.stringify(oldValue.compareDates)\n        && JSON.stringify(newValue.comparePeriods) === JSON.stringify(oldValue.comparePeriods)\n        && JSON.stringify(newValue.compareSegments) === JSON.stringify(oldValue.compareSegments)\n        && JSON.stringify(newValue.columns || '') === JSON.stringify(oldValue.columns || '')\n      ) {\n        // this page is already loaded\n        return;\n      }\n\n      if (newValue.date !== oldValue.date || newValue.period !== oldValue.period) {\n        hideOnlyRawDataNoticifation();\n        this.dateLastChecked = null;\n        this.hasRawData = false;\n        this.hasNoVisits = false;\n      }\n\n      this.renderPage(newValue.category as string, newValue.subcategory as string);\n    });\n\n    Matomo.on('loadPage', (category: string, subcategory: string) => {\n      this.renderPage(category, subcategory);\n    });\n  },\n  computed: {\n    widgets() {\n      return ReportingPageStoreInstance.widgets.value;\n    },\n  },\n  methods: {\n    renderPage(category: string, subcategory: string) {\n      if (!category || !subcategory) {\n        ReportingPageStoreInstance.resetPage();\n        this.loading = false;\n        return;\n      }\n\n      const parsedUrl = MatomoUrl.parsed.value;\n      const currentPeriod = parsedUrl.period as string;\n      const currentDate = parsedUrl.date as string;\n\n      try {\n        Periods.parse(currentPeriod, currentDate);\n      } catch (e) {\n        NotificationsStore.show({\n          id: 'invalidDate',\n          animate: false,\n          context: 'error',\n          message: translate('CoreHome_DateInvalid'),\n          type: 'transient',\n        });\n\n        ReportingPageStoreInstance.resetPage();\n        this.loading = false;\n        return;\n      }\n\n      NotificationsStore.remove('invalidDate');\n\n      Matomo.postEvent('matomoPageChange', {});\n\n      NotificationsStore.clearTransientNotifications();\n\n      if (Periods.parse(currentPeriod, currentDate).containsToday()) {\n        this.showOnlyRawDataMessageIfRequired();\n      }\n\n      const params: LoadPageArgs = { category, subcategory };\n      Matomo.postEvent('ReportingPage.loadPage', params);\n      if (params.promise) {\n        this.loading = true;\n        Promise.resolve(params.promise).finally(() => {\n          this.loading = false;\n        });\n        return;\n      }\n\n      ReportingPageStoreInstance.fetchPage(category, subcategory).then(() => {\n        const hasNoPage = !ReportingPageStoreInstance.page.value;\n        if (hasNoPage) {\n          const page = ReportingPagesStoreInstance.findPageInCategory(category);\n          if (page && page.subcategory) {\n            MatomoUrl.updateHash({\n              ...MatomoUrl.hashParsed.value,\n              subcategory: page.subcategory.id,\n            });\n            return;\n          }\n        }\n\n        this.hasNoPage = hasNoPage;\n        this.loading = false;\n      });\n    },\n    renderInitialPage() {\n      const parsed = MatomoUrl.parsed.value;\n      this.renderPage(parsed.category as string, parsed.subcategory as string);\n    },\n    showOnlyRawDataMessageIfRequired() {\n      if (!Matomo.visitorLogEnabled) {\n        return;\n      }\n\n      if (this.hasRawData && this.hasNoVisits) {\n        showOnlyRawDataNotification();\n      }\n\n      const parsedUrl = MatomoUrl.parsed.value;\n\n      const { segment } = parsedUrl;\n      if (segment) {\n        hideOnlyRawDataNoticifation();\n        return;\n      }\n\n      const subcategoryExceptions = [\n        'Live_VisitorLog',\n        'General_RealTime',\n        'UserCountryMap_RealTimeMap',\n        'MediaAnalytics_TypeAudienceLog',\n        'MediaAnalytics_TypeRealTime',\n        'FormAnalytics_TypeRealTime',\n        'Goals_AddNewGoal',\n      ];\n\n      const categoryExceptions = [\n        'HeatmapSessionRecording_Heatmaps',\n        'HeatmapSessionRecording_SessionRecordings',\n        'Marketplace_Marketplace',\n      ];\n\n      const subcategory = parsedUrl.subcategory as string;\n      const category = parsedUrl.category as string;\n      if (subcategoryExceptions.indexOf(subcategory) !== -1\n        || categoryExceptions.indexOf(category) !== -1\n        || subcategory.toLowerCase().indexOf('manage') !== -1\n      ) {\n        hideOnlyRawDataNoticifation();\n        return;\n      }\n\n      const minuteInMilliseconds = 60000;\n      if (this.dateLastChecked\n        && ((new Date()).valueOf() - this.dateLastChecked.valueOf()) < minuteInMilliseconds\n      ) {\n        return;\n      }\n\n      AjaxHelper.fetch({ method: 'VisitsSummary.getVisits' }).then((json) => {\n        this.dateLastChecked = new Date();\n\n        if (json.value > 0) {\n          this.hasNoVisits = false;\n          hideOnlyRawDataNoticifation();\n          return undefined;\n        }\n\n        this.hasNoVisits = true;\n\n        if (this.hasRawData) {\n          showOnlyRawDataNotification();\n          return undefined;\n        }\n\n        return AjaxHelper.fetch({\n          method: 'Live.getLastVisitsDetails',\n          filter_limit: 1,\n          doNotFetchActions: 1,\n        }).then((lastVisits) => {\n          if (!lastVisits || lastVisits.length === 0) {\n            this.hasRawData = false;\n            hideOnlyRawDataNoticifation();\n            return;\n          }\n\n          this.hasRawData = true;\n          showOnlyRawDataNotification();\n        });\n      });\n    },\n  },\n});\n</script>\n","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport {\n  computed,\n  DeepReadonly,\n  reactive,\n  readonly,\n} from 'vue';\nimport ReportingPagesStoreInstance, { Page } from '../ReportingPages/ReportingPages.store';\nimport ReportMetadataStoreInstance from '../ReportMetadata/ReportMetadata.store';\nimport { sortOrderables } from '../Orderable';\nimport { getWidgetChildren } from '../Widget/Widgets.store';\nimport {\n  GroupedWidgets,\n  Widget,\n  WidgetContainer,\n} from '../Widget/types';\n\ninterface ReportingMenuStoreState {\n  page?: DeepReadonly<Page>;\n}\n\nfunction shouldBeRenderedWithFullWidth(widget: Widget) {\n  // rather controller logic\n  if ((widget.isContainer && widget.layout && widget.layout === 'ByDimension')\n    || widget.viewDataTable === 'bydimension'\n  ) {\n    return true;\n  }\n\n  if (widget.isWide) {\n    return true;\n  }\n\n  return widget.viewDataTable\n    && (widget.viewDataTable === 'tableAllColumns'\n      || widget.viewDataTable === 'sparklines'\n      || widget.viewDataTable === 'graphEvolution');\n}\n\nfunction markWidgetsInFirstRowOfPage(widgets: (Widget|GroupedWidgets)[]) {\n  if (widgets && widgets[0]) {\n    const newWidgets: (Widget|GroupedWidgets)[] = [...widgets];\n\n    const groupedWidgets = widgets[0] as GroupedWidgets;\n    if (groupedWidgets.group) {\n      newWidgets[0] = {\n        ...newWidgets[0],\n        left: markWidgetsInFirstRowOfPage(groupedWidgets.left || []),\n        right: markWidgetsInFirstRowOfPage(groupedWidgets.right || []),\n      } as GroupedWidgets;\n    } else {\n      newWidgets[0] = { ...newWidgets[0], isFirstInPage: true };\n    }\n\n    return newWidgets;\n  }\n\n  return widgets;\n}\n\nexport class ReportingPageStore {\n  private privateState = reactive<ReportingMenuStoreState>({});\n\n  private state = computed(() => readonly(this.privateState));\n\n  readonly page = computed(() => this.state.value.page);\n\n  readonly widgets = computed(() => {\n    const page = this.page.value;\n    if (!page) {\n      return [];\n    }\n\n    let widgets: Widget[] = [];\n    const reportsToIgnore: Record<string, unknown> = {};\n\n    const isIgnoredReport = (widget: Widget) => widget.isReport\n      && reportsToIgnore[`${widget.module}.${widget.action}`];\n\n    const getRelatedReports = (widget: Widget) => {\n      if (!widget.isReport) {\n        return [];\n      }\n\n      const report = ReportMetadataStoreInstance.findReport(widget.module, widget.action);\n      if (!report || !report.relatedReports) {\n        return [];\n      }\n\n      return report.relatedReports;\n    };\n\n    (page.widgets || []).forEach((widget) => {\n      if (isIgnoredReport(widget)) {\n        return;\n      }\n\n      getRelatedReports(widget).forEach((report) => {\n        reportsToIgnore[`${report.module}.${report.action}`] = true;\n      });\n\n      widgets.push(widget);\n    });\n\n    widgets = sortOrderables(widgets);\n\n    if (widgets.length === 1) {\n      // if there is only one widget, we always display it full width\n      return markWidgetsInFirstRowOfPage(widgets);\n    }\n\n    const groupedWidgets: (Widget|GroupedWidgets)[] = [];\n    for (let i = 0; i < widgets.length; i += 1) {\n      const widget = widgets[i];\n\n      if (shouldBeRenderedWithFullWidth(widget)\n        || (widgets[i + 1] && shouldBeRenderedWithFullWidth(widgets[i + 1]))\n      ) {\n        groupedWidgets.push({\n          ...widget,\n          widgets: sortOrderables(getWidgetChildren(widget)),\n        } as WidgetContainer);\n      } else {\n        let counter = 0;\n        const left = [widget];\n        const right = [];\n\n        while (widgets[i + 1] && !shouldBeRenderedWithFullWidth(widgets[i + 1])) {\n          i += 1;\n          counter += 1;\n          if (counter % 2 === 0) {\n            left.push(widgets[i]);\n          } else {\n            right.push(widgets[i]);\n          }\n        }\n\n        groupedWidgets.push({ group: true, left, right } as GroupedWidgets);\n      }\n    }\n\n    const sortedWidgets = markWidgetsInFirstRowOfPage(groupedWidgets);\n    return sortedWidgets;\n  });\n\n  fetchPage(category: string, subcategory: string): Promise<ReportingPageStore['page']['value']> {\n    this.resetPage();\n\n    return Promise.all([\n      ReportingPagesStoreInstance.getAllPages(),\n      ReportMetadataStoreInstance.fetchReportMetadata(),\n    ]).then(() => {\n      this.privateState.page = ReportingPagesStoreInstance.findPage(category, subcategory);\n      return this.page.value;\n    });\n  }\n\n  resetPage(): void {\n    this.privateState.page = undefined;\n  }\n}\n\nexport default new ReportingPageStore();\n","\nimport { defineComponent, watch } from 'vue';\nimport ActivityIndicator from '../ActivityIndicator/ActivityIndicator.vue';\nimport Widget from '../Widget/Widget.vue';\nimport ReportingPageStoreInstance from './ReportingPage.store';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { Periods } from '../Periods';\nimport { NotificationsStore } from '../Notification';\nimport { translate } from '../translate';\nimport Matomo from '../Matomo/Matomo';\nimport ReportingPagesStoreInstance from '../ReportingPages/ReportingPages.store';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\n\nfunction showOnlyRawDataNotification() {\n  const params = 'category=General_Visitors&subcategory=Live_VisitorLog';\n  const url = window.broadcast.buildReportingUrl(params);\n  NotificationsStore.show({\n    id: 'onlyRawData',\n    animate: false,\n    context: 'info',\n    message: translate('CoreHome_PeriodHasOnlyRawData', `<a href=\"${url}\">`, '</a>'),\n    type: 'transient',\n  });\n}\n\nfunction hideOnlyRawDataNoticifation() {\n  NotificationsStore.remove('onlyRawData');\n}\n\ninterface ReportingPageState {\n  loading: boolean;\n  hasRawData: boolean;\n  hasNoVisits: boolean;\n  dateLastChecked: Date|null;\n  hasNoPage: boolean;\n}\n\ninterface LoadPageArgs {\n  category: string;\n  subcategory: string;\n  promise?: Promise<void>;\n}\n\nexport default defineComponent({\n  components: {\n    ActivityIndicator,\n    Widget,\n  },\n  data(): ReportingPageState {\n    return {\n      loading: false,\n      hasRawData: false,\n      hasNoVisits: false,\n      dateLastChecked: null,\n      hasNoPage: false,\n    };\n  },\n  created() {\n    ReportingPageStoreInstance.resetPage();\n\n    this.loading = true; // we only set loading on initial load\n    this.renderInitialPage();\n\n    watch(() => MatomoUrl.parsed.value, (newValue, oldValue) => {\n      if (newValue.category === oldValue.category\n        && newValue.subcategory === oldValue.subcategory\n        && newValue.period === oldValue.period\n        && newValue.date === oldValue.date\n        && newValue.segment === oldValue.segment\n        && JSON.stringify(newValue.compareDates) === JSON.stringify(oldValue.compareDates)\n        && JSON.stringify(newValue.comparePeriods) === JSON.stringify(oldValue.comparePeriods)\n        && JSON.stringify(newValue.compareSegments) === JSON.stringify(oldValue.compareSegments)\n        && JSON.stringify(newValue.columns || '') === JSON.stringify(oldValue.columns || '')\n      ) {\n        // this page is already loaded\n        return;\n      }\n\n      if (newValue.date !== oldValue.date || newValue.period !== oldValue.period) {\n        hideOnlyRawDataNoticifation();\n        this.dateLastChecked = null;\n        this.hasRawData = false;\n        this.hasNoVisits = false;\n      }\n\n      this.renderPage(newValue.category as string, newValue.subcategory as string);\n    });\n\n    Matomo.on('loadPage', (category: string, subcategory: string) => {\n      this.renderPage(category, subcategory);\n    });\n  },\n  computed: {\n    widgets() {\n      return ReportingPageStoreInstance.widgets.value;\n    },\n  },\n  methods: {\n    renderPage(category: string, subcategory: string) {\n      if (!category || !subcategory) {\n        ReportingPageStoreInstance.resetPage();\n        this.loading = false;\n        return;\n      }\n\n      const parsedUrl = MatomoUrl.parsed.value;\n      const currentPeriod = parsedUrl.period as string;\n      const currentDate = parsedUrl.date as string;\n\n      try {\n        Periods.parse(currentPeriod, currentDate);\n      } catch (e) {\n        NotificationsStore.show({\n          id: 'invalidDate',\n          animate: false,\n          context: 'error',\n          message: translate('CoreHome_DateInvalid'),\n          type: 'transient',\n        });\n\n        ReportingPageStoreInstance.resetPage();\n        this.loading = false;\n        return;\n      }\n\n      NotificationsStore.remove('invalidDate');\n\n      Matomo.postEvent('matomoPageChange', {});\n\n      NotificationsStore.clearTransientNotifications();\n\n      if (Periods.parse(currentPeriod, currentDate).containsToday()) {\n        this.showOnlyRawDataMessageIfRequired();\n      }\n\n      const params: LoadPageArgs = { category, subcategory };\n      Matomo.postEvent('ReportingPage.loadPage', params);\n      if (params.promise) {\n        this.loading = true;\n        Promise.resolve(params.promise).finally(() => {\n          this.loading = false;\n        });\n        return;\n      }\n\n      ReportingPageStoreInstance.fetchPage(category, subcategory).then(() => {\n        const hasNoPage = !ReportingPageStoreInstance.page.value;\n        if (hasNoPage) {\n          const page = ReportingPagesStoreInstance.findPageInCategory(category);\n          if (page && page.subcategory) {\n            MatomoUrl.updateHash({\n              ...MatomoUrl.hashParsed.value,\n              subcategory: page.subcategory.id,\n            });\n            return;\n          }\n        }\n\n        this.hasNoPage = hasNoPage;\n        this.loading = false;\n      });\n    },\n    renderInitialPage() {\n      const parsed = MatomoUrl.parsed.value;\n      this.renderPage(parsed.category as string, parsed.subcategory as string);\n    },\n    showOnlyRawDataMessageIfRequired() {\n      if (!Matomo.visitorLogEnabled) {\n        return;\n      }\n\n      if (this.hasRawData && this.hasNoVisits) {\n        showOnlyRawDataNotification();\n      }\n\n      const parsedUrl = MatomoUrl.parsed.value;\n\n      const { segment } = parsedUrl;\n      if (segment) {\n        hideOnlyRawDataNoticifation();\n        return;\n      }\n\n      const subcategoryExceptions = [\n        'Live_VisitorLog',\n        'General_RealTime',\n        'UserCountryMap_RealTimeMap',\n        'MediaAnalytics_TypeAudienceLog',\n        'MediaAnalytics_TypeRealTime',\n        'FormAnalytics_TypeRealTime',\n        'Goals_AddNewGoal',\n      ];\n\n      const categoryExceptions = [\n        'HeatmapSessionRecording_Heatmaps',\n        'HeatmapSessionRecording_SessionRecordings',\n        'Marketplace_Marketplace',\n      ];\n\n      const subcategory = parsedUrl.subcategory as string;\n      const category = parsedUrl.category as string;\n      if (subcategoryExceptions.indexOf(subcategory) !== -1\n        || categoryExceptions.indexOf(category) !== -1\n        || subcategory.toLowerCase().indexOf('manage') !== -1\n      ) {\n        hideOnlyRawDataNoticifation();\n        return;\n      }\n\n      const minuteInMilliseconds = 60000;\n      if (this.dateLastChecked\n        && ((new Date()).valueOf() - this.dateLastChecked.valueOf()) < minuteInMilliseconds\n      ) {\n        return;\n      }\n\n      AjaxHelper.fetch({ method: 'VisitsSummary.getVisits' }).then((json) => {\n        this.dateLastChecked = new Date();\n\n        if (json.value > 0) {\n          this.hasNoVisits = false;\n          hideOnlyRawDataNoticifation();\n          return undefined;\n        }\n\n        this.hasNoVisits = true;\n\n        if (this.hasRawData) {\n          showOnlyRawDataNotification();\n          return undefined;\n        }\n\n        return AjaxHelper.fetch({\n          method: 'Live.getLastVisitsDetails',\n          filter_limit: 1,\n          doNotFetchActions: 1,\n        }).then((lastVisits) => {\n          if (!lastVisits || lastVisits.length === 0) {\n            this.hasRawData = false;\n            hideOnlyRawDataNoticifation();\n            return;\n          }\n\n          this.hasRawData = true;\n          showOnlyRawDataNotification();\n        });\n      });\n    },\n  },\n});\n","import { render } from \"./ReportingPage.vue?vue&type=template&id=e7476c22\"\nimport script from \"./ReportingPage.vue?vue&type=script&lang=ts\"\nexport * from \"./ReportingPage.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"report-export-popover row\" id=\"reportExport\">\n\n    <div class=\"col l6\">\n      <div name=\"format\">\n        <Field\n          :uicontrol=\"'radio'\"\n          :name=\"'format'\"\n          :title=\"translate('CoreHome_ExportFormat')\"\n          v-model=\"reportFormat\"\n          :full-width=\"true\"\n          :options=\"availableReportFormats[reportType]\"\n        />\n      </div>\n\n      <div>\n        <div name=\"option_flat\">\n          <Field\n            :uicontrol=\"'checkbox'\"\n            :name=\"'option_flat'\"\n            :title=\"translate('CoreHome_FlattenReport')\"\n            v-model=\"optionFlat\"\n            v-show=\"hasSubtables\"\n          >\n          </Field>\n        </div>\n      </div>\n      <div>\n        <div name=\"option_expanded\">\n          <Field\n            :uicontrol=\"'checkbox'\"\n            :name=\"'option_expanded'\"\n            :title=\"translate('CoreHome_ExpandSubtables')\"\n            v-model=\"optionExpanded\"\n            v-show=\"hasSubtables && !optionFlat\"\n          >\n          </Field>\n        </div>\n      </div>\n      <div>\n        <div name=\"option_format_metrics\">\n          <Field\n            :uicontrol=\"'checkbox'\"\n            :name=\"'option_format_metrics'\"\n            :title=\"translate('CoreHome_FormatMetrics')\"\n            v-model=\"optionFormatMetrics\"\n          >\n          </Field>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"col l6\">\n      <div>\n        <div name=\"filter_type\">\n          <Field\n            :uicontrol=\"'radio'\"\n            :name=\"'filter_type'\"\n            :title=\"translate('CoreHome_ReportType')\"\n            v-model=\"reportType\"\n            :full-width=\"true\"\n            :options=\"availableReportTypes\"\n          >\n          </Field>\n        </div>\n      </div>\n\n      <div class=\"filter_limit\">\n        <div v-show=\"!maxFilterLimit || maxFilterLimit <= 0\" name=\"filter_limit_all\">\n          <Field\n            :uicontrol=\"'radio'\"\n            :name=\"'filter_limit_all'\"\n            :title=\"translate('CoreHome_RowLimit')\"\n            v-model=\"reportLimitAll\"\n\n            :full-width=\"true\"\n            :options=\"limitAllOptions\"\n          >\n          </Field>\n        </div>\n\n        <div v-if=\"reportLimitAll === 'no' && maxFilterLimit <= 0\" name=\"filter_limit\">\n          <Field\n            :uicontrol=\"'number'\"\n            name=\"filter_limit\"\n            :min=\"1\"\n            v-model=\"reportLimit\"\n            :full-width=\"true\"\n          >\n          </Field>\n        </div>\n\n        <div v-if=\"reportLimitAll === 'no' && maxFilterLimit > 0\" name=\"filter_limit\">\n          <Field\n            :uicontrol=\"'number'\"\n            :name=\"'filter_limit'\"\n            :min=\"1\"\n            :max=\"maxFilterLimit\"\n            v-model=\"reportLimit\"\n            :value=\"reportLimit\"\n            :full-width=\"true\"\n            :title=\"filterLimitTooltip\"\n          >\n          </Field>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"col l12\" v-show=\"showUrl\">\n      <textarea\n        v-select-on-focus=\"{}\"\n        readonly\n        class=\"exportFullUrl\"\n        :value=\"exportLinkWithoutToken\"\n      >\n      </textarea>\n      <div class=\"tooltip\" v-html=\"$sanitize(translate(\n        'CoreHome_ExportTooltipWithLink',\n        '<a target=_blank href=\\'?module=UsersManager&action=userSecurity\\'>',\n        '</a>',\n        'ENTER_YOUR_TOKEN_AUTH_HERE',\n      ))\"></div>\n    </div>\n\n    <div class=\"col l12\">\n      <a\n        class=\"btn\"\n        :href=\"exportLink\"\n        target=\"_new\"\n        :title=\"translate('CoreHome_ExportTooltip')\"\n      >{{ translate('General_Export') }}</a>\n      <a href=\"javascript:\" @click=\"showUrl=!showUrl\" class=\"toggle-export-url\">\n        <span v-show=\"!showUrl\">{{ translate('CoreHome_ShowExportUrl') }}</span>\n        <span v-show=\"showUrl\">{{ translate('CoreHome_HideExportUrl') }}</span>\n      </a>\n    </div>\n\n    <div class=\"col l12 report-export-popover-footer\"\n         v-if=\"additionalContent\" v-html=\"$sanitize(additionalContent)\"></div>\n\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\nimport SelectOnFocus from '../SelectOnFocus/SelectOnFocus';\nimport Matomo from '../Matomo/Matomo';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { translate } from '../translate';\n\ninterface DataTable {\n  param: Record<string, string|string[]>;\n  props: Record<string, string|string[]>;\n}\n\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nexport default defineComponent({\n  components: {\n    Field,\n  },\n  directives: {\n    SelectOnFocus,\n  },\n  props: {\n    hasSubtables: Boolean,\n    availableReportTypes: Object,\n    availableReportFormats: {\n      type: Object,\n      required: true,\n    },\n    maxFilterLimit: Number,\n    limitAllOptions: Object,\n    dataTable: {\n      type: Object,\n      required: true,\n    },\n    requestParams: [Object, String],\n    apiMethod: {\n      type: String,\n      required: true,\n    },\n    initialReportType: {\n      type: String,\n      default: 'default',\n    },\n    initialReportLimit: {\n      type: [String, Number],\n      default: 100,\n    },\n    initialReportLimitAll: {\n      type: String,\n      default: 'yes',\n    },\n    initialOptionFlat: {\n      type: Boolean,\n      default: false,\n    },\n    initialOptionExpanded: {\n      type: Boolean,\n      default: true,\n    },\n    initialOptionFormatMetrics: {\n      type: Boolean,\n      default: false,\n    },\n    initialReportFormat: {\n      type: String,\n      default: 'XML',\n    },\n  },\n  mounted() {\n    // pass data as object, so it can be manipulated by subscribers\n    const parameters = { content: this.additionalContent, dataTable: this.dataTable };\n    Matomo.postEvent('ReportExportPopover.additionalContent', parameters);\n    this.additionalContent = parameters.content;\n  },\n  data() {\n    return {\n      showUrl: false,\n      reportFormat: this.initialReportFormat,\n      optionFlat: this.initialOptionFlat,\n      optionExpanded: this.initialOptionExpanded,\n      optionFormatMetrics: this.initialOptionFormatMetrics,\n      reportType: this.initialReportType,\n      reportLimitAll: this.initialReportLimitAll,\n      reportLimit: typeof this.initialReportLimit === 'string'\n        ? parseInt(this.initialReportLimit, 10)\n        : this.initialReportLimit,\n      additionalContent: '',\n    };\n  },\n  watch: {\n    reportType(newVal) {\n      if (!this.availableReportFormats[newVal][this.reportFormat]) {\n        this.reportFormat = 'XML';\n      }\n    },\n    reportLimit(newVal, oldVal) {\n      if (this.maxFilterLimit && this.maxFilterLimit > 0 && newVal > this.maxFilterLimit) {\n        this.reportLimit = oldVal;\n      }\n    },\n  },\n  computed: {\n    filterLimitTooltip() {\n      const rowLimit = translate('CoreHome_RowLimit');\n      const computedMetricMax = this.maxFilterLimit\n        ? translate(\n          'General_ComputedMetricMax',\n          this.maxFilterLimit.toString(),\n        )\n        : '';\n      return `${rowLimit} (${computedMetricMax})`;\n    },\n    exportLink() {\n      return this.getExportLink(true);\n    },\n    exportLinkWithoutToken() {\n      return this.getExportLink(false);\n    },\n  },\n  methods: {\n    getExportLink(withToken = true) {\n      const {\n        reportFormat,\n        apiMethod,\n        reportType,\n      } = this;\n\n      const dataTable: DataTable = this.dataTable as DataTable;\n\n      if (!reportFormat) {\n        return undefined;\n      }\n\n      let requestParams: Record<string, unknown> = {};\n\n      const limit = this.reportLimitAll === 'yes' ? -1 : this.reportLimit;\n\n      if (this.requestParams && typeof this.requestParams === 'string') {\n        requestParams = JSON.parse(this.requestParams);\n      } else if (this.requestParams && typeof this.requestParams === 'object') {\n        requestParams = this.requestParams as Record<string, unknown>;\n      }\n\n      const {\n        segment,\n        label,\n        idGoal,\n        idDimension,\n        idSite,\n      } = dataTable.param;\n\n      let { date, period } = dataTable.param;\n\n      if (reportFormat === 'RSS') {\n        date = 'last10';\n      }\n      if (typeof dataTable.param.dateUsedInGraph !== 'undefined') {\n        date = dataTable.param.dateUsedInGraph;\n      }\n\n      const formatsUseDayNotRange = (Matomo.config.datatable_export_range_as_day as string)\n        .toLowerCase();\n\n      if (formatsUseDayNotRange.indexOf(reportFormat.toLowerCase()) !== -1\n        && dataTable.param.period === 'range'\n      ) {\n        period = 'day';\n      }\n\n      // Below evolution graph, show daily exports\n      if (dataTable.param.period === 'range'\n        && dataTable.param.viewDataTable === 'graphEvolution'\n      ) {\n        period = 'day';\n      }\n\n      const exportUrlParams: QueryParameters = {\n        module: 'API',\n        format: reportFormat,\n        idSite,\n        period,\n        date,\n      };\n\n      if (reportType === 'processed') {\n        exportUrlParams.method = 'API.getProcessedReport';\n        [exportUrlParams.apiModule, exportUrlParams.apiAction] = apiMethod.split('.');\n      } else {\n        exportUrlParams.method = apiMethod;\n      }\n\n      if (dataTable.param.compareDates\n        && dataTable.param.compareDates.length\n      ) {\n        exportUrlParams.compareDates = dataTable.param.compareDates;\n        exportUrlParams.compare = '1';\n      }\n\n      if (dataTable.param.comparePeriods\n        && dataTable.param.comparePeriods.length\n      ) {\n        exportUrlParams.comparePeriods = dataTable.param.comparePeriods;\n        exportUrlParams.compare = '1';\n      }\n\n      if (dataTable.param.compareSegments\n        && dataTable.param.compareSegments.length\n      ) {\n        exportUrlParams.compareSegments = dataTable.param.compareSegments;\n        exportUrlParams.compare = '1';\n      }\n\n      if (typeof dataTable.param.filter_pattern !== 'undefined') {\n        exportUrlParams.filter_pattern = dataTable.param.filter_pattern;\n      }\n\n      if (typeof dataTable.param.filter_pattern_recursive !== 'undefined') {\n        exportUrlParams.filter_pattern_recursive = dataTable.param.filter_pattern_recursive;\n      }\n\n      if (window.$.isPlainObject(requestParams)) {\n        Object.entries(requestParams).forEach(([index, param]) => {\n          let value = param;\n          if (value === true) {\n            value = 1;\n          } else if (value === false) {\n            value = 0;\n          }\n          exportUrlParams[index] = value as QueryParameterValue;\n        });\n      }\n\n      if (this.optionFlat) {\n        exportUrlParams.flat = 1;\n        if (typeof dataTable.param.include_aggregate_rows !== 'undefined'\n          && dataTable.param.include_aggregate_rows === '1'\n        ) {\n          exportUrlParams.include_aggregate_rows = 1;\n        }\n      }\n\n      if (!this.optionFlat && this.optionExpanded) {\n        exportUrlParams.expanded = 1;\n      }\n\n      if (this.optionFormatMetrics) {\n        exportUrlParams.format_metrics = 1;\n      }\n\n      if (dataTable.param.pivotBy) {\n        exportUrlParams.pivotBy = dataTable.param.pivotBy;\n        exportUrlParams.pivotByColumnLimit = 20;\n\n        if (dataTable.props.pivot_by_column) {\n          exportUrlParams.pivotByColumn = dataTable.props.pivot_by_column;\n        }\n      }\n\n      if (reportFormat === 'CSV' || reportFormat === 'TSV' || reportFormat === 'RSS') {\n        exportUrlParams.translateColumnNames = 1;\n        exportUrlParams.language = Matomo.language;\n      }\n\n      if (typeof segment !== 'undefined') {\n        exportUrlParams.segment = decodeURIComponent(segment as string);\n      }\n\n      // Export Goals specific reports\n      if (typeof idGoal !== 'undefined'\n        && idGoal !== '-1'\n      ) {\n        exportUrlParams.idGoal = idGoal;\n      }\n\n      // Export Dimension specific reports\n      if (typeof idDimension !== 'undefined'\n        && idDimension !== '-1'\n      ) {\n        exportUrlParams.idDimension = idDimension;\n      }\n\n      if (label) {\n        const labelParts = (label as string).split(',');\n\n        if (labelParts.length > 1) {\n          exportUrlParams.label = labelParts;\n        } else {\n          [exportUrlParams.label] = labelParts;\n        }\n      }\n\n      exportUrlParams.token_auth = 'ENTER_YOUR_TOKEN_AUTH_HERE';\n\n      if (withToken === true) {\n        exportUrlParams.token_auth = Matomo.token_auth;\n        exportUrlParams.force_api_session = 1;\n      }\n\n      exportUrlParams.filter_limit = limit;\n\n      const prefix = window.location.href.split('?')[0];\n      return `${prefix}?${MatomoUrl.stringify(exportUrlParams)}`;\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport useExternalPluginComponent from '../useExternalPluginComponent';\nimport SelectOnFocus from '../SelectOnFocus/SelectOnFocus';\nimport Matomo from '../Matomo/Matomo';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { translate } from '../translate';\n\ninterface DataTable {\n  param: Record<string, string|string[]>;\n  props: Record<string, string|string[]>;\n}\n\nconst Field = useExternalPluginComponent('CorePluginsAdmin', 'Field');\n\nexport default defineComponent({\n  components: {\n    Field,\n  },\n  directives: {\n    SelectOnFocus,\n  },\n  props: {\n    hasSubtables: Boolean,\n    availableReportTypes: Object,\n    availableReportFormats: {\n      type: Object,\n      required: true,\n    },\n    maxFilterLimit: Number,\n    limitAllOptions: Object,\n    dataTable: {\n      type: Object,\n      required: true,\n    },\n    requestParams: [Object, String],\n    apiMethod: {\n      type: String,\n      required: true,\n    },\n    initialReportType: {\n      type: String,\n      default: 'default',\n    },\n    initialReportLimit: {\n      type: [String, Number],\n      default: 100,\n    },\n    initialReportLimitAll: {\n      type: String,\n      default: 'yes',\n    },\n    initialOptionFlat: {\n      type: Boolean,\n      default: false,\n    },\n    initialOptionExpanded: {\n      type: Boolean,\n      default: true,\n    },\n    initialOptionFormatMetrics: {\n      type: Boolean,\n      default: false,\n    },\n    initialReportFormat: {\n      type: String,\n      default: 'XML',\n    },\n  },\n  mounted() {\n    // pass data as object, so it can be manipulated by subscribers\n    const parameters = { content: this.additionalContent, dataTable: this.dataTable };\n    Matomo.postEvent('ReportExportPopover.additionalContent', parameters);\n    this.additionalContent = parameters.content;\n  },\n  data() {\n    return {\n      showUrl: false,\n      reportFormat: this.initialReportFormat,\n      optionFlat: this.initialOptionFlat,\n      optionExpanded: this.initialOptionExpanded,\n      optionFormatMetrics: this.initialOptionFormatMetrics,\n      reportType: this.initialReportType,\n      reportLimitAll: this.initialReportLimitAll,\n      reportLimit: typeof this.initialReportLimit === 'string'\n        ? parseInt(this.initialReportLimit, 10)\n        : this.initialReportLimit,\n      additionalContent: '',\n    };\n  },\n  watch: {\n    reportType(newVal) {\n      if (!this.availableReportFormats[newVal][this.reportFormat]) {\n        this.reportFormat = 'XML';\n      }\n    },\n    reportLimit(newVal, oldVal) {\n      if (this.maxFilterLimit && this.maxFilterLimit > 0 && newVal > this.maxFilterLimit) {\n        this.reportLimit = oldVal;\n      }\n    },\n  },\n  computed: {\n    filterLimitTooltip() {\n      const rowLimit = translate('CoreHome_RowLimit');\n      const computedMetricMax = this.maxFilterLimit\n        ? translate(\n          'General_ComputedMetricMax',\n          this.maxFilterLimit.toString(),\n        )\n        : '';\n      return `${rowLimit} (${computedMetricMax})`;\n    },\n    exportLink() {\n      return this.getExportLink(true);\n    },\n    exportLinkWithoutToken() {\n      return this.getExportLink(false);\n    },\n  },\n  methods: {\n    getExportLink(withToken = true) {\n      const {\n        reportFormat,\n        apiMethod,\n        reportType,\n      } = this;\n\n      const dataTable: DataTable = this.dataTable as DataTable;\n\n      if (!reportFormat) {\n        return undefined;\n      }\n\n      let requestParams: Record<string, unknown> = {};\n\n      const limit = this.reportLimitAll === 'yes' ? -1 : this.reportLimit;\n\n      if (this.requestParams && typeof this.requestParams === 'string') {\n        requestParams = JSON.parse(this.requestParams);\n      } else if (this.requestParams && typeof this.requestParams === 'object') {\n        requestParams = this.requestParams as Record<string, unknown>;\n      }\n\n      const {\n        segment,\n        label,\n        idGoal,\n        idDimension,\n        idSite,\n      } = dataTable.param;\n\n      let { date, period } = dataTable.param;\n\n      if (reportFormat === 'RSS') {\n        date = 'last10';\n      }\n      if (typeof dataTable.param.dateUsedInGraph !== 'undefined') {\n        date = dataTable.param.dateUsedInGraph;\n      }\n\n      const formatsUseDayNotRange = (Matomo.config.datatable_export_range_as_day as string)\n        .toLowerCase();\n\n      if (formatsUseDayNotRange.indexOf(reportFormat.toLowerCase()) !== -1\n        && dataTable.param.period === 'range'\n      ) {\n        period = 'day';\n      }\n\n      // Below evolution graph, show daily exports\n      if (dataTable.param.period === 'range'\n        && dataTable.param.viewDataTable === 'graphEvolution'\n      ) {\n        period = 'day';\n      }\n\n      const exportUrlParams: QueryParameters = {\n        module: 'API',\n        format: reportFormat,\n        idSite,\n        period,\n        date,\n      };\n\n      if (reportType === 'processed') {\n        exportUrlParams.method = 'API.getProcessedReport';\n        [exportUrlParams.apiModule, exportUrlParams.apiAction] = apiMethod.split('.');\n      } else {\n        exportUrlParams.method = apiMethod;\n      }\n\n      if (dataTable.param.compareDates\n        && dataTable.param.compareDates.length\n      ) {\n        exportUrlParams.compareDates = dataTable.param.compareDates;\n        exportUrlParams.compare = '1';\n      }\n\n      if (dataTable.param.comparePeriods\n        && dataTable.param.comparePeriods.length\n      ) {\n        exportUrlParams.comparePeriods = dataTable.param.comparePeriods;\n        exportUrlParams.compare = '1';\n      }\n\n      if (dataTable.param.compareSegments\n        && dataTable.param.compareSegments.length\n      ) {\n        exportUrlParams.compareSegments = dataTable.param.compareSegments;\n        exportUrlParams.compare = '1';\n      }\n\n      if (typeof dataTable.param.filter_pattern !== 'undefined') {\n        exportUrlParams.filter_pattern = dataTable.param.filter_pattern;\n      }\n\n      if (typeof dataTable.param.filter_pattern_recursive !== 'undefined') {\n        exportUrlParams.filter_pattern_recursive = dataTable.param.filter_pattern_recursive;\n      }\n\n      if (window.$.isPlainObject(requestParams)) {\n        Object.entries(requestParams).forEach(([index, param]) => {\n          let value = param;\n          if (value === true) {\n            value = 1;\n          } else if (value === false) {\n            value = 0;\n          }\n          exportUrlParams[index] = value as QueryParameterValue;\n        });\n      }\n\n      if (this.optionFlat) {\n        exportUrlParams.flat = 1;\n        if (typeof dataTable.param.include_aggregate_rows !== 'undefined'\n          && dataTable.param.include_aggregate_rows === '1'\n        ) {\n          exportUrlParams.include_aggregate_rows = 1;\n        }\n      }\n\n      if (!this.optionFlat && this.optionExpanded) {\n        exportUrlParams.expanded = 1;\n      }\n\n      if (this.optionFormatMetrics) {\n        exportUrlParams.format_metrics = 1;\n      }\n\n      if (dataTable.param.pivotBy) {\n        exportUrlParams.pivotBy = dataTable.param.pivotBy;\n        exportUrlParams.pivotByColumnLimit = 20;\n\n        if (dataTable.props.pivot_by_column) {\n          exportUrlParams.pivotByColumn = dataTable.props.pivot_by_column;\n        }\n      }\n\n      if (reportFormat === 'CSV' || reportFormat === 'TSV' || reportFormat === 'RSS') {\n        exportUrlParams.translateColumnNames = 1;\n        exportUrlParams.language = Matomo.language;\n      }\n\n      if (typeof segment !== 'undefined') {\n        exportUrlParams.segment = decodeURIComponent(segment as string);\n      }\n\n      // Export Goals specific reports\n      if (typeof idGoal !== 'undefined'\n        && idGoal !== '-1'\n      ) {\n        exportUrlParams.idGoal = idGoal;\n      }\n\n      // Export Dimension specific reports\n      if (typeof idDimension !== 'undefined'\n        && idDimension !== '-1'\n      ) {\n        exportUrlParams.idDimension = idDimension;\n      }\n\n      if (label) {\n        const labelParts = (label as string).split(',');\n\n        if (labelParts.length > 1) {\n          exportUrlParams.label = labelParts;\n        } else {\n          [exportUrlParams.label] = labelParts;\n        }\n      }\n\n      exportUrlParams.token_auth = 'ENTER_YOUR_TOKEN_AUTH_HERE';\n\n      if (withToken === true) {\n        exportUrlParams.token_auth = Matomo.token_auth;\n        exportUrlParams.force_api_session = 1;\n      }\n\n      exportUrlParams.filter_limit = limit;\n\n      const prefix = window.location.href.split('?')[0];\n      return `${prefix}?${MatomoUrl.stringify(exportUrlParams)}`;\n    },\n  },\n});\n","import { render } from \"./ReportExportPopover.vue?vue&type=template&id=750b5580\"\nimport script from \"./ReportExportPopover.vue?vue&type=script&lang=ts\"\nexport * from \"./ReportExportPopover.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { DirectiveBinding } from 'vue';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport { translate } from '../translate';\nimport ReportExportPopover from './ReportExportPopover.vue';\nimport Matomo from '../Matomo/Matomo';\nimport createVueApp from '../createVueApp';\n\ninterface ReportExportArgs {\n  reportTitle: string;\n  requestParams: QueryParameters;\n  reportFormats: Record<string, unknown>;\n  apiMethod: string;\n  maxFilterLimit: number;\n  onClose?: () => void;\n}\n\nconst { $ } = window;\n\nexport default {\n  mounted(el: HTMLElement, binding: DirectiveBinding<ReportExportArgs>): void {\n    el.addEventListener('click', () => {\n      const popoverParamBackup = MatomoUrl.hashParsed.value.popover;\n\n      const dataTable = $(el).closest('[data-report]').data('uiControlObject');\n      const popover = window.Piwik_Popover.showLoading('Export');\n\n      const formats = binding.value.reportFormats;\n\n      let reportLimit = dataTable.param.filter_limit;\n      if (binding.value.maxFilterLimit > 0) {\n        reportLimit = Math.min(reportLimit, binding.value.maxFilterLimit);\n      }\n\n      const optionFlat = dataTable.param.flat === true\n        || dataTable.param.flat === 1\n        || dataTable.param.flat === '1';\n\n      const props = {\n        initialReportType: 'default',\n        initialReportLimit: reportLimit > 0 ? reportLimit : 100,\n        initialReportLimitAll: reportLimit === -1 ? 'yes' : 'no',\n        initialOptionFlat: optionFlat,\n        initialOptionExpanded: true,\n        initialOptionFormatMetrics: false,\n        hasSubtables: optionFlat || dataTable.numberOfSubtables > 0,\n        availableReportFormats: {\n          default: formats,\n          processed: {\n            XML: formats.XML,\n            JSON: formats.JSON,\n          },\n        },\n        availableReportTypes: {\n          default: translate('CoreHome_StandardReport'),\n          processed: translate('CoreHome_ReportWithMetadata'),\n        },\n        limitAllOptions: {\n          yes: translate('General_All'),\n          no: translate('CoreHome_CustomLimit'),\n        },\n        maxFilterLimit: binding.value.maxFilterLimit,\n        dataTable,\n        requestParams: binding.value.requestParams,\n        apiMethod: binding.value.apiMethod,\n      };\n\n      const app = createVueApp({\n        template: `\n          <popover v-bind=\"bind\"/>`,\n        data() {\n          return {\n            bind: props,\n          };\n        },\n      });\n      app.component('popover', ReportExportPopover);\n\n      const mountPoint = document.createElement('div');\n      app.mount(mountPoint);\n\n      const { reportTitle } = binding.value;\n      window.Piwik_Popover.setTitle(\n        `${translate('General_Export')} ${Matomo.helper.htmlEntities(reportTitle)}`,\n      );\n      window.Piwik_Popover.setContent(mountPoint);\n\n      window.Piwik_Popover.onClose(() => {\n        app.unmount();\n\n        if (popoverParamBackup !== '') {\n          setTimeout(() => {\n            MatomoUrl.updateHash({\n              ...MatomoUrl.hashParsed.value,\n              popover: popoverParamBackup,\n            });\n\n            if (binding.value.onClose) {\n              binding.value.onClose();\n            }\n          }, 100);\n        }\n      });\n\n      setTimeout(() => {\n        popover.dialog();\n\n        $('.exportFullUrl, .btn', popover).tooltip({\n          track: true,\n          show: false,\n          hide: false,\n        });\n      }, 100);\n    });\n  },\n};\n","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <img\n    class=\"sparklineImg\"\n    loading=\"lazy\"\n    alt=\"\"\n    :src=\"sparklineUrl\"\n    :width=\"width\"\n    :height=\"height\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport RangePeriod from '../Periods/Range';\nimport { format } from '../Periods';\n\nexport default defineComponent({\n  props: {\n    seriesIndices: Array,\n    params: [Object, String],\n    width: Number,\n    height: Number,\n  },\n  data() {\n    return {\n      isWidget: false,\n    };\n  },\n  mounted() {\n    this.isWidget = !!this.$el.closest('[widgetId]');\n  },\n  computed: {\n    sparklineUrl() {\n      const { seriesIndices, params } = this;\n\n      const sparklineColors = Matomo.getSparklineColors();\n\n      if (seriesIndices) {\n        sparklineColors.lineColor = sparklineColors.lineColor.filter(\n          (c, index) => seriesIndices.indexOf(index) !== -1,\n        );\n      }\n\n      const colors = JSON.stringify(sparklineColors);\n\n      const defaultParams = {\n        forceView: '1',\n        viewDataTable: 'sparkline',\n        widget: this.isWidget ? '1' : '0',\n        showtitle: '1',\n        colors,\n        random: Date.now(),\n        date: this.defaultDate,\n        // mixinDefaultGetParams() will use the raw, encoded value from the URL (legacy behavior),\n        // which means MatomoUrl.stringify() will end up double encoding it if we don't set it\n        // ourselves here.\n        segment: MatomoUrl.parsed.value.segment as string,\n      };\n\n      const givenParams = typeof params === 'object'\n        ? params as QueryParameters\n        : MatomoUrl.parse((params as string).substring((params as string).indexOf('?') + 1));\n\n      const helper = new AjaxHelper();\n      const urlParams = helper.mixinDefaultGetParams({ ...defaultParams, ...givenParams });\n\n      // Append the token_auth to the URL if it was set (eg. embed dashboard)\n      const token_auth = MatomoUrl.parsed.value.token_auth as string;\n      if (token_auth && token_auth.length && Matomo.shouldPropagateTokenAuth) {\n        urlParams.token_auth = token_auth;\n      }\n\n      return `?${MatomoUrl.stringify(urlParams)}`;\n    },\n    defaultDate() {\n      if (Matomo.period === 'range') {\n        return `${Matomo.startDateString},${Matomo.endDateString}`;\n      }\n\n      const dateRange = RangePeriod.getLastNRange(\n        Matomo.period!,\n        30,\n        Matomo.currentDateString!,\n      ).getDateRange();\n\n      const piwikMinDate = new Date(Matomo.minDateYear, Matomo.minDateMonth - 1, Matomo.minDateDay);\n      if (dateRange[0] < piwikMinDate) {\n        dateRange[0] = piwikMinDate;\n      }\n\n      const startDateStr = format(dateRange[0]);\n      const endDateStr = format(dateRange[1]);\n\n      return `${startDateStr},${endDateStr}`;\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport Matomo from '../Matomo/Matomo';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport RangePeriod from '../Periods/Range';\nimport { format } from '../Periods';\n\nexport default defineComponent({\n  props: {\n    seriesIndices: Array,\n    params: [Object, String],\n    width: Number,\n    height: Number,\n  },\n  data() {\n    return {\n      isWidget: false,\n    };\n  },\n  mounted() {\n    this.isWidget = !!this.$el.closest('[widgetId]');\n  },\n  computed: {\n    sparklineUrl() {\n      const { seriesIndices, params } = this;\n\n      const sparklineColors = Matomo.getSparklineColors();\n\n      if (seriesIndices) {\n        sparklineColors.lineColor = sparklineColors.lineColor.filter(\n          (c, index) => seriesIndices.indexOf(index) !== -1,\n        );\n      }\n\n      const colors = JSON.stringify(sparklineColors);\n\n      const defaultParams = {\n        forceView: '1',\n        viewDataTable: 'sparkline',\n        widget: this.isWidget ? '1' : '0',\n        showtitle: '1',\n        colors,\n        random: Date.now(),\n        date: this.defaultDate,\n        // mixinDefaultGetParams() will use the raw, encoded value from the URL (legacy behavior),\n        // which means MatomoUrl.stringify() will end up double encoding it if we don't set it\n        // ourselves here.\n        segment: MatomoUrl.parsed.value.segment as string,\n      };\n\n      const givenParams = typeof params === 'object'\n        ? params as QueryParameters\n        : MatomoUrl.parse((params as string).substring((params as string).indexOf('?') + 1));\n\n      const helper = new AjaxHelper();\n      const urlParams = helper.mixinDefaultGetParams({ ...defaultParams, ...givenParams });\n\n      // Append the token_auth to the URL if it was set (eg. embed dashboard)\n      const token_auth = MatomoUrl.parsed.value.token_auth as string;\n      if (token_auth && token_auth.length && Matomo.shouldPropagateTokenAuth) {\n        urlParams.token_auth = token_auth;\n      }\n\n      return `?${MatomoUrl.stringify(urlParams)}`;\n    },\n    defaultDate() {\n      if (Matomo.period === 'range') {\n        return `${Matomo.startDateString},${Matomo.endDateString}`;\n      }\n\n      const dateRange = RangePeriod.getLastNRange(\n        Matomo.period!,\n        30,\n        Matomo.currentDateString!,\n      ).getDateRange();\n\n      const piwikMinDate = new Date(Matomo.minDateYear, Matomo.minDateMonth - 1, Matomo.minDateDay);\n      if (dateRange[0] < piwikMinDate) {\n        dateRange[0] = piwikMinDate;\n      }\n\n      const startDateStr = format(dateRange[0]);\n      const endDateStr = format(dateRange[1]);\n\n      return `${startDateStr},${endDateStr}`;\n    },\n  },\n});\n","import { render } from \"./Sparkline.vue?vue&type=template&id=e9246a38\"\nimport script from \"./Sparkline.vue?vue&type=script&lang=ts\"\nexport * from \"./Sparkline.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div class=\"progressbar\">\n    <div class=\"progress\">\n      <div\n        class=\"determinate\"\n        style=\"width: 0\"\n        :style=\"{ width: `${actualProgress}%` }\"\n      />\n    </div>\n    <span v-show=\"!!label\">\n      <img src=\"plugins/Morpheus/images/loading-blue.gif\" style=\"margin-right: 3.5px\" />\n      <span class=\"label\" v-html=\"$sanitize(label)\" />\n    </span>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  props: {\n    progress: {\n      type: Number,\n      required: true,\n    },\n    label: String,\n  },\n  computed: {\n    actualProgress() {\n      if (this.progress > 100) {\n        return 100;\n      }\n\n      if (this.progress < 0) {\n        return 0;\n      }\n\n      return this.progress;\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n  props: {\n    progress: {\n      type: Number,\n      required: true,\n    },\n    label: String,\n  },\n  computed: {\n    actualProgress() {\n      if (this.progress > 100) {\n        return 100;\n      }\n\n      if (this.progress < 0) {\n        return 0;\n      }\n\n      return this.progress;\n    },\n  },\n});\n","import { render } from \"./Progressbar.vue?vue&type=template&id=0048ddd7\"\nimport script from \"./Progressbar.vue?vue&type=script&lang=ts\"\nexport * from \"./Progressbar.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div ref=\"root\">\n    <slot\n      :form-data=\"formData\"\n      :submit-api-method=\"submitApiMethod\"\n      :send-json-payload=\"sendJsonPayload\"\n      :no-error-notification=\"noErrorNotification\"\n      :no-success-notification=\"noSuccessNotification\"\n      :submit-form=\"submitForm\"\n      :is-submitting=\"isSubmitting\"\n      :successful-post-response=\"successfulPostResponse\"\n      :error-post-response=\"errorPostResponse\"\n    ></slot>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { translate } from '../translate';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport { NotificationsStore } from '../Notification';\n\nconst { $ } = window;\n\n/**\n * Example usage:\n *\n * <AjaxForm :form-data=\"myData\" ...>\n *   <template v-slot:default=\"ajaxForm\">\n *     <Field v-model=\"myData.something\" .../>\n *     <SaveButton @confirm=\"ajaxForm.submitForm()\" :saving=\"ajaxForm.isSubmitting\"/>\n *   </template>\n * </AjaxForm>\n *\n * Data does not flow upwards in any way. :form-data is used for submitForm(), and the\n * containing component binds to properties of the object in controls to fill the object.\n */\nexport default defineComponent({\n  props: {\n    formData: {\n      type: Object,\n      required: true,\n    },\n    submitApiMethod: {\n      type: String,\n      required: true,\n    },\n    sendJsonPayload: Boolean,\n    noErrorNotification: Boolean,\n    noSuccessNotification: Boolean,\n  },\n  data() {\n    return {\n      isSubmitting: false,\n      successfulPostResponse: null,\n      errorPostResponse: null,\n    };\n  },\n  emits: ['update:modelValue'],\n  mounted() {\n    // on submit call controller submit method\n    $(this.$refs.root as HTMLElement).on('click', 'input[type=submit]', () => {\n      this.submitForm();\n    });\n  },\n  methods: {\n    submitForm() {\n      this.successfulPostResponse = null;\n      this.errorPostResponse = null;\n\n      let postParams = this.formData;\n      if (this.sendJsonPayload) {\n        postParams = { data: JSON.stringify(this.formData) };\n      }\n\n      this.isSubmitting = true;\n      AjaxHelper.post(\n        {\n          module: 'API',\n          method: this.submitApiMethod,\n        },\n        postParams,\n        {\n          createErrorNotification: !this.noErrorNotification,\n        },\n      ).then((response) => {\n        this.successfulPostResponse = response;\n\n        if (!this.noSuccessNotification) {\n          const notificationInstanceId = NotificationsStore.show({\n            message: translate('General_YourChangesHaveBeenSaved'),\n            context: 'success',\n            type: 'toast',\n            id: 'ajaxHelper',\n          });\n          NotificationsStore.scrollToNotification(notificationInstanceId);\n        }\n      }).catch((error) => {\n        this.errorPostResponse = error.message;\n      }).finally(() => {\n        this.isSubmitting = false;\n      });\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport { translate } from '../translate';\nimport AjaxHelper from '../AjaxHelper/AjaxHelper';\nimport { NotificationsStore } from '../Notification';\n\nconst { $ } = window;\n\n/**\n * Example usage:\n *\n * <AjaxForm :form-data=\"myData\" ...>\n *   <template v-slot:default=\"ajaxForm\">\n *     <Field v-model=\"myData.something\" .../>\n *     <SaveButton @confirm=\"ajaxForm.submitForm()\" :saving=\"ajaxForm.isSubmitting\"/>\n *   </template>\n * </AjaxForm>\n *\n * Data does not flow upwards in any way. :form-data is used for submitForm(), and the\n * containing component binds to properties of the object in controls to fill the object.\n */\nexport default defineComponent({\n  props: {\n    formData: {\n      type: Object,\n      required: true,\n    },\n    submitApiMethod: {\n      type: String,\n      required: true,\n    },\n    sendJsonPayload: Boolean,\n    noErrorNotification: Boolean,\n    noSuccessNotification: Boolean,\n  },\n  data() {\n    return {\n      isSubmitting: false,\n      successfulPostResponse: null,\n      errorPostResponse: null,\n    };\n  },\n  emits: ['update:modelValue'],\n  mounted() {\n    // on submit call controller submit method\n    $(this.$refs.root as HTMLElement).on('click', 'input[type=submit]', () => {\n      this.submitForm();\n    });\n  },\n  methods: {\n    submitForm() {\n      this.successfulPostResponse = null;\n      this.errorPostResponse = null;\n\n      let postParams = this.formData;\n      if (this.sendJsonPayload) {\n        postParams = { data: JSON.stringify(this.formData) };\n      }\n\n      this.isSubmitting = true;\n      AjaxHelper.post(\n        {\n          module: 'API',\n          method: this.submitApiMethod,\n        },\n        postParams,\n        {\n          createErrorNotification: !this.noErrorNotification,\n        },\n      ).then((response) => {\n        this.successfulPostResponse = response;\n\n        if (!this.noSuccessNotification) {\n          const notificationInstanceId = NotificationsStore.show({\n            message: translate('General_YourChangesHaveBeenSaved'),\n            context: 'success',\n            type: 'toast',\n            id: 'ajaxHelper',\n          });\n          NotificationsStore.scrollToNotification(notificationInstanceId);\n        }\n      }).catch((error) => {\n        this.errorPostResponse = error.message;\n      }).finally(() => {\n        this.isSubmitting = false;\n      });\n    },\n  },\n});\n","import { render } from \"./AjaxForm.vue?vue&type=template&id=00d5220c\"\nimport script from \"./AjaxForm.vue?vue&type=script&lang=ts\"\nexport * from \"./AjaxForm.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <slot></slot>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({});\n</script>\n","\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({});\n","import { render } from \"./Passthrough.vue?vue&type=template&id=6f9e3dd3\"\nimport script from \"./Passthrough.vue?vue&type=script&lang=ts\"\nexport * from \"./Passthrough.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <div v-if=\"showFooter && showFooterIcons\">\n    <a\n      v-dropdown-button\n      class=\"dropdown-button dropdownConfigureIcon dataTableAction\"\n      :class=\"{highlighted: isAnyConfigureIconHighlighted}\"\n      href\n      @click.prevent\n      :data-target=\"`dropdownConfigure${randomIdForDropdown}`\"\n      style=\"margin-right:3.5px\"\n      v-if=\"hasConfigItems && (isAnyConfigureIconHighlighted || isTableView)\"\n    >\n      <span class=\"icon-configure\"></span>\n    </a>\n\n    <a v-if=\"hasFooterIconsToShow\"\n      class=\"dropdown-button dataTableAction activateVisualizationSelection\"\n      v-dropdown-button\n      href\n      :data-target=\"`dropdownVisualizations${randomIdForDropdown}`\"\n      style=\"margin-right:3.5px\"\n      @click.prevent\n    >\n      <span\n        v-if=\"/^icon-/.test(activeFooterIcon || '')\"\n        :title=\"translate('CoreHome_ChangeVisualization')\"\n        :class=\"activeFooterIcon\"\n      ></span>\n      <img\n        v-else\n        :title=\"translate('CoreHome_ChangeVisualization')\"\n        width=\"16\"\n        height=\"16\"\n        :src=\"activeFooterIcon\"\n      />\n    </a>\n\n    <ul\n      v-if=\"showFooterIcons\"\n      :id=\"`dropdownVisualizations${randomIdForDropdown}`\"\n      class=\"dropdown-content dataTableFooterIcons\"\n    >\n      <Passthrough v-for=\"(footerIconGroup, index) in footerIcons\" :key=\"index\">\n        <li\n          v-for=\"footerIcon in footerIconGroup.buttons.filter((i) => !!i.icon)\"\n          :key=\"footerIcon.id\"\n        >\n          <a\n            :class=\"`${footerIconGroup.class} tableIcon\n              ${activeFooterIconIds.indexOf(footerIcon.id) !== -1 ? 'activeIcon' : ''}`\"\n            :data-footer-icon-id=\"footerIcon.id\"\n          >\n            <span\n              v-if=\"/^icon-/.test(footerIcon.icon || '')\"\n              :title=\"footerIcon.title\"\n              :class=\"footerIcon.icon\"\n              style=\"margin-right:5.5px\"\n            ></span>\n            <img\n              v-else\n              width=\"16\"\n              height=\"16\"\n              :title=\"footerIcon.title\"\n              :src=\"footerIcon.icon\"\n              style=\"margin-right:5.5px\"\n            />\n            <span v-if=\"footerIcon.title\">{{ footerIcon.title }}</span>\n          </a>\n        </li>\n        <li class=\"divider\"></li>\n      </Passthrough>\n      <li class=\"divider\"></li>\n    </ul>\n\n    <a\n      v-if=\"showExport\"\n      class=\"dataTableAction activateExportSelection\"\n      v-report-export=\"{\n        reportTitle,\n        requestParams,\n        apiMethod: apiMethodToRequestDataTable,\n        reportFormats,\n        maxFilterLimit,\n      }\"\n      :title=\"translate('General_ExportThisReport')\"\n      href=\"\"\n      style=\"margin-right:3.5px\"\n      @click.prevent\n    ><span class=\"icon-export\"></span></a>\n\n    <a\n      v-if=\"showExportAsImageIcon\"\n      class=\"dataTableAction tableIcon\"\n      href\n      id=\"dataTableFooterExportAsImageIcon\"\n      @click.prevent=\"showExportImage($event)\"\n      :title=\"translate('General_ExportAsImage')\"\n      style=\"margin-right:3.5px\"\n    >\n      <span class=\"icon-image\"></span>\n    </a>\n\n    <a\n      v-if=\"showAnnotations\"\n      class=\"dataTableAction annotationView\"\n      href\n      :title=\"translate('Annotations_Annotations')\"\n      @click.prevent\n      style=\"margin-right:3.5px\"\n    ><span class=\"icon-annotation\"></span></a>\n\n    <a\n      v-if=\"showSearch\"\n      class=\"dropdown-button dataTableAction searchAction\"\n      href\n      :title=\"translate('General_Search')\"\n      style=\"margin-right:3.5px\"\n      draggable=\"false\"\n      @click.prevent\n    >\n      <span class=\"icon-search\" draggable=\"false\"></span>\n      <span class=\"icon-close\" draggable=\"false\" :title=\"translate('CoreHome_CloseSearch')\"></span>\n      <input\n        :id=\"`widgetSearch_${reportId}`\"\n        :title=\"translate('CoreHome_DataTableHowToSearch')\"\n        type=\"text\"\n        class=\"dataTableSearchInput\"\n      />\n    </a>\n\n    <a\n      v-for=\"action in dataTableActions\"\n      :key=\"action.id\"\n      :class=\"`dataTableAction ${action.id}`\"\n      href\n      @click.prevent\n      :title=\"action.title\"\n      style=\"margin-right:3.5px\"\n    >\n      <span v-if=\"/^icon-/.test(action.icon || '')\" :class=\"action.icon\"></span>\n      <img v-else width=\"16\" height=\"16\" :title=\"action.title\" :src=\"action.icon\"/>\n    </a>\n\n    <ul\n      :id=\"`dropdownConfigure${randomIdForDropdown}`\"\n      class=\"dropdown-content tableConfiguration\"\n    >\n      <li v-if=\"showFlattenTable\">\n        <div\n          class=\"configItem dataTableFlatten\"\n          v-html=\"$sanitize(flattenItemText)\"\n        ></div>\n      </li>\n      <li\n        v-if=\"showDimensionsConfigItem\"\n      >\n        <div\n          class=\"configItem dataTableShowDimensions\"\n          v-html=\"$sanitize(showDimensionsText)\"\n        ></div>\n      </li>\n      <li v-if=\"showFlatConfigItem\">\n        <div\n          class=\"configItem dataTableIncludeAggregateRows\"\n          v-html=\"$sanitize(includeAggregateRowsText)\"\n        ></div>\n      </li>\n      <li v-if=\"showTotalsConfigItem\">\n        <div\n          class=\"configItem dataTableShowTotalsRow\"\n          v-html=\"$sanitize(keepTotalsRowText)\"\n        ></div>\n      </li>\n      <li v-if=\"showExcludeLowPopulation\">\n        <div\n          class=\"configItem dataTableExcludeLowPopulation\"\n          v-html=\"$sanitize(excludeLowPopText)\"\n        ></div>\n      </li>\n      <li v-if=\"showPivotBySubtable\">\n        <div\n          class=\"configItem dataTablePivotBySubtable\"\n          v-html=\"$sanitize(pivotByText)\"\n        ></div>\n      </li>\n    </ul>\n\n    <a\n      v-if=\"showPeriods\"\n      v-dropdown-button\n      class=\"dropdown-button dataTableAction activatePeriodsSelection\"\n      href=\"\"\n      @click.prevent\n      :title=\"translate('CoreHome_ChangePeriod')\"\n      :data-target=\"`dropdownPeriods${randomIdForDropdown}`\"\n    >\n      <div>\n        <span class=\"icon-calendar\"></span>\n        <span class=\"periodName\">\n          {{ translations[clientSideParameters.period] || clientSideParameters.period }}\n        </span>\n      </div>\n    </a>\n    <ul\n      v-if=\"showPeriods\"\n      :id=\"`dropdownPeriods${randomIdForDropdown}`\"\n      class=\"dropdown-content dataTablePeriods\"\n    >\n      <li v-for=\"selectablePeriod in selectablePeriods\" :key=\"selectablePeriod\">\n        <a\n          :data-period=\"selectablePeriod\"\n          :class=\"`tableIcon ${clientSideParameters.period === selectablePeriod\n            ? 'activeIcon' : ''}`\"\n        >\n          <span>{{ translations[selectablePeriod] || selectablePeriod }}</span>\n        </a>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport Passthrough from '../Passthrough/Passthrough.vue';\nimport DropdownButton from '../DropdownButton/DropdownButton';\nimport ReportExport from '../ReportExport/ReportExport';\nimport { translate } from '../translate';\n\ninterface FooterIcon {\n  id: string;\n  icon?: string;\n}\n\ninterface FooterIconGroup {\n  buttons: FooterIcon[];\n}\n\nconst { $ } = window;\n\nfunction getSingleStateIconText(text: string, addDefault?: boolean, replacement?: string) {\n  if (/(%(.\\$)?s+)/g.test(translate(text))) {\n    const values = ['<br /><span class=\"action\">'];\n    if (replacement) {\n      values.push(replacement);\n    }\n    let result = translate(text, ...values);\n    if (addDefault) {\n      result += ` (${translate('CoreHome_Default')})`;\n    }\n    result += '</span>';\n    return result;\n  }\n\n  return translate(text);\n}\n\nfunction getToggledIconText(toggled: boolean, textToggled: string, textUntoggled: string) {\n  if (toggled) {\n    return getSingleStateIconText(textToggled, true);\n  }\n\n  return getSingleStateIconText(textUntoggled);\n}\n\nfunction isBooleanLikeSet(value: number|string|boolean) {\n  return !!value && value !== '0';\n}\n\nexport default defineComponent({\n  props: {\n    showPeriods: Boolean,\n    showFooter: Boolean,\n    showFooterIcons: Boolean,\n    showSearch: Boolean,\n    showFlattenTable: Boolean,\n    footerIcons: {\n      type: Array,\n      required: true,\n    },\n    viewDataTable: {\n      type: String,\n      required: true,\n    },\n    reportTitle: String,\n    requestParams: {\n      type: Object,\n      required: true,\n    },\n    apiMethodToRequestDataTable: {\n      type: String,\n      required: true,\n    },\n    maxFilterLimit: {\n      type: Number,\n      required: true,\n    },\n    showExport: Boolean,\n    showExportAsImageIcon: Boolean,\n    showAnnotations: Boolean,\n    reportId: {\n      type: String,\n      required: true,\n    },\n    dataTableActions: {\n      type: Array,\n      required: true,\n    },\n    clientSideParameters: {\n      type: Object,\n      required: true,\n    },\n    hasMultipleDimensions: Boolean,\n    isDataTableEmpty: Boolean,\n    showTotalsRow: Boolean,\n    showExcludeLowPopulation: Boolean,\n    showPivotBySubtable: Boolean,\n    selectablePeriods: Array,\n    translations: {\n      type: Object,\n      required: true,\n    },\n    pivotDimensionName: String,\n  },\n  components: {\n    Passthrough,\n  },\n  directives: {\n    DropdownButton,\n    ReportExport,\n  },\n  methods: {\n    showExportImage(event: Event) {\n      $(event.target as HTMLElement)\n        .closest('.dataTable')\n        .find('div.jqplot-target')\n        .trigger('piwikExportAsImage');\n    },\n  },\n  computed: {\n    randomIdForDropdown(): number {\n      return Math.floor(Math.random() * 999999);\n    },\n    allFooterIcons(): FooterIcon[] {\n      return (this.footerIcons as FooterIconGroup[]).reduce((icons, footerIcon) => {\n        icons.push(...footerIcon.buttons);\n        return icons;\n      }, [] as FooterIcon[]);\n    },\n    activeFooterIcons(): FooterIcon[] {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n\n      const result = [this.viewDataTable];\n      if (params.abandonedCarts === 0 || params.abandonedCarts === '0') {\n        result.push('ecommerceOrder');\n      } else if (params.abandonedCarts === 1 || params.abandonedCarts === '1') {\n        result.push('ecommerceAbandonedCart');\n      }\n\n      return result\n        .map((id) => this.allFooterIcons.find((button) => button.id === id))\n        .filter((icon) => !!icon) as FooterIcon[];\n    },\n    activeFooterIcon(): string|undefined {\n      return this.activeFooterIcons[0]?.icon;\n    },\n    activeFooterIconIds(): string[] {\n      return this.activeFooterIcons.map((icon) => icon.id);\n    },\n    numIcons(): number {\n      return this.allFooterIcons.length;\n    },\n    hasFooterIconsToShow(): boolean {\n      return !!this.activeFooterIcons.length && this.numIcons > 1;\n    },\n    reportFormats(): Record<string, string> {\n      const formats: Record<string, string> = {\n        CSV: 'CSV',\n        TSV: 'TSV (Excel)',\n        XML: 'XML',\n        JSON: 'Json',\n        HTML: 'HTML',\n      };\n      formats.RSS = 'RSS';\n      return formats;\n    },\n    showDimensionsConfigItem() {\n      return this.showFlattenTable\n        && `${this.clientSideParameters.flat}` === '1'\n        && this.hasMultipleDimensions;\n    },\n    showFlatConfigItem() {\n      return this.showFlattenTable && `${this.clientSideParameters.flat}` === '1';\n    },\n    showTotalsConfigItem() {\n      return !this.isDataTableEmpty && this.showTotalsRow;\n    },\n    hasConfigItems() {\n      return this.showFlattenTable\n        || this.showDimensionsConfigItem\n        || this.showFlatConfigItem\n        || this.showTotalsConfigItem\n        || this.showExcludeLowPopulation\n        || this.showPivotBySubtable;\n    },\n    flattenItemText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.flat),\n        'CoreHome_UnFlattenDataTable',\n        'CoreHome_FlattenDataTable',\n      );\n    },\n    keepTotalsRowText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.keep_totals_row),\n        'CoreHome_RemoveTotalsRowDataTable',\n        'CoreHome_AddTotalsRowDataTable',\n      );\n    },\n    includeAggregateRowsText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.include_aggregate_rows),\n        'CoreHome_DataTableExcludeAggregateRows',\n        'CoreHome_DataTableIncludeAggregateRows',\n      );\n    },\n    showDimensionsText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.show_dimensions),\n        'CoreHome_DataTableCombineDimensions',\n        'CoreHome_DataTableShowDimensions',\n      );\n    },\n    pivotByText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      if (isBooleanLikeSet(params.pivotBy)) {\n        return getSingleStateIconText('CoreHome_UndoPivotBySubtable', true);\n      }\n\n      return getSingleStateIconText('CoreHome_PivotBySubtable', false, this.pivotDimensionName);\n    },\n    excludeLowPopText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.enable_filter_excludelowpop),\n        'CoreHome_IncludeRowsWithLowPopulation',\n        'CoreHome_ExcludeRowsWithLowPopulation',\n      );\n    },\n    isAnyConfigureIconHighlighted() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return isBooleanLikeSet(params.flat)\n        || isBooleanLikeSet(params.keep_totals_row)\n        || isBooleanLikeSet(params.include_aggregate_rows)\n        || isBooleanLikeSet(params.show_dimensions)\n        || isBooleanLikeSet(params.pivotBy)\n        || isBooleanLikeSet(params.enable_filter_excludelowpop);\n    },\n    isTableView() {\n      return this.viewDataTable === 'table'\n        || this.viewDataTable === 'tableAllColumns'\n        || this.viewDataTable === 'tableGoals';\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport Passthrough from '../Passthrough/Passthrough.vue';\nimport DropdownButton from '../DropdownButton/DropdownButton';\nimport ReportExport from '../ReportExport/ReportExport';\nimport { translate } from '../translate';\n\ninterface FooterIcon {\n  id: string;\n  icon?: string;\n}\n\ninterface FooterIconGroup {\n  buttons: FooterIcon[];\n}\n\nconst { $ } = window;\n\nfunction getSingleStateIconText(text: string, addDefault?: boolean, replacement?: string) {\n  if (/(%(.\\$)?s+)/g.test(translate(text))) {\n    const values = ['<br /><span class=\"action\">'];\n    if (replacement) {\n      values.push(replacement);\n    }\n    let result = translate(text, ...values);\n    if (addDefault) {\n      result += ` (${translate('CoreHome_Default')})`;\n    }\n    result += '</span>';\n    return result;\n  }\n\n  return translate(text);\n}\n\nfunction getToggledIconText(toggled: boolean, textToggled: string, textUntoggled: string) {\n  if (toggled) {\n    return getSingleStateIconText(textToggled, true);\n  }\n\n  return getSingleStateIconText(textUntoggled);\n}\n\nfunction isBooleanLikeSet(value: number|string|boolean) {\n  return !!value && value !== '0';\n}\n\nexport default defineComponent({\n  props: {\n    showPeriods: Boolean,\n    showFooter: Boolean,\n    showFooterIcons: Boolean,\n    showSearch: Boolean,\n    showFlattenTable: Boolean,\n    footerIcons: {\n      type: Array,\n      required: true,\n    },\n    viewDataTable: {\n      type: String,\n      required: true,\n    },\n    reportTitle: String,\n    requestParams: {\n      type: Object,\n      required: true,\n    },\n    apiMethodToRequestDataTable: {\n      type: String,\n      required: true,\n    },\n    maxFilterLimit: {\n      type: Number,\n      required: true,\n    },\n    showExport: Boolean,\n    showExportAsImageIcon: Boolean,\n    showAnnotations: Boolean,\n    reportId: {\n      type: String,\n      required: true,\n    },\n    dataTableActions: {\n      type: Array,\n      required: true,\n    },\n    clientSideParameters: {\n      type: Object,\n      required: true,\n    },\n    hasMultipleDimensions: Boolean,\n    isDataTableEmpty: Boolean,\n    showTotalsRow: Boolean,\n    showExcludeLowPopulation: Boolean,\n    showPivotBySubtable: Boolean,\n    selectablePeriods: Array,\n    translations: {\n      type: Object,\n      required: true,\n    },\n    pivotDimensionName: String,\n  },\n  components: {\n    Passthrough,\n  },\n  directives: {\n    DropdownButton,\n    ReportExport,\n  },\n  methods: {\n    showExportImage(event: Event) {\n      $(event.target as HTMLElement)\n        .closest('.dataTable')\n        .find('div.jqplot-target')\n        .trigger('piwikExportAsImage');\n    },\n  },\n  computed: {\n    randomIdForDropdown(): number {\n      return Math.floor(Math.random() * 999999);\n    },\n    allFooterIcons(): FooterIcon[] {\n      return (this.footerIcons as FooterIconGroup[]).reduce((icons, footerIcon) => {\n        icons.push(...footerIcon.buttons);\n        return icons;\n      }, [] as FooterIcon[]);\n    },\n    activeFooterIcons(): FooterIcon[] {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n\n      const result = [this.viewDataTable];\n      if (params.abandonedCarts === 0 || params.abandonedCarts === '0') {\n        result.push('ecommerceOrder');\n      } else if (params.abandonedCarts === 1 || params.abandonedCarts === '1') {\n        result.push('ecommerceAbandonedCart');\n      }\n\n      return result\n        .map((id) => this.allFooterIcons.find((button) => button.id === id))\n        .filter((icon) => !!icon) as FooterIcon[];\n    },\n    activeFooterIcon(): string|undefined {\n      return this.activeFooterIcons[0]?.icon;\n    },\n    activeFooterIconIds(): string[] {\n      return this.activeFooterIcons.map((icon) => icon.id);\n    },\n    numIcons(): number {\n      return this.allFooterIcons.length;\n    },\n    hasFooterIconsToShow(): boolean {\n      return !!this.activeFooterIcons.length && this.numIcons > 1;\n    },\n    reportFormats(): Record<string, string> {\n      const formats: Record<string, string> = {\n        CSV: 'CSV',\n        TSV: 'TSV (Excel)',\n        XML: 'XML',\n        JSON: 'Json',\n        HTML: 'HTML',\n      };\n      formats.RSS = 'RSS';\n      return formats;\n    },\n    showDimensionsConfigItem() {\n      return this.showFlattenTable\n        && `${this.clientSideParameters.flat}` === '1'\n        && this.hasMultipleDimensions;\n    },\n    showFlatConfigItem() {\n      return this.showFlattenTable && `${this.clientSideParameters.flat}` === '1';\n    },\n    showTotalsConfigItem() {\n      return !this.isDataTableEmpty && this.showTotalsRow;\n    },\n    hasConfigItems() {\n      return this.showFlattenTable\n        || this.showDimensionsConfigItem\n        || this.showFlatConfigItem\n        || this.showTotalsConfigItem\n        || this.showExcludeLowPopulation\n        || this.showPivotBySubtable;\n    },\n    flattenItemText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.flat),\n        'CoreHome_UnFlattenDataTable',\n        'CoreHome_FlattenDataTable',\n      );\n    },\n    keepTotalsRowText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.keep_totals_row),\n        'CoreHome_RemoveTotalsRowDataTable',\n        'CoreHome_AddTotalsRowDataTable',\n      );\n    },\n    includeAggregateRowsText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.include_aggregate_rows),\n        'CoreHome_DataTableExcludeAggregateRows',\n        'CoreHome_DataTableIncludeAggregateRows',\n      );\n    },\n    showDimensionsText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.show_dimensions),\n        'CoreHome_DataTableCombineDimensions',\n        'CoreHome_DataTableShowDimensions',\n      );\n    },\n    pivotByText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      if (isBooleanLikeSet(params.pivotBy)) {\n        return getSingleStateIconText('CoreHome_UndoPivotBySubtable', true);\n      }\n\n      return getSingleStateIconText('CoreHome_PivotBySubtable', false, this.pivotDimensionName);\n    },\n    excludeLowPopText() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return getToggledIconText(\n        isBooleanLikeSet(params.enable_filter_excludelowpop),\n        'CoreHome_IncludeRowsWithLowPopulation',\n        'CoreHome_ExcludeRowsWithLowPopulation',\n      );\n    },\n    isAnyConfigureIconHighlighted() {\n      const params = this.clientSideParameters as Record<string, string|number|boolean>;\n      return isBooleanLikeSet(params.flat)\n        || isBooleanLikeSet(params.keep_totals_row)\n        || isBooleanLikeSet(params.include_aggregate_rows)\n        || isBooleanLikeSet(params.show_dimensions)\n        || isBooleanLikeSet(params.pivotBy)\n        || isBooleanLikeSet(params.enable_filter_excludelowpop);\n    },\n    isTableView() {\n      return this.viewDataTable === 'table'\n        || this.viewDataTable === 'tableAllColumns'\n        || this.viewDataTable === 'tableGoals';\n    },\n  },\n});\n","import { render } from \"./DataTableActions.vue?vue&type=template&id=7884c39d\"\nimport script from \"./DataTableActions.vue?vue&type=script&lang=ts\"\nexport * from \"./DataTableActions.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n<template>\n  <div\n    v-expand-on-hover=\"{expander: 'expander'}\"\n    id=\"header_message\"\n    class=\"piwikSelector\"\n    :class=\"{\n      header_info: !latestVersionAvailable || lastUpdateCheckFailed,\n      update_available: latestVersionAvailable\n    }\"\n  >\n    <Passthrough v-if=\"latestVersionAvailable && !isPiwikDemo\">\n      <span\n        v-if=\"isMultiServerEnvironment\"\n        class=\"title\"\n        style=\"cursor:pointer;\"\n        ref=\"expander\"\n      >\n        {{ translate('General_NewUpdatePiwikX', latestVersionAvailable) }}\n        <span class=\"icon-warning\"></span>\n      </span>\n      <a\n        v-else\n        class=\"title\"\n        href=\"?module=CoreUpdater&action=newVersionAvailable\"\n        style=\"cursor:pointer;\"\n        ref=\"expander\"\n      >\n        {{ translate('General_NewUpdatePiwikX', latestVersionAvailable) }}\n        <span class=\"icon-warning\"></span>\n      </a>\n    </Passthrough>\n    <Passthrough v-else-if=\"isSuperUser && (isAdminArea || lastUpdateCheckFailed)\">\n      <a v-if=\"isInternetEnabled\" class=\"title\" v-html=\"$sanitize(updateCheck)\"></a>\n      <a\n        v-else\n        class=\"title\"\n        :href=\"externalRawLink('https://matomo.org/changelog/')\"\n        target=\"_blank\"\n        rel=\"noreferrer noopener\"\n      >\n        <span id=\"updateCheckLinkContainer\">\n          {{ translate('CoreHome_SeeAvailableVersions') }}\n        </span>\n      </a>\n    </Passthrough>\n\n    <div class=\"dropdown positionInViewport\">\n      <span v-if=\"latestVersionAvailable && isSuperUser\" v-html=\"$sanitize(updateNowText)\"></span>\n      <span\n        v-else-if=\"latestVersionAvailable && !isPiwikDemo && hasSomeViewAccess && !isAnonymous\"\n        v-html=\"$sanitize(updateAvailableText)\"\n      ></span>\n\n      {{ translate('General_YouAreCurrentlyUsing', piwikVersion) }}\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport { translate } from '../translate';\nimport ExpandOnHover from '../ExpandOnHover/ExpandOnHover';\nimport Passthrough from '../Passthrough/Passthrough.vue';\nimport { externalLink, externalRawLink } from '../externalLink';\n\nexport default defineComponent({\n  props: {\n    isMultiServerEnvironment: Boolean,\n    lastUpdateCheckFailed: Boolean,\n    latestVersionAvailable: String,\n    isPiwikDemo: Boolean,\n    isSuperUser: Boolean,\n    isAdminArea: Boolean,\n    isInternetEnabled: Boolean,\n    updateCheck: String,\n    isAnonymous: Boolean,\n    hasSomeViewAccess: Boolean,\n    contactEmail: String,\n    piwikVersion: String,\n  },\n  components: {\n    Passthrough,\n  },\n  directives: {\n    ExpandOnHover,\n  },\n  computed: {\n    updateNowText() {\n      let text = '';\n\n      if (this.isMultiServerEnvironment) {\n        const link = externalRawLink(`https://builds.matomo.org/piwik-${this.latestVersionAvailable}.zip`);\n        text = translate(\n          'CoreHome_OneClickUpdateNotPossibleAsMultiServerEnvironment',\n          `<a rel=\"noreferrer noopener\" href=\"${link}\">builds.matomo.org</a>`,\n        );\n      } else {\n        text = translate(\n          'General_PiwikXIsAvailablePleaseUpdateNow',\n          this.latestVersionAvailable || '',\n          '<br /><a href=\"index.php?module=CoreUpdater&amp;action=newVersionAvailable\">',\n          '</a>',\n          externalLink('https://matomo.org/changelog/'),\n          '</a>',\n        );\n      }\n\n      return `${text}<br/>`;\n    },\n    updateAvailableText() {\n      const updateSubject = translate(\n        'General_NewUpdatePiwikX',\n        this.latestVersionAvailable || '',\n      );\n      /* eslint-disable prefer-template */\n      const matomoLink = externalLink('https://matomo.org/') + 'Matomo</a>';\n      const changelogLinkStart = externalLink('https://matomo.org/changelog/');\n\n      const text = translate(\n        'General_PiwikXIsAvailablePleaseNotifyPiwikAdmin',\n        `${matomoLink} ${changelogLinkStart}${this.latestVersionAvailable}</a>`,\n        `<a href=\"mailto:${this.contactEmail}?subject=${encodeURIComponent(updateSubject)}\">`,\n        '</a>',\n      );\n\n      return `${text}<br />`;\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport { translate } from '../translate';\nimport ExpandOnHover from '../ExpandOnHover/ExpandOnHover';\nimport Passthrough from '../Passthrough/Passthrough.vue';\nimport { externalLink, externalRawLink } from '../externalLink';\n\nexport default defineComponent({\n  props: {\n    isMultiServerEnvironment: Boolean,\n    lastUpdateCheckFailed: Boolean,\n    latestVersionAvailable: String,\n    isPiwikDemo: Boolean,\n    isSuperUser: Boolean,\n    isAdminArea: Boolean,\n    isInternetEnabled: Boolean,\n    updateCheck: String,\n    isAnonymous: Boolean,\n    hasSomeViewAccess: Boolean,\n    contactEmail: String,\n    piwikVersion: String,\n  },\n  components: {\n    Passthrough,\n  },\n  directives: {\n    ExpandOnHover,\n  },\n  computed: {\n    updateNowText() {\n      let text = '';\n\n      if (this.isMultiServerEnvironment) {\n        const link = externalRawLink(`https://builds.matomo.org/piwik-${this.latestVersionAvailable}.zip`);\n        text = translate(\n          'CoreHome_OneClickUpdateNotPossibleAsMultiServerEnvironment',\n          `<a rel=\"noreferrer noopener\" href=\"${link}\">builds.matomo.org</a>`,\n        );\n      } else {\n        text = translate(\n          'General_PiwikXIsAvailablePleaseUpdateNow',\n          this.latestVersionAvailable || '',\n          '<br /><a href=\"index.php?module=CoreUpdater&amp;action=newVersionAvailable\">',\n          '</a>',\n          externalLink('https://matomo.org/changelog/'),\n          '</a>',\n        );\n      }\n\n      return `${text}<br/>`;\n    },\n    updateAvailableText() {\n      const updateSubject = translate(\n        'General_NewUpdatePiwikX',\n        this.latestVersionAvailable || '',\n      );\n      /* eslint-disable prefer-template */\n      const matomoLink = externalLink('https://matomo.org/') + 'Matomo</a>';\n      const changelogLinkStart = externalLink('https://matomo.org/changelog/');\n\n      const text = translate(\n        'General_PiwikXIsAvailablePleaseNotifyPiwikAdmin',\n        `${matomoLink} ${changelogLinkStart}${this.latestVersionAvailable}</a>`,\n        `<a href=\"mailto:${this.contactEmail}?subject=${encodeURIComponent(updateSubject)}\">`,\n        '</a>',\n      );\n\n      return `${text}<br />`;\n    },\n  },\n});\n","import { render } from \"./VersionInfoHeaderMessage.vue?vue&type=template&id=eee30a80\"\nimport script from \"./VersionInfoHeaderMessage.vue?vue&type=script&lang=ts\"\nexport * from \"./VersionInfoHeaderMessage.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<!--\n  Matomo - free/libre analytics platform\n  @link https://matomo.org\n  @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n-->\n\n<template>\n  <ul id=\"mobile-left-menu\" class=\"sidenav hide-on-large-only\">\n    <li class=\"no-padding\" v-for=\"(level2, level1) in menuWithSubmenuItems\" :key=\"level1\">\n      <ul class=\"collapsible collapsible-accordion\" v-side-nav=\"{activator: activateLeftMenu}\">\n        <li>\n          <a class=\"collapsible-header\">\n            {{ translate(level1) }}<i :class=\"level2._icon || 'icon-chevron-down'\"></i>\n          </a>\n\n          <div class=\"collapsible-body\">\n            <ul>\n              <li\n                v-for=\"([name, params]) in Object.entries(level2).filter(([n]) => n[0] !== '_')\"\n                :key=\"name\"\n              >\n                <a\n                  :title=\"params._tooltip ? translateIfNecessary(params._tooltip) : ''\"\n                  target=\"_self\"\n                  :href=\"getMenuUrl(params._url)\"\n                >\n                  {{ translateIfNecessary(name) }}\n                </a>\n              </li>\n            </ul>\n          </div>\n        </li>\n      </ul>\n    </li>\n  </ul>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport SideNav from '../SideNav/SideNav';\nimport { translate } from '../translate';\n\ninterface UrlParamsInfo {\n  _tooltip: string;\n  _url: QueryParameters;\n}\n\ntype Menu = Record<string, Record<string, UrlParamsInfo>>;\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    menu: {\n      type: Object,\n      required: true,\n    },\n  },\n  directives: {\n    SideNav,\n  },\n  methods: {\n    getMenuUrl(params: QueryParameters) {\n      return `?${MatomoUrl.stringify({\n        ...MatomoUrl.urlParsed.value,\n        ...params,\n      })}`;\n    },\n    translateIfNecessary(name: string) {\n      if (name.includes('_')) {\n        return translate(name);\n      }\n\n      return name;\n    },\n  },\n  computed: {\n    menuWithSubmenuItems() {\n      const menu = (this.menu || {}) as Menu;\n      return Object.fromEntries(\n        Object.entries(menu)\n          // remove submenus that have no items that do not start w/ '_'\n          .filter(([, level2]) => {\n            const itemsWithoutUnderscore = Object.entries(level2)\n              .filter(([name]) => name[0] !== '_');\n            return Object.keys(itemsWithoutUnderscore).length;\n          }),\n      );\n    },\n    activateLeftMenu() {\n      return $('nav .activateLeftMenu')[0];\n    },\n  },\n});\n</script>\n","\nimport { defineComponent } from 'vue';\nimport MatomoUrl from '../MatomoUrl/MatomoUrl';\nimport SideNav from '../SideNav/SideNav';\nimport { translate } from '../translate';\n\ninterface UrlParamsInfo {\n  _tooltip: string;\n  _url: QueryParameters;\n}\n\ntype Menu = Record<string, Record<string, UrlParamsInfo>>;\n\nconst { $ } = window;\n\nexport default defineComponent({\n  props: {\n    menu: {\n      type: Object,\n      required: true,\n    },\n  },\n  directives: {\n    SideNav,\n  },\n  methods: {\n    getMenuUrl(params: QueryParameters) {\n      return `?${MatomoUrl.stringify({\n        ...MatomoUrl.urlParsed.value,\n        ...params,\n      })}`;\n    },\n    translateIfNecessary(name: string) {\n      if (name.includes('_')) {\n        return translate(name);\n      }\n\n      return name;\n    },\n  },\n  computed: {\n    menuWithSubmenuItems() {\n      const menu = (this.menu || {}) as Menu;\n      return Object.fromEntries(\n        Object.entries(menu)\n          // remove submenus that have no items that do not start w/ '_'\n          .filter(([, level2]) => {\n            const itemsWithoutUnderscore = Object.entries(level2)\n              .filter(([name]) => name[0] !== '_');\n            return Object.keys(itemsWithoutUnderscore).length;\n          }),\n      );\n    },\n    activateLeftMenu() {\n      return $('nav .activateLeftMenu')[0];\n    },\n  },\n});\n","import { render } from \"./MobileLeftMenu.vue?vue&type=template&id=727d7002\"\nimport script from \"./MobileLeftMenu.vue?vue&type=script&lang=ts\"\nexport * from \"./MobileLeftMenu.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","/*!\n * Matomo - free/libre analytics platform\n *\n * @link https://matomo.org\n * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later\n */\n\nimport { nextTick, watch } from 'vue';\nimport MatomoUrl from './MatomoUrl/MatomoUrl';\n\nconst { $ } = window;\n\nfunction scrollToAnchorNode($node: HTMLElement|JQuery|string) {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ($ as any).scrollTo($node, 20);\n}\n\nfunction preventDefaultIfEventExists(event: Event|null) {\n  if (event) {\n    event.preventDefault();\n  }\n}\n\nfunction scrollToAnchorIfPossible(hash: string, event: Event|null) {\n  if (!hash) {\n    return;\n  }\n\n  if (hash.indexOf('&') !== -1) {\n    return;\n  }\n\n  let $node: JQuery|null = null;\n  try {\n    $node = $(`#${hash}`);\n  } catch (err) {\n    // on jquery syntax error, ignore so nothing is logged to the console\n    return;\n  }\n\n  if ($node?.length) {\n    scrollToAnchorNode($node);\n    preventDefaultIfEventExists(event);\n    return;\n  }\n\n  $node = $(`a[name=${hash}]`);\n\n  if ($node?.length) {\n    scrollToAnchorNode($node);\n    preventDefaultIfEventExists(event);\n  }\n}\n\nfunction isLinkWithinSamePage(location: URL, newUrl: string) {\n  if (location && location.origin && newUrl.indexOf(location.origin) === -1) {\n    // link to different domain\n    return false;\n  }\n\n  if (location && location.pathname && newUrl.indexOf(location.pathname) === -1) {\n    // link to different path\n    return false;\n  }\n\n  if (location && location.search && newUrl.indexOf(location.search) === -1) {\n    // link with different search\n    return false;\n  }\n\n  return true;\n}\n\nfunction handleScrollToAnchorIfPresentOnPageLoad() {\n  if (window.location.hash.slice(0, 2) === '#/') {\n    const hash = window.location.hash.slice(2);\n    scrollToAnchorIfPossible(hash, null);\n  }\n}\n\nfunction handleScrollToAnchorAfterPageLoad() {\n  watch(() => MatomoUrl.url.value, (newUrl, oldUrl) => {\n    if (!newUrl) {\n      return;\n    }\n\n    const hashPos = newUrl.href.indexOf('#/');\n    if (hashPos === -1) {\n      return;\n    }\n\n    if (oldUrl && !isLinkWithinSamePage(oldUrl, newUrl.href)) {\n      return;\n    }\n\n    const hash = newUrl.href.slice(hashPos + 2);\n\n    scrollToAnchorIfPossible(hash, null);\n  });\n}\n\nhandleScrollToAnchorAfterPageLoad();\n$(handleScrollToAnchorIfPresentOnPageLoad);\n\nexport default function scrollToAnchorInUrl(): void {\n  // may be called when page is only fully loaded after some additional requests\n  // timeout needed to ensure Vue rendered fully\n  nextTick(handleScrollToAnchorIfPresentOnPageLoad);\n}\n","\nimport { defineComponent } from 'vue';\nimport {\n  translate,\n  AjaxHelper,\n  MatomoDialog,\n  SiteSelector,\n  SiteRef,\n  Site,\n  Matomo,\n} from '../../../../CoreHome/vue/src/index.ts';\n// } from 'CoreHome';\n\ninterface CsvSectionState {\n  isLoading: boolean;\n  count: number;\n  showDialog: boolean;\n  idSite: string | number;\n  siteName: string;\n  site: SiteRef;\n  sites: Record<string, Site>;\n  tokenAuth: string;\n  login: string;\n  date: string;\n}\n\nexport default defineComponent({\n  props: {\n    defaultSite: {\n      type: Object,\n      required: true,\n    },\n  },\n  components: {\n    MatomoDialog,\n    SiteSelector,\n  },\n  data(): CsvSectionState {\n    return {\n      isLoading: false,\n      count: 12,\n      showDialog: false,\n      idSite: '',\n      siteName: '',\n      site: this.defaultSite as SiteRef,\n      sites: {},\n      tokenAuth: '', // Placeholder for the token_auth\n      login: '',\n      date: '',\n    };\n  },\n  async mounted() {\n    console.log('Mounted...');\n    console.log('Sites:', this.sites);\n  },\n  setup() {\n    console.log('Setup...');\n    const sitesPromise = AjaxHelper.fetch<(string | number)[]>({\n      method: 'SitesManager.getSitesIdWithAdminAccess',\n      filter_limit: '-1',\n    });\n\n    return {\n      translate,\n      getSites() {\n        return sitesPromise;\n      },\n    };\n  },\n  methods: {\n    downloadCSV() {\n      console.log('Download CSV for site ID:', this.site);\n      console.log('Date:', this.date);\n\n      if (!this.site) {\n        console.error('Site ID is undefined or not selected.');\n        return;\n      }\n      const redirectParams = {\n        module: 'DataExport',\n        action: 'selectAllVisitsAndActions',\n        idSite: this.site.id,\n        date: this.date,\n      };\n      // Redirect because download is not possible with ajax\n      Matomo.helper.redirect(redirectParams);\n    },\n    websiteChanged() {\n      console.log('websiteChanged this.site:', this.site);\n      console.log('websiteChanged this.site:', this.site);\n    },\n    dateChanged() {\n      console.log('dateChanged this.date:', this.date);\n    },\n    sendRequest() {\n      console.log('sendRequest: selectAllVisitsAndActionsSiteId');\n    },\n  },\n});\n","import { render } from \"./CsvSection.vue?vue&type=template&id=1f77e6ee&scoped=true\"\nimport script from \"./CsvSection.vue?vue&type=script&lang=ts\"\nexport * from \"./CsvSection.vue?vue&type=script&lang=ts\"\n\nimport \"./CsvSection.vue?vue&type=style&index=0&id=1f77e6ee&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-1f77e6ee\"\n\nexport default script"],"sourceRoot":""}